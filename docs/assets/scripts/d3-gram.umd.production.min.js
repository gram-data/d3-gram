!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(((t=t||self).gram=t.gram||{},t.gram.d3={}))}(this,(function(t){"use strict";const e="__missing_id__",n=(t,n,r)=>({id:t||e,labels:n||[],record:r||[]}),r=t=>void 0!==t.id,i=(t,n,r,i,o)=>({id:r||e,labels:i||[],record:o||[],source:t,target:n});var o=/[0-9a-zA-Z_@]+\b@*/,s=new RegExp("^"+o.source+"$"),a={__proto__:null,boolean:/true|false|TRUE|FALSE\b(?!@)/,hexadecimal:/-?0x(?:[0-9a-fA-F]+)\b(?!@)/,octal:/-?0(?:[0-7]+)\b(?!@)/,measurement:/-?(?:[0-9]|[1-9][0-9]+)(?:\.[0-9]+)?[a-zA-Z]+\b(?!@)/,decimal:/-?(?:[0-9]|[1-9][0-9]+)\.[0-9]+(?:[eE][-+]?[0-9]+)?\b(?!@)/,integer:/-?(?:[0-9]|[1-9][0-9]+)(?:[eE][-+]?[0-9]+)?\b(?!@)/,taggedString:/[a-zA-Z][0-9a-zA-Z_@]*`(?:\\[`bfnrt/\\]|\\u[a-fA-F0-9]{4}|[^`\\])*`/,doubleQuotedString:/"(?:\\["bfnrt/\\]|\\u[a-fA-F0-9]{4}|[^"\\])*"/,singleQuotedString:/'(?:\\['bfnrt/\\]|\\u[a-fA-F0-9]{4}|[^'\\])*'/,tickedString:/`(?:\\[`bfnrt/\\]|\\u[a-fA-F0-9]{4}|[^`\\])*`/,symbol:/[a-zA-Z_][0-9a-zA-Z_]*\b(?!@)/,identifier:o,isValidIdentifier:function(t){return t&&s.test(t)}},u=function(t){return!!t.type&&"path"===t.type},l=function(t){return u(t)&&"ø"===t.id},c=function(t){return u(t)&&t.children&&0===t.children.length&&"ø"!==t.id},f=function(t){return!!t.type&&!!t.value&&"property"!==t.type};function h(){return(h=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function p(t){return Array.isArray(t)?t:t instanceof Function?p(t()):void 0===t?[]:[t]}var d=function(t,e){void 0===e&&(e={});var n=h({type:"path"},e.id&&{id:e.id},e.labels&&{labels:e.labels},e.record&&{record:e.record});if(void 0===t)return n.id&&"ø"!==n.id?(n.children=[],n):(n.children=void 0,y);if(0===t.length)return"ø"===n.id?y:(n.children=[],n);if(1===t.length){var r=t[0];return l(r)?(n.children=[],n):(n.children=[r],n)}if(2===t.length){if(e.kind&&"pair"!==e.kind&&c(t[0])&&c(t[1]))return n.kind=e.kind,n.children=[t[0],t[1]],n;if(l(t[0])&&l(t[1]))return n.kind=e.kind,n.children=[],n;n.children=[t[0],t[1]]}return n.kind=e.kind||"pair",n},y={type:"path",id:"ø",labels:void 0,record:void 0,children:[]},m=function(t,e,n){return h({type:"path"},t&&{id:t},e&&{labels:e},n&&{record:n},{children:[]})},g=function(t,e,n,r,i){return h({type:"path",id:n},r&&{labels:r},i&&{record:i},{kind:e,children:t})},v=function(){return new Map},b=function(t){return Object.entries(t).reduce((function(t,e){return t.set(e[0],w(e[1])),t}),v())},w=function t(e){if(Array.isArray(e))return e.map((function(e){return t(e)}));if("object"==typeof e)return e instanceof Date?S(e):f(e)?e:b(e);switch(typeof e){case"string":return x(e);case"bigint":return E(e.toString());case"boolean":return _(e);case"number":return E(e.toString());case"symbol":return x(e.toString());default:throw new Error("Unsupported value: "+e)}},_=function(t){return{type:"boolean",value:t?"true":"false"}},x=function(t){return{type:"string",value:t}},k=function(t,e){return{type:"tagged",value:e,tag:t}},E=function(t){return{type:"decimal",value:String(t)}},S=function(t){return k("date",t instanceof Date?t.toISOString().slice(0,10):t)},A=function t(e){return void 0===e.children||0===e.children.length?e:t(e.children[0])},$=function t(e){return void 0===e.children||0===e.children.length?e:t(e.children[e.children.length-1])},N=function t(e){if(c(e))return[e];if((n=e).type&&"seq"===n.type)return t(e.children);var n;if(Array.isArray(e)){var r=[],i=e.map(t).flat().reduce((function(t,e){return e.id?t.has(e.id)?t.set(e.id,Object.assign(t.get(e.id),e)):t.set(e.id,e):r.push(e),t}),new Map);return Array.from(i.values()).concat(r)}return t(e.children)},P=function t(e){return void 0===e||void 0===e.children||0===e.children.length?[]:2===e.children.length?[].concat(t(e.children[0]),void 0!==e.kind&&"pair"!==e.kind?[g([$(e.children[0]),A(e.children[1])],e.kind,e.id,e.labels,e.record)]:[],t(e.children[1])):e.children.reduce((function(e,n){return[].concat(e,t(n))}),[])},M=function(t){if(t)throw t},O=function(t){return null!=t&&null!=t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)},T=Object.prototype.hasOwnProperty,j=Object.prototype.toString,C=Object.defineProperty,I=Object.getOwnPropertyDescriptor,q=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===j.call(t)},L=function(t){if(!t||"[object Object]"!==j.call(t))return!1;var e,n=T.call(t,"constructor"),r=t.constructor&&t.constructor.prototype&&T.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!r)return!1;for(e in t);return void 0===e||T.call(t,e)},R=function(t,e){C&&"__proto__"===e.name?C(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},D=function(t,e){if("__proto__"===e){if(!T.call(t,e))return;if(I)return I(t,e).value}return t[e]},z=function t(){var e,n,r,i,o,s,a=arguments[0],u=1,l=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[1]||{},u=2),(null==a||"object"!=typeof a&&"function"!=typeof a)&&(a={});u<l;++u)if(null!=(e=arguments[u]))for(n in e)r=D(a,n),a!==(i=D(e,n))&&(c&&i&&(L(i)||(o=q(i)))?(o?(o=!1,s=r&&q(r)?r:[]):s=r&&L(r)?r:{},R(a,{name:n,newValue:t(c,s,i)})):void 0!==i&&R(a,{name:n,newValue:i}));return a},B=t=>{if("[object Object]"!==Object.prototype.toString.call(t))return!1;const e=Object.getPrototypeOf(t);return null===e||e===Object.prototype},V=[].slice,G=function(t,e){var n;return function(){var e,o=V.call(arguments,0),s=t.length>o.length;s&&o.push(r);try{e=t.apply(null,o)}catch(t){if(s&&n)throw t;return r(t)}s||(e&&"function"==typeof e.then?e.then(i,r):e instanceof Error?r(e):i(e))};function r(){n||(n=!0,e.apply(null,arguments))}function i(t){r(null,t)}},U=X;X.wrap=G;var F=[].slice;function X(){var t=[],e={run:function(){var e=-1,n=F.call(arguments,0,-1),r=arguments[arguments.length-1];if("function"!=typeof r)throw new Error("Expected function as last argument, not "+r);function i(o){var s=t[++e],a=F.call(arguments,0),u=a.slice(1),l=n.length,c=-1;if(o)r(o);else{for(;++c<l;)null==u[c]&&(u[c]=n[c]);n=u,s?G(s,i).apply(null,n):r.apply(null,[null].concat(n))}}i.apply(null,[null].concat(n))},use:function(n){if("function"!=typeof n)throw new Error("Expected `fn` to be a function, not "+n);return t.push(n),e}};return e}var H={}.hasOwnProperty,Q=function(t){return t&&"object"==typeof t?H.call(t,"position")||H.call(t,"type")?J(t.position):H.call(t,"start")||H.call(t,"end")?J(t):H.call(t,"line")||H.call(t,"column")?Z(t):"":""};function Z(t){return t&&"object"==typeof t||(t={}),K(t.line)+":"+K(t.column)}function J(t){return t&&"object"==typeof t||(t={}),Z(t.start)+"-"+Z(t.end)}function K(t){return t&&"number"==typeof t?t:1}var Y=et;function W(){}W.prototype=Error.prototype;var tt=et.prototype=new W;function et(t,e,n){var r,i,o;"string"==typeof e&&(n=e,e=null),r=function(t){var e,n=[null,null];return"string"==typeof t&&(-1===(e=t.indexOf(":"))?n[1]=t:(n[0]=t.slice(0,e),n[1]=t.slice(e+1))),n}(n),i=Q(e)||"1:1",o={start:{line:null,column:null},end:{line:null,column:null}},e&&e.position&&(e=e.position),e&&(e.start?(o=e,e=e.start):o.start=e),t.stack&&(this.stack=t.stack,t=t.message),this.message=t,this.name=i,this.reason=t,this.line=e?e.line:null,this.column=e?e.column:null,this.location=o,this.source=r[0],this.ruleId=r[1]}function nt(t){var e,n;return rt(t),e=47===t.charCodeAt(0),(n=function(t,e){for(var n,r,i="",o=0,s=-1,a=0,u=-1;++u<=t.length;){if(u<t.length)n=t.charCodeAt(u);else{if(47===n)break;n=47}if(47===n){if(s===u-1||1===a);else if(s!==u-1&&2===a){if(i.length<2||2!==o||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2))if(i.length>2){if((r=i.lastIndexOf("/"))!==i.length-1){r<0?(i="",o=0):o=(i=i.slice(0,r)).length-1-i.lastIndexOf("/"),s=u,a=0;continue}}else if(i.length){i="",o=0,s=u,a=0;continue}e&&(i=i.length?i+"/..":"..",o=2)}else i.length?i+="/"+t.slice(s+1,u):i=t.slice(s+1,u),o=u-s-1;s=u,a=0}else 46===n&&a>-1?a++:a=-1}return i}(t,!e)).length||e||(n="."),n.length&&47===t.charCodeAt(t.length-1)&&(n+="/"),e?"/"+n:n}function rt(t){if("string"!=typeof t)throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}tt.file="",tt.name="",tt.reason="",tt.message="",tt.stack="",tt.fatal=null,tt.column=null,tt.line=null;var it=function(t,e){var n,r,i,o,s=0,a=-1;if(void 0!==e&&"string"!=typeof e)throw new TypeError('"ext" argument must be a string');if(rt(t),n=t.length,void 0===e||!e.length||e.length>t.length){for(;n--;)if(47===t.charCodeAt(n)){if(i){s=n+1;break}}else a<0&&(i=!0,a=n+1);return a<0?"":t.slice(s,a)}if(e===t)return"";for(r=-1,o=e.length-1;n--;)if(47===t.charCodeAt(n)){if(i){s=n+1;break}}else r<0&&(i=!0,r=n+1),o>-1&&(t.charCodeAt(n)===e.charCodeAt(o--)?o<0&&(a=n):(o=-1,a=r));return s===a?a=r:a<0&&(a=t.length),t.slice(s,a)},ot=function(){for(var t,e=-1;++e<arguments.length;)rt(arguments[e]),arguments[e]&&(t=void 0===t?arguments[e]:t+"/"+arguments[e]);return void 0===t?".":nt(t)},st=lt,at={}.hasOwnProperty,ut=["history","path","basename","stem","extname","dirname"];function lt(t){var e,n;if(t){if("string"==typeof t||O(t))t={contents:t};else if("message"in t&&"messages"in t)return t}else t={};if(!(this instanceof lt))return new lt(t);for(this.data={},this.messages=[],this.history=[],this.cwd="/",n=-1;++n<ut.length;)at.call(t,e=ut[n])&&(this[e]=t[e]);for(e in t)ut.indexOf(e)<0&&(this[e]=t[e])}function ct(t,e){if(t&&t.indexOf("/")>-1)throw new Error("`"+e+"` cannot be a path: did not expect `/`")}function ft(t,e){if(!t)throw new Error("`"+e+"` cannot be empty")}function ht(t,e){if(!t)throw new Error("Setting `"+e+"` requires `path` to be set too")}lt.prototype.toString=function(t){return(this.contents||"").toString(t)},Object.defineProperty(lt.prototype,"path",{get:function(){return this.history[this.history.length-1]},set:function(t){ft(t,"path"),this.path!==t&&this.history.push(t)}}),Object.defineProperty(lt.prototype,"dirname",{get:function(){return"string"==typeof this.path?function(t){var e,n,r;if(rt(t),!t.length)return".";for(e=-1,r=t.length;--r;)if(47===t.charCodeAt(r)){if(n){e=r;break}}else n||(n=!0);return e<0?47===t.charCodeAt(0)?"/":".":1===e&&47===t.charCodeAt(0)?"//":t.slice(0,e)}(this.path):void 0},set:function(t){ht(this.path,"dirname"),this.path=ot(t||"",this.basename)}}),Object.defineProperty(lt.prototype,"basename",{get:function(){return"string"==typeof this.path?it(this.path):void 0},set:function(t){ft(t,"basename"),ct(t,"basename"),this.path=ot(this.dirname||"",t)}}),Object.defineProperty(lt.prototype,"extname",{get:function(){return"string"==typeof this.path?function(t){var e,n,r,i=-1,o=0,s=-1,a=0;for(rt(t),r=t.length;r--;)if(47!==(n=t.charCodeAt(r)))s<0&&(e=!0,s=r+1),46===n?i<0?i=r:1!==a&&(a=1):i>-1&&(a=-1);else if(e){o=r+1;break}return i<0||s<0||0===a||1===a&&i===s-1&&i===o+1?"":t.slice(i,s)}(this.path):void 0},set:function(t){if(ct(t,"extname"),ht(this.path,"extname"),t){if(46!==t.charCodeAt(0))throw new Error("`extname` must start with `.`");if(t.indexOf(".",1)>-1)throw new Error("`extname` cannot contain multiple dots")}this.path=ot(this.dirname,this.stem+(t||""))}}),Object.defineProperty(lt.prototype,"stem",{get:function(){return"string"==typeof this.path?it(this.path,this.extname):void 0},set:function(t){ft(t,"stem"),ct(t,"stem"),this.path=ot(this.dirname||"",t+(this.extname||""))}});var pt=st;st.prototype.message=function(t,e,n){var r=new Y(t,e,n);return this.path&&(r.name=this.path+":"+r.name,r.file=this.path),r.fatal=!1,this.messages.push(r),r},st.prototype.info=function(){var t=this.message.apply(this,arguments);return t.fatal=null,t},st.prototype.fail=function(){var t=this.message.apply(this,arguments);throw t.fatal=!0,t};var dt=pt,yt=function t(){var e=[],n=U(),r={},i=!1,o=-1;return s.data=function(t,e){return"string"==typeof t?2===arguments.length?(xt("data",i),r[t]=e,s):gt.call(r,t)&&r[t]||null:t?(xt("data",i),r=t,s):r},s.freeze=a,s.attachers=e,s.use=function(t){var n;if(xt("use",i),null==t);else if("function"==typeof t)c.apply(null,arguments);else{if("object"!=typeof t)throw new Error("Expected usable value, not `"+t+"`");"length"in t?l(t):o(t)}return n&&(r.settings=z(r.settings||{},n)),s;function o(t){l(t.plugins),t.settings&&(n=z(n||{},t.settings))}function a(t){if("function"==typeof t)c(t);else{if("object"!=typeof t)throw new Error("Expected usable value, not `"+t+"`");"length"in t?c.apply(null,t):o(t)}}function l(t){var e,n;if(null==t);else{if("object"!=typeof t||!("length"in t))throw new Error("Expected a list of plugins, not `"+t+"`");for(e=t.length,n=-1;++n<e;)a(t[n])}}function c(t,n){var r=u(t);r?(B(r[1])&&B(n)&&(n=z(r[1],n)),r[1]=n):e.push(mt.call(arguments))}},s.parse=function(t){var e,n=dt(t);return a(),wt("parse",e=s.Parser),bt(e,"parse")?new e(String(n),n).parse():e(String(n),n)},s.stringify=function(t,e){var n,r=dt(e);return a(),_t("stringify",n=s.Compiler),kt(t),bt(n,"compile")?new n(t,r).compile():n(t,r)},s.run=l,s.runSync=function(t,e){var n,r=!1;return l(t,e,(function(t,e){r=!0,M(t),n=e})),Et("runSync","run",r),n},s.process=c,s.processSync=function(t){var e,n=!1;return a(),wt("processSync",s.Parser),_t("processSync",s.Compiler),c(e=dt(t),(function(t){n=!0,M(t)})),Et("processSync","process",n),e},s;function s(){for(var n=t(),i=e.length,o=-1;++o<i;)n.use.apply(null,e[o]);return n.data(z(!0,{},r)),n}function a(){var t,r,a,u;if(i)return s;for(;++o<e.length;)r=(t=e[o])[0],!1!==(a=t[1])&&(!0===a&&(t[1]=void 0),"function"==typeof(u=r.apply(s,t.slice(1)))&&n.use(u));return i=!0,o=Infinity,s}function u(t){for(var n,r=e.length,i=-1;++i<r;)if((n=e[i])[0]===t)return n}function l(t,e,r){if(kt(t),a(),r||"function"!=typeof e||(r=e,e=null),!r)return new Promise(i);function i(i,o){n.run(t,dt(e),(function(e,n,s){n=n||t,e?o(e):i?i(n):r(null,n,s)}))}i(null,r)}function c(t,e){if(a(),wt("process",s.Parser),_t("process",s.Compiler),!e)return new Promise(n);function n(n,r){var i=dt(t);vt.run(s,{file:i},(function(t){t?r(t):n?n(i):e(null,i)}))}n(null,e)}}().freeze(),mt=[].slice,gt={}.hasOwnProperty,vt=U().use((function(t,e){e.tree=t.parse(e.file)})).use((function(t,e,n){t.run(e.tree,e.file,(function(t,r,i){t?n(t):(e.tree=r,e.file=i,n())}))})).use((function(t,e){var n=t.stringify(e.tree,e.file),r=e.file;null==n||("string"==typeof n||O(n)?r.contents=n:r.result=n)}));function bt(t,e){return"function"==typeof t&&t.prototype&&(function(t){var e;for(e in t)return!0;return!1}(t.prototype)||e in t.prototype)}function wt(t,e){if("function"!=typeof e)throw new Error("Cannot `"+t+"` without `Parser`")}function _t(t,e){if("function"!=typeof e)throw new Error("Cannot `"+t+"` without `Compiler`")}function xt(t,e){if(e)throw new Error("Cannot invoke `"+t+"` on a frozen processor.\nCreate a new processor first, by invoking it: use `processor()` instead of `processor`.")}function kt(t){if(!t||"string"!=typeof t.type)throw new Error("Expected node, got `"+t+"`")}function Et(t,e,n){if(!n)throw new Error("`"+t+"` finished async. Use `"+e+"` instead")}var St="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function At(t,e){return t(e={exports:{}},e.exports),e.exports}var $t=At((function(t){!function(e,n){t.exports?t.exports=n():e.nearley=n()}(St,(function(){function t(e,n,r){return this.id=++t.highestId,this.name=e,this.symbols=n,this.postprocess=r,this}function e(t,e,n,r){this.rule=t,this.dot=e,this.reference=n,this.data=[],this.wantedBy=r,this.isComplete=this.dot===t.symbols.length}function n(t,e){this.grammar=t,this.index=e,this.states=[],this.wants={},this.scannable=[],this.completed={}}function r(t,e){this.rules=t,this.start=e||this.rules[0].name;var n=this.byName={};this.rules.forEach((function(t){n.hasOwnProperty(t.name)||(n[t.name]=[]),n[t.name].push(t)}))}function i(){this.reset("")}function o(t,e,o){if(t instanceof r){var s=t;o=e}else s=r.fromCompiled(t,e);for(var a in this.grammar=s,this.options={keepHistory:!1,lexer:s.lexer||new i},o||{})this.options[a]=o[a];this.lexer=this.options.lexer,this.lexerState=void 0;var u=new n(s,0);this.table=[u],u.wants[s.start]=[],u.predict(s.start),u.process(),this.current=0}function s(t){var e=typeof t;if("string"===e)return t;if("object"===e){if(t.literal)return JSON.stringify(t.literal);if(t instanceof RegExp)return t.toString();if(t.type)return"%"+t.type;if(t.test)return"<"+String(t.test)+">";throw new Error("Unknown symbol type: "+t)}}return t.highestId=0,t.prototype.toString=function(t){var e=void 0===t?this.symbols.map(s).join(" "):this.symbols.slice(0,t).map(s).join(" ")+" ● "+this.symbols.slice(t).map(s).join(" ");return this.name+" → "+e},e.prototype.toString=function(){return"{"+this.rule.toString(this.dot)+"}, from: "+(this.reference||0)},e.prototype.nextState=function(t){var n=new e(this.rule,this.dot+1,this.reference,this.wantedBy);return n.left=this,n.right=t,n.isComplete&&(n.data=n.build(),n.right=void 0),n},e.prototype.build=function(){var t=[],e=this;do{t.push(e.right.data),e=e.left}while(e.left);return t.reverse(),t},e.prototype.finish=function(){this.rule.postprocess&&(this.data=this.rule.postprocess(this.data,this.reference,o.fail))},n.prototype.process=function(t){for(var e=this.states,n=this.wants,r=this.completed,i=0;i<e.length;i++){var s=e[i];if(s.isComplete){if(s.finish(),s.data!==o.fail){for(var a=s.wantedBy,u=a.length;u--;)this.complete(a[u],s);s.reference===this.index&&(this.completed[l=s.rule.name]=this.completed[l]||[]).push(s)}}else{var l;if("string"!=typeof(l=s.rule.symbols[s.dot])){this.scannable.push(s);continue}if(n[l]){if(n[l].push(s),r.hasOwnProperty(l)){var c=r[l];for(u=0;u<c.length;u++)this.complete(s,c[u])}}else n[l]=[s],this.predict(l)}}},n.prototype.predict=function(t){for(var n=this.grammar.byName[t]||[],r=0;r<n.length;r++){var i=new e(n[r],0,this.index,this.wants[t]);this.states.push(i)}},n.prototype.complete=function(t,e){var n=t.nextState(e);this.states.push(n)},r.fromCompiled=function(e,n){var i=e.Lexer;e.ParserStart&&(n=e.ParserStart,e=e.ParserRules);var o=new r(e=e.map((function(e){return new t(e.name,e.symbols,e.postprocess)})),n);return o.lexer=i,o},i.prototype.reset=function(t,e){this.buffer=t,this.index=0,this.line=e?e.line:1,this.lastLineBreak=e?-e.col:0},i.prototype.next=function(){if(this.index<this.buffer.length){var t=this.buffer[this.index++];return"\n"===t&&(this.line+=1,this.lastLineBreak=this.index),{value:t}}},i.prototype.save=function(){return{line:this.line,col:this.index-this.lastLineBreak}},i.prototype.formatError=function(t,e){var n=this.buffer;if("string"==typeof n){var r=n.split("\n").slice(Math.max(0,this.line-5),this.line),i=n.indexOf("\n",this.index);-1===i&&(i=n.length);var o=this.index-this.lastLineBreak,s=String(this.line).length;return e+=" at line "+this.line+" col "+o+":\n\n",(e+=r.map((function(t,e){return a(this.line-r.length+e+1,s)+" "+t}),this).join("\n"))+"\n"+a("",s+o)+"^\n"}return e+" at index "+(this.index-1);function a(t,e){var n=String(t);return Array(e-n.length+1).join(" ")+n}},o.fail={},o.prototype.feed=function(t){var e,r=this.lexer;for(r.reset(t,this.lexerState);;){try{if(!(e=r.next()))break}catch(t){var o=new n(this.grammar,this.current+1);throw this.table.push(o),(u=new Error(this.reportLexerError(t))).offset=this.current,u.token=t.token,u}var s=this.table[this.current];this.options.keepHistory||delete this.table[this.current-1];var a=this.current+1;o=new n(this.grammar,a),this.table.push(o);for(var u,l=void 0!==e.text?e.text:e.value,c=r.constructor===i?e.value:e,f=s.scannable,h=f.length;h--;){var p=f[h],d=p.rule.symbols[p.dot];if(d.test?d.test(c):d.type?d.type===e.type:d.literal===l){var y=p.nextState({data:c,token:e,isToken:!0,reference:a-1});o.states.push(y)}}if(o.process(),0===o.states.length)throw(u=new Error(this.reportError(e))).offset=this.current,u.token=e,u;this.options.keepHistory&&(s.lexerState=r.save()),this.current++}return s&&(this.lexerState=r.save()),this.results=this.finish(),this},o.prototype.reportLexerError=function(t){var e,n,r=t.token;return r?(e="input "+JSON.stringify(r.text[0])+" (lexer error)",n=this.lexer.formatError(r,"Syntax error")):(e="input (lexer error)",n=t.message),this.reportErrorCommon(n,e)},o.prototype.reportError=function(t){var e=(t.type?t.type+" token: ":"")+JSON.stringify(void 0!==t.value?t.value:t),n=this.lexer.formatError(t,"Syntax error");return this.reportErrorCommon(n,e)},o.prototype.reportErrorCommon=function(t,e){var n=[];n.push(t);var r=this.table[this.table.length-2],i=r.states.filter((function(t){var e=t.rule.symbols[t.dot];return e&&"string"!=typeof e}));return 0===i.length?(n.push("Unexpected "+e+". I did not expect any more input. Here is the state of my parse table:\n"),this.displayStateStack(r.states,n)):(n.push("Unexpected "+e+". Instead, I was expecting to see one of the following:\n"),i.map((function(t){return this.buildFirstStateStack(t,[])||[t]}),this).forEach((function(t){var e=t[0],r=this.getSymbolDisplay(e.rule.symbols[e.dot]);n.push("A "+r+" based on:"),this.displayStateStack(t,n)}),this)),n.push(""),n.join("\n")},o.prototype.displayStateStack=function(t,e){for(var n,r=0,i=0;i<t.length;i++){var o=t[i],s=o.rule.toString(o.dot);s===n?r++:(r>0&&e.push("    ^ "+r+" more lines identical to this"),r=0,e.push("    "+s)),n=s}},o.prototype.getSymbolDisplay=function(t){return function(t){var e=typeof t;if("string"===e)return t;if("object"===e){if(t.literal)return JSON.stringify(t.literal);if(t instanceof RegExp)return"character matching "+t;if(t.type)return t.type+" token";if(t.test)return"token matching "+String(t.test);throw new Error("Unknown symbol type: "+t)}}(t)},o.prototype.buildFirstStateStack=function(t,e){if(-1!==e.indexOf(t))return null;if(0===t.wantedBy.length)return[t];var n=t.wantedBy[0],r=[t].concat(e),i=this.buildFirstStateStack(n,r);return null===i?null:[t].concat(i)},o.prototype.save=function(){var t=this.table[this.current];return t.lexerState=this.lexerState,t},o.prototype.restore=function(t){var e=t.index;this.current=e,this.table[e]=t,this.table.splice(e+1),this.lexerState=t.lexerState,this.results=this.finish()},o.prototype.rewind=function(t){if(!this.options.keepHistory)throw new Error("set option `keepHistory` to enable rewinding");this.restore(this.table[t])},o.prototype.finish=function(){var t=[],e=this.grammar.start;return this.table[this.table.length-1].states.forEach((function(n){n.rule.name===e&&n.dot===n.rule.symbols.length&&0===n.reference&&n.data!==o.fail&&t.push(n)})),t.map((function(t){return t.data}))},{Parser:o,Grammar:r,Rule:t}}))}));function Nt(){return(Nt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function Pt(t){return t[0]}var Mt=At((function(t){!function(e,n){t.exports?t.exports=n():e.moo=n()}(St,(function(){var t=Object.prototype.hasOwnProperty,e=Object.prototype.toString,n="boolean"==typeof(new RegExp).sticky;function r(t){return t&&"[object RegExp]"===e.call(t)}function i(t){return t&&"object"==typeof t&&!r(t)&&!Array.isArray(t)}function o(t){return new RegExp("|"+t).exec("").length-1}function s(t){return"("+t+")"}function a(t){return t.length?"(?:"+t.map((function(t){return"(?:"+t+")"})).join("|")+")":"(?!)"}function u(t){if("string"==typeof t)return"(?:"+function(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}(t)+")";if(r(t)){if(t.ignoreCase)throw new Error("RegExp /i flag not allowed");if(t.global)throw new Error("RegExp /g flag is implied");if(t.sticky)throw new Error("RegExp /y flag is implied");if(t.multiline)throw new Error("RegExp /m flag is implied");return t.source}throw new Error("Not a pattern: "+t)}function l(e,n){if(i(n)||(n={match:n}),n.include)throw new Error("Matching rules cannot also include states");var o={defaultType:e,lineBreaks:!!n.error||!!n.fallback,pop:!1,next:null,push:null,error:!1,fallback:!1,value:null,type:null,shouldThrow:!1};for(var s in n)t.call(n,s)&&(o[s]=n[s]);if("string"==typeof o.type&&e!==o.type)throw new Error("Type transform cannot be a string (type '"+o.type+"' for token '"+e+"')");var a=o.match;return o.match=Array.isArray(a)?a:a?[a]:[],o.match.sort((function(t,e){return r(t)&&r(e)?0:r(e)?-1:r(t)?1:e.length-t.length})),o}function c(t){return Array.isArray(t)?function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];if(r.include)for(var i=[].concat(r.include),o=0;o<i.length;o++)e.push({include:i[o]});else{if(!r.type)throw new Error("Rule has no type: "+JSON.stringify(r));e.push(l(r.type,r))}}return e}(t):function(t){for(var e=Object.getOwnPropertyNames(t),n=[],r=0;r<e.length;r++){var o=e[r],s=[].concat(t[o]);if("include"!==o){var a=[];s.forEach((function(t){i(t)?(a.length&&n.push(l(o,a)),n.push(l(o,t)),a=[]):a.push(t)})),a.length&&n.push(l(o,a))}else for(var u=0;u<s.length;u++)n.push({include:s[u]})}return n}(t)}var f=l("error",{lineBreaks:!0,shouldThrow:!0});function h(t,e){for(var i=null,l=Object.create(null),c=!0,h=null,p=[],d=[],y=0;y<t.length;y++)t[y].fallback&&(c=!1);for(y=0;y<t.length;y++){var m=t[y];if(m.include)throw new Error("Inheritance is not allowed in stateless lexers");if(m.error||m.fallback){if(i)throw!m.fallback==!i.fallback?new Error("Multiple "+(m.fallback?"fallback":"error")+" rules not allowed (for token '"+m.defaultType+"')"):new Error("fallback and error are mutually exclusive (for token '"+m.defaultType+"')");i=m}var g=m.match.slice();if(c)for(;g.length&&"string"==typeof g[0]&&1===g[0].length;)l[g.shift().charCodeAt(0)]=m;if(m.pop||m.push||m.next){if(!e)throw new Error("State-switching options are not allowed in stateless lexers (for token '"+m.defaultType+"')");if(m.fallback)throw new Error("State-switching options are not allowed on fallback tokens (for token '"+m.defaultType+"')")}if(0!==g.length){c=!1,p.push(m);for(var v=0;v<g.length;v++){var b=g[v];if(r(b))if(null===h)h=b.unicode;else if(h!==b.unicode&&!1===m.fallback)throw new Error("If one rule is /u then all must be")}var w=a(g.map(u)),_=new RegExp(w);if(_.test(""))throw new Error("RegExp matches empty string: "+_);if(o(w)>0)throw new Error("RegExp has capture groups: "+_+"\nUse (?: … ) instead");if(!m.lineBreaks&&_.test("\n"))throw new Error("Rule should declare lineBreaks: "+_);d.push(s(w))}}var x=i&&i.fallback,k=n&&!x?"ym":"gm",E=n||x?"":"|";return!0===h&&(k+="u"),{regexp:new RegExp(a(d)+E,k),groups:p,fast:l,error:i||f}}function p(t,e,n){var r=t&&(t.push||t.next);if(r&&!n[r])throw new Error("Missing state '"+r+"' (in token '"+t.defaultType+"' of state '"+e+"')");if(t&&t.pop&&1!=+t.pop)throw new Error("pop must be 1 (in token '"+t.defaultType+"' of state '"+e+"')")}var d=function(t,e){this.startState=e,this.states=t,this.buffer="",this.stack=[],this.reset()};d.prototype.reset=function(t,e){return this.buffer=t||"",this.index=0,this.line=e?e.line:1,this.col=e?e.col:1,this.queuedToken=e?e.queuedToken:null,this.queuedThrow=e?e.queuedThrow:null,this.setState(e?e.state:this.startState),this.stack=e&&e.stack?e.stack.slice():[],this},d.prototype.save=function(){return{line:this.line,col:this.col,state:this.state,stack:this.stack.slice(),queuedToken:this.queuedToken,queuedThrow:this.queuedThrow}},d.prototype.setState=function(t){if(t&&this.state!==t){this.state=t;var e=this.states[t];this.groups=e.groups,this.error=e.error,this.re=e.regexp,this.fast=e.fast}},d.prototype.popState=function(){this.setState(this.stack.pop())},d.prototype.pushState=function(t){this.stack.push(this.state),this.setState(t)};var y=n?function(t,e){return t.exec(e)}:function(t,e){var n=t.exec(e);return 0===n[0].length?null:n};function m(){return this.value}if(d.prototype._getGroup=function(t){for(var e=this.groups.length,n=0;n<e;n++)if(void 0!==t[n+1])return this.groups[n];throw new Error("Cannot find token type for matched text")},d.prototype.next=function(){var t=this.index;if(this.queuedGroup){var e=this._token(this.queuedGroup,this.queuedText,t);return this.queuedGroup=null,this.queuedText="",e}var n=this.buffer;if(t!==n.length){if(s=this.fast[n.charCodeAt(t)])return this._token(s,n.charAt(t),t);var r=this.re;r.lastIndex=t;var i=y(r,n),o=this.error;if(null==i)return this._token(o,n.slice(t,n.length),t);var s=this._getGroup(i),a=i[0];return o.fallback&&i.index!==t?(this.queuedGroup=s,this.queuedText=a,this._token(o,n.slice(t,i.index),t)):this._token(s,a,t)}},d.prototype._token=function(t,e,n){var r=0;if(t.lineBreaks){var i=/\n/g,o=1;if("\n"===e)r=1;else for(;i.exec(e);)r++,o=i.lastIndex}var s={type:"function"==typeof t.type&&t.type(e)||t.defaultType,value:"function"==typeof t.value?t.value(e):e,text:e,toString:m,offset:n,lineBreaks:r,line:this.line,col:this.col},a=e.length;if(this.index+=a,this.line+=r,0!==r?this.col=a-o+1:this.col+=a,t.shouldThrow)throw new Error(this.formatError(s,"invalid syntax"));return t.pop?this.popState():t.push?this.pushState(t.push):t.next&&this.setState(t.next),s},"undefined"!=typeof Symbol&&Symbol.iterator){var g=function(t){this.lexer=t};g.prototype.next=function(){var t=this.lexer.next();return{value:t,done:!t}},g.prototype[Symbol.iterator]=function(){return this},d.prototype[Symbol.iterator]=function(){return new g(this)}}return d.prototype.formatError=function(t,e){if(null==t){var n=this.buffer.slice(this.index);t={text:n,offset:this.index,lineBreaks:-1===n.indexOf("\n")?0:1,line:this.line,col:this.col}}var r=Math.max(0,t.offset-t.col+1),i=t.lineBreaks?t.text.indexOf("\n"):t.text.length,o=this.buffer.substring(r,t.offset+i);return e+=" at line "+t.line+" col "+t.col+":\n\n",(e+="  "+o+"\n")+"  "+Array(t.col).join(" ")+"^"},d.prototype.clone=function(){return new d(this.states,this.state)},d.prototype.has=function(t){return!0},{compile:function(t){var e=h(c(t));return new d({start:e},"start")},states:function(t,e){var n=t.$all?c(t.$all):[];delete t.$all;var r=Object.getOwnPropertyNames(t);e||(e=r[0]);for(var i=Object.create(null),o=0;o<r.length;o++)i[b=r[o]]=c(t[b]).concat(n);for(o=0;o<r.length;o++)for(var s=i[b=r[o]],a=Object.create(null),u=0;u<s.length;u++){var l=s[u];if(l.include){var f=[u,1];if(l.include!==b&&!a[l.include]){a[l.include]=!0;var y=i[l.include];if(!y)throw new Error("Cannot include nonexistent state '"+l.include+"' (in state '"+b+"')");for(var m=0;m<y.length;m++){var g=y[m];-1===s.indexOf(g)&&f.push(g)}}s.splice.apply(s,f),u--}}var v=Object.create(null);for(o=0;o<r.length;o++){var b;v[b=r[o]]=h(i[b],!0)}for(o=0;o<r.length;o++){var w=r[o],_=v[w],x=_.groups;for(u=0;u<x.length;u++)p(x[u],w,v);var k=Object.getOwnPropertyNames(_.fast);for(u=0;u<k.length;u++)p(_.fast[k[u]],w,v)}return new d(v,e)},error:Object.freeze({error:!0}),fallback:Object.freeze({fallback:!0}),keywords:function(t){for(var e=Object.create(null),n=Object.create(null),r=Object.getOwnPropertyNames(t),i=0;i<r.length;i++){var o=r[i],s=t[o];(Array.isArray(s)?s:[s]).forEach((function(t){if((n[t.length]=n[t.length]||[]).push(t),"string"!=typeof t)throw new Error("keyword must be string (in keyword '"+o+"')");e[t]=o}))}function a(t){return JSON.stringify(t)}var u="";for(var l in u+="switch (value.length) {\n",n)u+="case "+l+":\n",u+="switch (value) {\n",n[l].forEach((function(t){var n=e[t];u+="case "+a(t)+": return "+a(n)+"\n"})),u+="}\n";return u+="}\n",Function("value",u)}}}))})).compile({whitespace:{match:/\s+/,lineBreaks:!0},lineComment:{match:/\/\/.*?\n?$/},hexadecimal:a.hexadecimal,octal:a.octal,measurement:a.measurement,decimal:a.decimal,integer:a.integer,taggedString:{match:a.taggedString},boolean:["true","TRUE","True","false","FALSE","False"],symbol:a.symbol,identifier:a.identifier,doubleQuotedString:{match:a.doubleQuotedString,value:function(t){return t.slice(1,-1)}},singleQuotedString:{match:a.singleQuotedString,value:function(t){return t.slice(1,-1)}},tickedString:{match:a.tickedString,value:function(t){return t.slice(1,-1)}},"--\x3e":"--\x3e","--":"--","<--":"<--","-[]->":"-[]->","-[]-":"-[]-","<-[]-":"<-[]-","<-[":"<-[","]->":"]->","-[":"-[","]-":"]-","{":"{","}":"}","[":"[","]":"]","(":"(",")":")",",":",",":":":","`":"`","'":"'","ø":"ø"}),Ot=function(){return null},Tt=function(t){return t[0].text},jt={Lexer:Mt,ParserRules:[{name:"GramSeq$ebnf$1$subexpression$1",symbols:["Path"],postprocess:function(t){return t[0]}},{name:"GramSeq$ebnf$1",symbols:["GramSeq$ebnf$1$subexpression$1"]},{name:"GramSeq$ebnf$1$subexpression$2",symbols:["Path"],postprocess:function(t){return t[0]}},{name:"GramSeq$ebnf$1",symbols:["GramSeq$ebnf$1","GramSeq$ebnf$1$subexpression$2"],postprocess:function(t){return t[0].concat([t[1]])}},{name:"GramSeq",symbols:["_","GramSeq$ebnf$1"],postprocess:function(t){var e;return void 0===e&&(e=1),h({type:"seq",id:void 0},void 0,void 0,{children:p(t[1].flat(e).filter((function(t){return null!==t})))})}},{name:"Path",symbols:["NodePattern"],postprocess:Pt},{name:"Path",symbols:["PathComposition"],postprocess:Pt},{name:"Path",symbols:["PathPair"],postprocess:Pt},{name:"NodePattern",symbols:["Node","_","Edge","_","NodePattern"],postprocess:function(t){var e=t[2];return d([t[0],t[4]],{kind:e.kind,id:e.id,labels:e.labels,record:e.record})}},{name:"NodePattern",symbols:["Node"],postprocess:Pt},{name:"Node$ebnf$1",symbols:["Attributes"],postprocess:Pt},{name:"Node$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"Node",symbols:[{literal:"("},"_","Node$ebnf$1",{literal:")"},"_"],postprocess:function(t){var e=t[2];return e?m(e.id,e.labels,e.record):m()}},{name:"Edge$ebnf$1",symbols:["Attributes"],postprocess:Pt},{name:"Edge$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"Edge",symbols:[{literal:"-["},"_","Edge$ebnf$1",{literal:"]->"},"_"],postprocess:function(t){return Nt({kind:"right"},t[2])}},{name:"Edge$ebnf$2",symbols:["Attributes"],postprocess:Pt},{name:"Edge$ebnf$2",symbols:[],postprocess:function(){return null}},{name:"Edge",symbols:[{literal:"-["},"_","Edge$ebnf$2",{literal:"]-"},"_"],postprocess:function(t){return Nt({kind:"either"},t[2])}},{name:"Edge$ebnf$3",symbols:["Attributes"],postprocess:Pt},{name:"Edge$ebnf$3",symbols:[],postprocess:function(){return null}},{name:"Edge",symbols:[{literal:"<-["},"_","Edge$ebnf$3",{literal:"]-"},"_"],postprocess:function(t){return Nt({kind:"left"},t[2])}},{name:"Edge",symbols:[{literal:"-[]->"},"_"],postprocess:function(){return{kind:"right"}}},{name:"Edge",symbols:[{literal:"-[]-"},"_"],postprocess:function(){return{kind:"either"}}},{name:"Edge",symbols:[{literal:"<-[]-"},"_"],postprocess:function(){return{kind:"left"}}},{name:"Edge",symbols:[{literal:"--\x3e"},"_"],postprocess:function(){return{kind:"right"}}},{name:"Edge",symbols:[{literal:"--"},"_"],postprocess:function(){return{kind:"either"}}},{name:"Edge",symbols:[{literal:"<--"},"_"],postprocess:function(){return{kind:"left"}}},{name:"PathComposition",symbols:["PathPoint"],postprocess:Pt},{name:"PathComposition",symbols:["PathAnnotation"],postprocess:Pt},{name:"PathComposition",symbols:["PathExpression"],postprocess:Pt},{name:"PathPoint$ebnf$1",symbols:["Attributes"],postprocess:Pt},{name:"PathPoint$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"PathPoint",symbols:[{literal:"["},"_","PathPoint$ebnf$1",{literal:"]"},"_"],postprocess:function(t){var e=t[2];return e&&(e.id||e.labels||e.record)&&"ø"!==e.id?m(e.id,e.labels,e.record):y}},{name:"PathAnnotation$ebnf$1",symbols:["Attributes"],postprocess:Pt},{name:"PathAnnotation$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"PathAnnotation",symbols:[{literal:"["},"_","PathAnnotation$ebnf$1","Path",{literal:"]"},"_"],postprocess:function(t){var e=t[2];return d([t[3]],e?{id:e.id,labels:e.labels,record:e.record}:{})}},{name:"PathExpression$ebnf$1",symbols:["Attributes"],postprocess:Pt},{name:"PathExpression$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"PathExpression$ebnf$2",symbols:["Kind"],postprocess:Pt},{name:"PathExpression$ebnf$2",symbols:[],postprocess:function(){return null}},{name:"PathExpression",symbols:[{literal:"["},"_","PathExpression$ebnf$1","PathExpression$ebnf$2","Path","Path",{literal:"]"},"_"],postprocess:function(t){var e=t[2];return d([t[4],t[5]],{kind:t[3],id:e.id,labels:e.labels,record:e.record})}},{name:"PathPair$subexpression$1",symbols:["NodePattern"]},{name:"PathPair$subexpression$1",symbols:["PathComposition"]},{name:"PathPair",symbols:["PathPair$subexpression$1",{literal:","},"_","Path"],postprocess:function(t){return function(t,e,n,r,i){return h({type:"path",kind:"pair",id:void 0},void 0,void 0,{children:e})}(0,[t[0][0],t[3]])}},{name:"Kind",symbols:[{literal:","},"_"],postprocess:function(){return"pair"}},{name:"Kind",symbols:[{literal:"--\x3e"},"_"],postprocess:function(){return"right"}},{name:"Kind",symbols:[{literal:"--"},"_"],postprocess:function(){return"either"}},{name:"Kind",symbols:[{literal:"<--"},"_"],postprocess:function(){return"left"}},{name:"Attributes$ebnf$1",symbols:["Identity"],postprocess:Pt},{name:"Attributes$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"Attributes$ebnf$2",symbols:["LabelList"],postprocess:Pt},{name:"Attributes$ebnf$2",symbols:[],postprocess:function(){return null}},{name:"Attributes$ebnf$3",symbols:["Record"],postprocess:Pt},{name:"Attributes$ebnf$3",symbols:[],postprocess:function(){return null}},{name:"Attributes",symbols:["Attributes$ebnf$1","Attributes$ebnf$2","Attributes$ebnf$3"],postprocess:function(t,e,n){var r=t[0],i=t[1],o=t[2];return r||i||o?{id:r,labels:i,record:o}:n}},{name:"LabelList$ebnf$1",symbols:["Label"]},{name:"LabelList$ebnf$1",symbols:["LabelList$ebnf$1","Label"],postprocess:function(t){return t[0].concat([t[1]])}},{name:"LabelList",symbols:["LabelList$ebnf$1"],postprocess:function(t){return t[0]}},{name:"Label",symbols:[{literal:":"},"Symbol"],postprocess:function(t){return t[1]}},{name:"Identity",symbols:[Mt.has("identifier")?{type:"identifier"}:identifier,"_"],postprocess:Tt},{name:"Identity",symbols:[{literal:"ø"},"_"],postprocess:Tt},{name:"Identity",symbols:[Mt.has("symbol")?{type:"symbol"}:symbol,"_"],postprocess:Tt},{name:"Identity",symbols:[Mt.has("integer")?{type:"integer"}:integer,"_"],postprocess:Tt},{name:"Identity",symbols:[Mt.has("octal")?{type:"octal"}:octal,"_"],postprocess:Tt},{name:"Identity",symbols:[Mt.has("hexadecimal")?{type:"hexadecimal"}:hexadecimal,"_"],postprocess:Tt},{name:"Identity",symbols:[Mt.has("measurement")?{type:"measurement"}:measurement,"_"],postprocess:Tt},{name:"Identity",symbols:[Mt.has("tickedString")?{type:"tickedString"}:tickedString,"_"],postprocess:function(t){return t[0].text.slice(1,-1)}},{name:"Symbol",symbols:[Mt.has("symbol")?{type:"symbol"}:symbol,"_"],postprocess:Tt},{name:"Symbol",symbols:[Mt.has("tickedString")?{type:"tickedString"}:tickedString,"_"],postprocess:function(t){return t[0].text.slice(1,-1)}},{name:"Record",symbols:[{literal:"{"},"_",{literal:"}"},"_"],postprocess:Ot},{name:"Record$ebnf$1",symbols:[]},{name:"Record$ebnf$1$subexpression$1",symbols:[{literal:","},"_","Property"],postprocess:function(t){return t[2]}},{name:"Record$ebnf$1",symbols:["Record$ebnf$1","Record$ebnf$1$subexpression$1"],postprocess:function(t){return t[0].concat([t[1]])}},{name:"Record",symbols:[{literal:"{"},"_","Property","Record$ebnf$1",{literal:"}"},"_"],postprocess:function(t){return[t[2]].concat(t[3]).reduce((function(t,e){return t.set(e.name,e.value),t}),v())}},{name:"Property",symbols:["Symbol",{literal:":"},"_","Value"],postprocess:function(t){var e;return{type:"property",name:t[0],value:f(e=t[3])?e:w(e)}}},{name:"Value",symbols:["StringLiteral","_"],postprocess:Pt},{name:"Value",symbols:["NumericLiteral","_"],postprocess:Pt},{name:"Value",symbols:[Mt.has("boolean")?{type:"boolean"}:boolean,"_"],postprocess:function(t){return _(JSON.parse(t[0].value.toLowerCase()))}},{name:"Value$ebnf$1",symbols:[]},{name:"Value$ebnf$1$subexpression$1",symbols:[{literal:","},"_","Value"],postprocess:function(t){return t[2]}},{name:"Value$ebnf$1",symbols:["Value$ebnf$1","Value$ebnf$1$subexpression$1"],postprocess:function(t){return t[0].concat([t[1]])}},{name:"Value",symbols:[{literal:"["},"_","Value","Value$ebnf$1",{literal:"]"},"_"],postprocess:function(t){return[t[2]].concat(t[3])}},{name:"StringLiteral",symbols:[Mt.has("singleQuotedString")?{type:"singleQuotedString"}:singleQuotedString],postprocess:function(t){return x(t[0].value)}},{name:"StringLiteral",symbols:[Mt.has("doubleQuotedString")?{type:"doubleQuotedString"}:doubleQuotedString],postprocess:function(t){return x(t[0].value)}},{name:"StringLiteral",symbols:[Mt.has("tickedString")?{type:"tickedString"}:tickedString],postprocess:function(t){return x(t[0].value)}},{name:"StringLiteral",symbols:[Mt.has("taggedString")?{type:"taggedString"}:taggedString],postprocess:function(t){var e=function(t){var e=t.match(/([^`]+)`(.+)`$/);if(null==e)throw Error("Malformed tagged string: "+t);return{tag:e[1],value:e[2]}}(t[0].value);return k(e.tag,e.value)}},{name:"NumericLiteral",symbols:[Mt.has("integer")?{type:"integer"}:integer],postprocess:function(t){return{type:"integer",value:String(t[0].value)}}},{name:"NumericLiteral",symbols:[Mt.has("decimal")?{type:"decimal"}:decimal],postprocess:function(t){return E(t[0].value)}},{name:"NumericLiteral",symbols:[Mt.has("hexadecimal")?{type:"hexadecimal"}:hexadecimal],postprocess:function(t){return{type:"hexadecimal",value:"number"==typeof(e=t[0].value)?e.toString(16):e};var e}},{name:"NumericLiteral",symbols:[Mt.has("octal")?{type:"octal"}:octal],postprocess:function(t){return{type:"octal",value:"number"==typeof(e=t[0].value)?e.toString(8):e};var e}},{name:"NumericLiteral",symbols:[Mt.has("measurement")?{type:"measurement"}:measurement],postprocess:function(t){var e,n=function(t){var e=t.match(/(-?[0-9.]+)([a-zA-Z]+)/);if(null==e)throw Error("Malformed measurement : "+t);return{value:e[1],unit:e[2]}}(t[0].value);return e=n.unit,{type:"measurement",value:String(n.value),unit:e}}},{name:"_$ebnf$1",symbols:[Mt.has("whitespace")?{type:"whitespace"}:whitespace],postprocess:Pt},{name:"_$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"_",symbols:["_$ebnf$1"],postprocess:Ot},{name:"Comment",symbols:[Mt.has("lineComment")?{type:"lineComment"}:lineComment],postprocess:Ot},{name:"EOL",symbols:[{literal:"\n"}],postprocess:Ot}],ParserStart:"GramSeq"},Ct=function(t,e){var n,r,i=new $t.Parser($t.Grammar.fromCompiled(jt));try{var o=i.feed(t);if(void 0===o.results[0]&&o.lexerState){var s={line:(r=o.lexerState).line,column:r.col};e.fail("Incomplete parse.",s)}return o.results.length>1&&e.info("[WARN] parsing is ambiguous"),o.results[0]||{type:"error"}}catch(t){var a=t.token?{line:(n=t.token).line,column:n.col}:{line:0,column:0};e.fail(t.message,a)}},It=function(){this.Parser=Ct};let qt=t=>crypto.getRandomValues(new Uint8Array(t));function Lt(){return!0}var Rt=Dt;function Dt(t,e,n,r){var i,o;"function"==typeof e&&"function"!=typeof n&&(r=n,n=e,e=null),o=function t(e){if(null==e)return Lt;if("string"==typeof e)return function(t){return function(e){return Boolean(e&&e.type===t)}}(e);if("object"==typeof e)return"length"in e?function(e){for(var n=[],r=-1;++r<e.length;)n[r]=t(e[r]);return function(){for(var t=-1;++t<n.length;)if(n[t].apply(this,arguments))return!0;return!1}}(e):function(t){return function(e){var n;for(n in t)if(e[n]!==t[n])return!1;return!0}}(e);if("function"==typeof e)return e;throw new Error("Expected function, string, or object as test")}(e),i=r?-1:1,function t(s,a,u){var l,c="object"==typeof s&&null!==s?s:{};return"string"==typeof c.type&&(f.displayName="node ("+c.type+((l="string"==typeof c.tagName?c.tagName:"string"==typeof c.name?c.name:void 0)?"<"+l+">":"")+")"),f;function f(){var l,c,f=u.concat(s),h=[];if((!e||o(s,a,u[u.length-1]||null))&&!1===(h=function(t){return null!==t&&"object"==typeof t&&"length"in t?t:"number"==typeof t?[!0,t]:[t]}(n(s,u)))[0])return h;if(s.children&&"skip"!==h[0])for(c=(r?s.children.length:-1)+i;c>-1&&c<s.children.length;){if(!1===(l=t(s.children[c],c,f)())[0])return l;c="number"==typeof l[1]?l[1]:c+i}return h}}(t,null,[])()}Dt.CONTINUE=!0,Dt.SKIP="skip",Dt.EXIT=!1;var zt=Gt,Bt=Rt.SKIP,Vt=Rt.EXIT;function Gt(t,e,n,r){"function"==typeof e&&"function"!=typeof n&&(r=n,n=e,e=null),Rt(t,e,(function(t,e){var r=e[e.length-1],i=r?r.children.indexOf(t):null;return n(t,i,r)}),r)}function Ut(){return(Ut=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}Gt.CONTINUE=Rt.CONTINUE,Gt.SKIP=Bt,Gt.EXIT=Vt;var Ft={generator:"counter",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ",prefix:void 0};function Xt(){return(Xt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function Ht(t){return(Ht=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qt(t,e){return(Qt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Zt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Jt(t,e,n){return(Jt=Zt()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&Qt(i,n.prototype),i}).apply(null,arguments)}function Kt(t){var e="function"==typeof Map?new Map:void 0;return(Kt=function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return Jt(t,arguments,Ht(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Qt(n,t)})(t)}var Yt=/^([+-]\d{4,}\b|\d{4})$/,Wt=/^([0-9]{4})-(1[0-2]|0[1-9])$/,te=/^([0-9]{4})(-?)(1[0-2]|0[1-9])\2(3[01]|0[1-9]|[12][0-9])$/,ee=/^(2[0-3]|[01][0-9]):?([0-5][0-9]):?([0-5][0-9](\.[0-9]{3})?)?(Z|([+-])((?:2[0-3]|[01][0-9]))(?::?([0-5][0-9]))?)?$/,ne=function(t){var e,n;function r(e){var n;return(n=t.call(this,"AST is invalid:"+JSON.stringify(e))||this).name="InvalidAstError",n.ast=e,n}return n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n,r}(Kt(Error)),re=function t(e,n){return void 0===n&&(n=ie),"object"==typeof(r=e)&&r instanceof Map?Array.from(e).reduce((function(e,n){return e[n[0]]=t(n[1]),e}),{}):function(t){return Array.isArray(t)&&f(t[0])}(e)?e.map((function(e){return t(e)})):f(e)?n(e):"object"==typeof e?Object.entries(e).reduce((function(e,n){return e[n[0]]=t(n[1]),e}),{}):void 0;var r},ie=function(t){switch(t.type){case"boolean":return oe(t);case"string":return se(t);case"integer":return le(t);case"decimal":return ce(t);case"hexadecimal":return fe(t);case"octal":return he(t);case"tagged":switch(t.tag){case"date":return ae(t);case"time":return ue(t);case"datetime":case"interval":case"duration":return"TODO";case"uri":return t.value;case"wkt":default:return"TODO"}case"measurement":return"measure by measure";default:return function(t){throw new Error("Unexpected object: "+t)}(t)}},oe=function(t){return t.value&&"true"===t.value.toLowerCase()},se=function(t){if(t.value)return t.value;throw new ne(t)},ae=function(t){if(t.value){var e=te.exec(t.value);if(e)return new Date(Date.UTC(Number.parseInt(e[1]),Number.parseInt(e[3])-1,Number.parseInt(e[4])));if(e=Wt.exec(t.value))return new Date(Date.UTC(Number.parseInt(e[1]),Number.parseInt(e[2])));if(e=Yt.exec(t.value))return new Date(Number.parseInt(e[1]),1);throw SyntaxError("Unable to parse date from "+t.value)}throw new ne(t)},ue=function(t){if(t.value){var e=ee.exec(t.value);if(e){var n=Number.parseInt(e[1]),r=e[1]?Number.parseInt(e[2]):0,i=e[3]?Number.parseFloat(e[3]):0,o=e[5],s=36e5*n+6e4*r+1e3*i;if(o){var a="Z"===o?0:36e5*Number.parseInt(e[7])+6e4*Number.parseInt(e[8]||"0");return new Date("-"===e[6]?s+a:s-a)}return new Date(s)}throw SyntaxError("Unable to parse time from "+t.value)}throw new ne(t)},le=function(t){if(t.value)return Number.parseInt(t.value);throw new ne(t)},ce=function(t){if(t.value)return Number.parseFloat(t.value);throw new ne(t)},fe=function(t){if(t.value)return Number.parseInt(t.value,16);throw new ne(t)},he=function(t){if(t.value)return Number.parseInt(t.value,8);throw new ne(t)},pe={literalValueEvaluator:ie},de={__proto__:null,plugins:[function(t){var e=Ut({},Ft,t);return function(t){var n,r,i;switch(e.generator){case"nanoid":n=function(t,e,n){void 0===t&&(t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_@"),void 0===e&&(e=21);var r=((t,e)=>((t,e,n)=>{let r=(2<<Math.log(t.length-1)/Math.LN2)-1,i=-~(1.6*r*e/t.length);return()=>{let o="";for(;;){let s=n(i),a=i;for(;a--;)if(o+=t[s[a]&r]||"",o.length===e)return o}}})(t,e,qt))(t,e);return{generate:function(){return n?n+r():r()}}}(e.alphabet,21,e.prefix);break;case"counter":default:r=e.prefix,i=0,n={generate:function(){return""+(r||"")+i++}}}zt(t,(function(t){u(t)&&(t.id=t.id||n.generate())}))}},function(t){var e=Xt({},pe,t);return function(t){zt(t,(function(t){u(t)&&t.record&&(t.data=Object.assign(t.data||{},{value:re(t.record,e.literalValueEvaluator)}))}))}}]};const ye=yt().use(It).use(de),me=t=>{const e=ye.runSync(ye.parse(t));return{nodes:N(e).map(ve),links:P(e).map(be),paths:[]}},ge=t=>t.data&&t.data.value?t.data.value:t.record?t.record:{},ve=t=>c(t)?n(t.id,t.labels,ge(t)):n("random"),be=t=>i((t=>"left"===t.kind?t.children[1].id||e:t.children[0].id||e)(t),(t=>"left"===t.kind?t.children[0].id||e:t.children[1].id||e)(t),t.id,t.labels,ge(t));var we={value:()=>{}};function _e(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new xe(r)}function xe(t){this._=t}function ke(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function Ee(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function Se(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=we,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}xe.prototype=_e.prototype={constructor:xe,on:function(t,e){var n,r=this._,i=ke(t+"",r),o=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<s;)if(n=(t=i[o]).type)r[n]=Se(r[n],t.name,e);else if(null==e)for(n in r)r[n]=Se(r[n],t.name,null);return this}for(;++o<s;)if((n=(t=i[o]).type)&&(n=Ee(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new xe(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var Ae="http://www.w3.org/1999/xhtml",$e={svg:"http://www.w3.org/2000/svg",xhtml:Ae,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Ne(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),$e.hasOwnProperty(e)?{space:$e[e],local:t}:t}function Pe(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Ae&&e.documentElement.namespaceURI===Ae?e.createElement(t):e.createElementNS(n,t)}}function Me(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Oe(t){var e=Ne(t);return(e.local?Me:Pe)(e)}function Te(){}function je(t){return null==t?Te:function(){return this.querySelector(t)}}function Ce(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Ie(){return[]}function qe(t){return null==t?Ie:function(){return this.querySelectorAll(t)}}function Le(t){return function(){return this.matches(t)}}function Re(t){return function(e){return e.matches(t)}}var De=Array.prototype.find;function ze(){return this.firstElementChild}var Be=Array.prototype.filter;function Ve(){return this.children}function Ge(t){return new Array(t.length)}function Ue(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Fe(t){return function(){return t}}function Xe(t,e,n,r,i,o){for(var s,a=0,u=e.length,l=o.length;a<l;++a)(s=e[a])?(s.__data__=o[a],r[a]=s):n[a]=new Ue(t,o[a]);for(;a<u;++a)(s=e[a])&&(i[a]=s)}function He(t,e,n,r,i,o,s){var a,u,l,c=new Map,f=e.length,h=o.length,p=new Array(f);for(a=0;a<f;++a)(u=e[a])&&(p[a]=l=s.call(u,u.__data__,a,e)+"",c.has(l)?i[a]=u:c.set(l,u));for(a=0;a<h;++a)l=s.call(t,o[a],a,o)+"",(u=c.get(l))?(r[a]=u,u.__data__=o[a],c.delete(l)):n[a]=new Ue(t,o[a]);for(a=0;a<f;++a)(u=e[a])&&c.get(p[a])===u&&(i[a]=u)}function Qe(t){return t.__data__}function Ze(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Je(t){return function(){this.removeAttribute(t)}}function Ke(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ye(t,e){return function(){this.setAttribute(t,e)}}function We(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function tn(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function en(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function nn(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function rn(t){return function(){this.style.removeProperty(t)}}function on(t,e,n){return function(){this.style.setProperty(t,e,n)}}function sn(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function an(t,e){return t.style.getPropertyValue(e)||nn(t).getComputedStyle(t,null).getPropertyValue(e)}function un(t){return function(){delete this[t]}}function ln(t,e){return function(){this[t]=e}}function cn(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function fn(t){return t.trim().split(/^|\s+/)}function hn(t){return t.classList||new pn(t)}function pn(t){this._node=t,this._names=fn(t.getAttribute("class")||"")}function dn(t,e){for(var n=hn(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function yn(t,e){for(var n=hn(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function mn(t){return function(){dn(this,t)}}function gn(t){return function(){yn(this,t)}}function vn(t,e){return function(){(e.apply(this,arguments)?dn:yn)(this,t)}}function bn(){this.textContent=""}function wn(t){return function(){this.textContent=t}}function _n(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function xn(){this.innerHTML=""}function kn(t){return function(){this.innerHTML=t}}function En(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Sn(){this.nextSibling&&this.parentNode.appendChild(this)}function An(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function $n(){return null}function Nn(){var t=this.parentNode;t&&t.removeChild(this)}function Pn(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Mn(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function On(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function Tn(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?e.length=i:delete this.__on}}}function jn(t,e,n){return function(){var r,i=this.__on,o=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(i)for(var s=0,a=i.length;s<a;++s)if((r=i[s]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),void(r.value=e);this.addEventListener(t.type,o,n),r={type:t.type,name:t.name,value:e,listener:o,options:n},i?i.push(r):this.__on=[r]}}function Cn(t,e,n){var r=nn(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function In(t,e){return function(){return Cn(this,t,e)}}function qn(t,e){return function(){return Cn(this,t,e.apply(this,arguments))}}Ue.prototype={constructor:Ue,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},pn.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Ln=[null];function Rn(t,e){this._groups=t,this._parents=e}function Dn(){return new Rn([[document.documentElement]],Ln)}function zn(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Bn(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Vn(){}Rn.prototype=Dn.prototype={constructor:Rn,select:function(t){"function"!=typeof t&&(t=je(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,s,a=e[i],u=a.length,l=r[i]=new Array(u),c=0;c<u;++c)(o=a[c])&&(s=t.call(o,o.__data__,c,a))&&("__data__"in o&&(s.__data__=o.__data__),l[c]=s);return new Rn(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);return null==e?[]:Ce(e)}}(t):qe(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var s,a=e[o],u=a.length,l=0;l<u;++l)(s=a[l])&&(r.push(t.call(s,s.__data__,l,a)),i.push(s));return new Rn(r,i)},selectChild:function(t){return this.select(null==t?ze:function(t){return function(){return De.call(this.children,t)}}("function"==typeof t?t:Re(t)))},selectChildren:function(t){return this.selectAll(null==t?Ve:function(t){return function(){return Be.call(this.children,t)}}("function"==typeof t?t:Re(t)))},filter:function(t){"function"!=typeof t&&(t=Le(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,s=e[i],a=s.length,u=r[i]=[],l=0;l<a;++l)(o=s[l])&&t.call(o,o.__data__,l,s)&&u.push(o);return new Rn(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,Qe);var n=e?He:Xe,r=this._parents,i=this._groups;"function"!=typeof t&&(t=Fe(t));for(var o=i.length,s=new Array(o),a=new Array(o),u=new Array(o),l=0;l<o;++l){var c=r[l],f=i[l],h=f.length,p=Ce(t.call(c,c&&c.__data__,l,r)),d=p.length,y=a[l]=new Array(d),m=s[l]=new Array(d),g=u[l]=new Array(h);n(c,f,y,m,g,p,e);for(var v,b,w=0,_=0;w<d;++w)if(v=y[w]){for(w>=_&&(_=w+1);!(b=m[_])&&++_<d;);v._next=b||null}}return(s=new Rn(s,r))._enter=a,s._exit=u,s},enter:function(){return new Rn(this._enter||this._groups.map(Ge),this._parents)},exit:function(){return new Rn(this._exit||this._groups.map(Ge),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,o=this.exit();return r="function"==typeof t?t(r):r.append(t+""),null!=e&&(i=e(i)),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(t){if(!(t instanceof Rn))throw new Error("invalid merge");for(var e=this._groups,n=t._groups,r=e.length,i=Math.min(r,n.length),o=new Array(r),s=0;s<i;++s)for(var a,u=e[s],l=n[s],c=u.length,f=o[s]=new Array(c),h=0;h<c;++h)(a=u[h]||l[h])&&(f[h]=a);for(;s<r;++s)o[s]=e[s];return new Rn(o,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,s=i[o];--o>=0;)(r=i[o])&&(s&&4^r.compareDocumentPosition(s)&&s.parentNode.insertBefore(r,s),s=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=Ze);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var s,a=n[o],u=a.length,l=i[o]=new Array(u),c=0;c<u;++c)(s=a[c])&&(l[c]=s);l.sort(e)}return new Rn(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var s=r[i];if(s)return s}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],s=0,a=o.length;s<a;++s)(i=o[s])&&t.call(i,i.__data__,s,o);return this},attr:function(t,e){var n=Ne(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?Ke:Je:"function"==typeof e?n.local?en:tn:n.local?We:Ye)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?rn:"function"==typeof e?sn:on)(t,e,null==n?"":n)):an(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?un:"function"==typeof e?cn:ln)(t,e)):this.node()[t]},classed:function(t,e){var n=fn(t+"");if(arguments.length<2){for(var r=hn(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?vn:e?mn:gn)(n,e))},text:function(t){return arguments.length?this.each(null==t?bn:("function"==typeof t?_n:wn)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?xn:("function"==typeof t?En:kn)(t)):this.node().innerHTML},raise:function(){return this.each(Sn)},lower:function(){return this.each(An)},append:function(t){var e="function"==typeof t?t:Oe(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:Oe(t),r=null==e?$n:"function"==typeof e?e:je(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(Nn)},clone:function(t){return this.select(t?Mn:Pn)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=On(t+""),s=o.length;if(!(arguments.length<2)){for(a=e?jn:Tn,r=0;r<s;++r)this.each(a(o[r],e,n));return this}var a=this.node().__on;if(a)for(var u,l=0,c=a.length;l<c;++l)for(r=0,u=a[l];r<s;++r)if((i=o[r]).type===u.type&&i.name===u.name)return u.value},dispatch:function(t,e){return this.each(("function"==typeof e?qn:In)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,i=t[e],o=0,s=i.length;o<s;++o)(r=i[o])&&(yield r)}};var Gn="\\s*([+-]?\\d+)\\s*",Un="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Fn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Xn=/^#([0-9a-f]{3,8})$/,Hn=new RegExp("^rgb\\("+[Gn,Gn,Gn]+"\\)$"),Qn=new RegExp("^rgb\\("+[Fn,Fn,Fn]+"\\)$"),Zn=new RegExp("^rgba\\("+[Gn,Gn,Gn,Un]+"\\)$"),Jn=new RegExp("^rgba\\("+[Fn,Fn,Fn,Un]+"\\)$"),Kn=new RegExp("^hsl\\("+[Un,Fn,Fn]+"\\)$"),Yn=new RegExp("^hsla\\("+[Un,Fn,Fn,Un]+"\\)$"),Wn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function tr(){return this.rgb().formatHex()}function er(){return this.rgb().formatRgb()}function nr(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Xn.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?rr(e):3===n?new ar(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?ir(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?ir(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Hn.exec(t))?new ar(e[1],e[2],e[3],1):(e=Qn.exec(t))?new ar(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Zn.exec(t))?ir(e[1],e[2],e[3],e[4]):(e=Jn.exec(t))?ir(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Kn.exec(t))?fr(e[1],e[2]/100,e[3]/100,1):(e=Yn.exec(t))?fr(e[1],e[2]/100,e[3]/100,e[4]):Wn.hasOwnProperty(t)?rr(Wn[t]):"transparent"===t?new ar(NaN,NaN,NaN,0):null}function rr(t){return new ar(t>>16&255,t>>8&255,255&t,1)}function ir(t,e,n,r){return r<=0&&(t=e=n=NaN),new ar(t,e,n,r)}function or(t){return t instanceof Vn||(t=nr(t)),t?new ar((t=t.rgb()).r,t.g,t.b,t.opacity):new ar}function sr(t,e,n,r){return 1===arguments.length?or(t):new ar(t,e,n,null==r?1:r)}function ar(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function ur(){return"#"+cr(this.r)+cr(this.g)+cr(this.b)}function lr(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function cr(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function fr(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new pr(t,e,n,r)}function hr(t){if(t instanceof pr)return new pr(t.h,t.s,t.l,t.opacity);if(t instanceof Vn||(t=nr(t)),!t)return new pr;if(t instanceof pr)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),s=NaN,a=o-i,u=(o+i)/2;return a?(s=e===o?(n-r)/a+6*(n<r):n===o?(r-e)/a+2:(e-n)/a+4,a/=u<.5?o+i:2-o-i,s*=60):a=u>0&&u<1?0:s,new pr(s,a,u,t.opacity)}function pr(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function dr(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}zn(Vn,nr,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:tr,formatHex:tr,formatHsl:function(){return hr(this).formatHsl()},formatRgb:er,toString:er}),zn(ar,sr,Bn(Vn,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new ar(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new ar(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ur,formatHex:ur,formatRgb:lr,toString:lr})),zn(pr,(function(t,e,n,r){return 1===arguments.length?hr(t):new pr(t,e,n,null==r?1:r)}),Bn(Vn,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new pr(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new pr(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new ar(dr(t>=240?t-240:t+120,i,r),dr(t,i,r),dr(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var yr=t=>()=>t;function mr(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):yr(isNaN(t)?e:t)}var gr=function t(e){var n=function(t){return 1==(t=+t)?mr:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):yr(isNaN(e)?n:e)}}(e);function r(t,e){var r=n((t=sr(t)).r,(e=sr(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),s=mr(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=s(e),t+""}}return r.gamma=t,r}(1);function vr(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var br=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,wr=new RegExp(br.source,"g");function _r(t,e){var n,r,i,o=br.lastIndex=wr.lastIndex=0,s=-1,a=[],u=[];for(t+="",e+="";(n=br.exec(t))&&(r=wr.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),a[s]?a[s]+=i:a[++s]=i),(n=n[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,u.push({i:s,x:vr(n,r)})),o=wr.lastIndex;return o<e.length&&(i=e.slice(o),a[s]?a[s]+=i:a[++s]=i),a.length<2?u[0]?function(t){return function(e){return t(e)+""}}(u[0].x):function(t){return function(){return t}}(e):(e=u.length,function(t){for(var n,r=0;r<e;++r)a[(n=u[r]).i]=n.x(t);return a.join("")})}var xr,kr=180/Math.PI,Er={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Sr(t,e,n,r,i,o){var s,a,u;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,u/=a),t*r<e*n&&(t=-t,e=-e,u=-u,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*kr,skewX:Math.atan(u)*kr,scaleX:s,scaleY:a}}function Ar(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,s){var a=[],u=[];return o=t(o),s=t(s),function(t,r,i,o,s,a){if(t!==i||r!==o){var u=s.push("translate(",null,e,null,n);a.push({i:u-4,x:vr(t,i)},{i:u-2,x:vr(r,o)})}else(i||o)&&s.push("translate("+i+e+o+n)}(o.translateX,o.translateY,s.translateX,s.translateY,a,u),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:vr(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,s.rotate,a,u),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:vr(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,s.skewX,a,u),function(t,e,n,r,o,s){if(t!==n||e!==r){var a=o.push(i(o)+"scale(",null,",",null,")");s.push({i:a-4,x:vr(t,n)},{i:a-2,x:vr(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,u),o=s=null,function(t){for(var e,n=-1,r=u.length;++n<r;)a[(e=u[n]).i]=e.x(t);return a.join("")}}}var $r,Nr,Pr=Ar((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Er:Sr(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),Mr=Ar((function(t){return null==t?Er:(xr||(xr=document.createElementNS("http://www.w3.org/2000/svg","g")),xr.setAttribute("transform",t),(t=xr.transform.baseVal.consolidate())?Sr((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Er)}),", ",")",")"),Or=0,Tr=0,jr=0,Cr=0,Ir=0,qr=0,Lr="object"==typeof performance&&performance.now?performance:Date,Rr="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Dr(){return Ir||(Rr(zr),Ir=Lr.now()+qr)}function zr(){Ir=0}function Br(){this._call=this._time=this._next=null}function Vr(t,e,n){var r=new Br;return r.restart(t,e,n),r}function Gr(){Ir=(Cr=Lr.now())+qr,Or=Tr=0;try{!function(){Dr(),++Or;for(var t,e=$r;e;)(t=Ir-e._time)>=0&&e._call.call(null,t),e=e._next;--Or}()}finally{Or=0,function(){for(var t,e,n=$r,r=Infinity;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:$r=e);Nr=t,Fr(r)}(),Ir=0}}function Ur(){var t=Lr.now(),e=t-Cr;e>1e3&&(qr-=e,Cr=t)}function Fr(t){Or||(Tr&&(Tr=clearTimeout(Tr)),t-Ir>24?(t<Infinity&&(Tr=setTimeout(Gr,t-Lr.now()-qr)),jr&&(jr=clearInterval(jr))):(jr||(Cr=Lr.now(),jr=setInterval(Ur,1e3)),Or=1,Rr(Gr)))}function Xr(t,e,n){var r=new Br;return r.restart(n=>{r.stop(),t(n+e)},e=null==e?0:+e,n),r}Br.prototype=Vr.prototype={constructor:Br,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Dr():+n)+(null==e?0:+e),this._next||Nr===this||(Nr?Nr._next=this:$r=this,Nr=this),this._call=t,this._time=n,Fr()},stop:function(){this._call&&(this._call=null,this._time=Infinity,Fr())}};var Hr=_e("start","end","cancel","interrupt"),Qr=[];function Zr(t,e,n,r,i,o){var s=t.__transition;if(s){if(n in s)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function o(u){var l,c,f,h;if(1!==n.state)return a();for(l in i)if((h=i[l]).name===n.name){if(3===h.state)return Xr(o);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete i[l]):+l<e&&(h.state=6,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete i[l])}if(Xr((function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(u))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(f=n.tween.length),l=0,c=-1;l<f;++l)(h=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(r[++c]=h);r.length=c+1}}function s(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(a),n.state=5,1),o=-1,s=r.length;++o<s;)r[o].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=Vr((function(t){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}),0,n.time)}(t,n,{name:e,index:r,group:i,on:Hr,tween:Qr,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function Jr(t,e){var n=Yr(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function Kr(t,e){var n=Yr(t,e);if(n.state>3)throw new Error("too late; already running");return n}function Yr(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Wr(t,e){var n,r;return function(){var i=Kr(this,t),o=i.tween;if(o!==n)for(var s=0,a=(r=n=o).length;s<a;++s)if(r[s].name===e){(r=r.slice()).splice(s,1);break}i.tween=r}}function ti(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=Kr(this,t),s=o.tween;if(s!==r){i=(r=s).slice();for(var a={name:e,value:n},u=0,l=i.length;u<l;++u)if(i[u].name===e){i[u]=a;break}u===l&&i.push(a)}o.tween=i}}function ei(t,e,n){var r=t._id;return t.each((function(){var t=Kr(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return Yr(t,r).value[e]}}function ni(t,e){var n;return("number"==typeof e?vr:e instanceof nr?gr:(n=nr(e))?(e=n,gr):_r)(t,e)}function ri(t){return function(){this.removeAttribute(t)}}function ii(t){return function(){this.removeAttributeNS(t.space,t.local)}}function oi(t,e,n){var r,i,o=n+"";return function(){var s=this.getAttribute(t);return s===o?null:s===r?i:i=e(r=s,n)}}function si(t,e,n){var r,i,o=n+"";return function(){var s=this.getAttributeNS(t.space,t.local);return s===o?null:s===r?i:i=e(r=s,n)}}function ai(t,e,n){var r,i,o;return function(){var s,a,u=n(this);if(null!=u)return(s=this.getAttribute(t))===(a=u+"")?null:s===r&&a===i?o:(i=a,o=e(r=s,u));this.removeAttribute(t)}}function ui(t,e,n){var r,i,o;return function(){var s,a,u=n(this);if(null!=u)return(s=this.getAttributeNS(t.space,t.local))===(a=u+"")?null:s===r&&a===i?o:(i=a,o=e(r=s,u));this.removeAttributeNS(t.space,t.local)}}function li(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function ci(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function fi(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&ci(t,i)),n}return i._value=e,i}function hi(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&li(t,i)),n}return i._value=e,i}function pi(t,e){return function(){Jr(this,t).delay=+e.apply(this,arguments)}}function di(t,e){return e=+e,function(){Jr(this,t).delay=e}}function yi(t,e){return function(){Kr(this,t).duration=+e.apply(this,arguments)}}function mi(t,e){return e=+e,function(){Kr(this,t).duration=e}}function gi(t,e){if("function"!=typeof e)throw new Error;return function(){Kr(this,t).ease=e}}function vi(t,e,n){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?Jr:Kr;return function(){var s=o(this,t),a=s.on;a!==r&&(i=(r=a).copy()).on(e,n),s.on=i}}var bi=Dn.prototype.constructor;function wi(t){return function(){this.style.removeProperty(t)}}function _i(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function xi(t,e,n){var r,i;function o(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&_i(t,o,n)),r}return o._value=e,o}function ki(t){return function(e){this.textContent=t.call(this,e)}}function Ei(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&ki(r)),e}return r._value=t,r}var Si=0;function Ai(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function $i(){return++Si}var Ni=Dn.prototype;Ai.prototype=function(t){return Dn().transition(t)}.prototype={constructor:Ai,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=je(t));for(var r=this._groups,i=r.length,o=new Array(i),s=0;s<i;++s)for(var a,u,l=r[s],c=l.length,f=o[s]=new Array(c),h=0;h<c;++h)(a=l[h])&&(u=t.call(a,a.__data__,h,l))&&("__data__"in a&&(u.__data__=a.__data__),f[h]=u,Zr(f[h],e,n,h,f,Yr(a,n)));return new Ai(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=qe(t));for(var r=this._groups,i=r.length,o=[],s=[],a=0;a<i;++a)for(var u,l=r[a],c=l.length,f=0;f<c;++f)if(u=l[f]){for(var h,p=t.call(u,u.__data__,f,l),d=Yr(u,n),y=0,m=p.length;y<m;++y)(h=p[y])&&Zr(h,e,n,y,p,d);o.push(p),s.push(u)}return new Ai(o,s,e,n)},filter:function(t){"function"!=typeof t&&(t=Le(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,s=e[i],a=s.length,u=r[i]=[],l=0;l<a;++l)(o=s[l])&&t.call(o,o.__data__,l,s)&&u.push(o);return new Ai(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=Math.min(r,n.length),o=new Array(r),s=0;s<i;++s)for(var a,u=e[s],l=n[s],c=u.length,f=o[s]=new Array(c),h=0;h<c;++h)(a=u[h]||l[h])&&(f[h]=a);for(;s<r;++s)o[s]=e[s];return new Ai(o,this._parents,this._name,this._id)},selection:function(){return new bi(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=$i(),r=this._groups,i=r.length,o=0;o<i;++o)for(var s,a=r[o],u=a.length,l=0;l<u;++l)if(s=a[l]){var c=Yr(s,e);Zr(s,t,n,l,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Ai(r,this._parents,t,n)},call:Ni.call,nodes:Ni.nodes,node:Ni.node,size:Ni.size,empty:Ni.empty,each:Ni.each,on:function(t,e){var n=this._id;return arguments.length<2?Yr(this.node(),n).on.on(t):this.each(vi(n,t,e))},attr:function(t,e){var n=Ne(t),r="transform"===n?Mr:ni;return this.attrTween(t,"function"==typeof e?(n.local?ui:ai)(n,r,ei(this,"attr."+t,e)):null==e?(n.local?ii:ri)(n):(n.local?si:oi)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=Ne(t);return this.tween(n,(r.local?fi:hi)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?Pr:ni;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var o=an(this,t),s=(this.style.removeProperty(t),an(this,t));return o===s?null:o===n&&s===r?i:i=e(n=o,r=s)}}(t,r)).on("end.style."+t,wi(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,o;return function(){var s=an(this,t),a=n(this),u=a+"";return null==a&&(this.style.removeProperty(t),u=a=an(this,t)),s===u?null:s===r&&u===i?o:(i=u,o=e(r=s,a))}}(t,r,ei(this,"style."+t,e))).each(function(t,e){var n,r,i,o,s="style."+e,a="end."+s;return function(){var u=Kr(this,t),l=u.on,c=null==u.value[s]?o||(o=wi(e)):void 0;l===n&&i===c||(r=(n=l).copy()).on(a,i=c),u.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,o=n+"";return function(){var s=an(this,t);return s===o?null:s===r?i:i=e(r=s,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,xi(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(ei(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,Ei(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=Yr(this.node(),n).tween,o=0,s=i.length;o<s;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?Wr:ti)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?pi:di)(e,t)):Yr(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?yi:mi)(e,t)):Yr(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(gi(e,t)):Yr(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;Kr(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(o,s){var a={value:s},u={value:function(){0==--i&&o()}};n.each((function(){var n=Kr(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(u)),n.on=e})),0===i&&o()}))},[Symbol.iterator]:Ni[Symbol.iterator]};var Pi={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Mi(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}Dn.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,r,i,o=t.__transition,s=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[i]):s=!1;s&&delete t.__transition}}(this,t)}))},Dn.prototype.transition=function(t){var e,n;t instanceof Ai?(e=t._id,t=t._name):(e=$i(),(n=Pi).time=Dr(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var s,a=r[o],u=a.length,l=0;l<u;++l)(s=a[l])&&Zr(s,t,e,l,a,n||Mi(s,e));return new Ai(r,this._parents,t,e)};const Oi=Math.PI,Ti=2*Oi,ji=Ti-1e-6;function Ci(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Ii(){return new Ci}function qi(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o,s,a,u,l,c,f,h,p=t._root,d={data:r},y=t._x0,m=t._y0,g=t._x1,v=t._y1;if(!p)return t._root=d,t;for(;p.length;)if((l=e>=(o=(y+g)/2))?y=o:g=o,(c=n>=(s=(m+v)/2))?m=s:v=s,i=p,!(p=p[f=c<<1|l]))return i[f]=d,t;if(a=+t._x.call(null,p.data),u=+t._y.call(null,p.data),e===a&&n===u)return d.next=p,i?i[f]=d:t._root=d,t;do{i=i?i[f]=new Array(4):t._root=new Array(4),(l=e>=(o=(y+g)/2))?y=o:g=o,(c=n>=(s=(m+v)/2))?m=s:v=s}while((f=c<<1|l)==(h=(u>=s)<<1|a>=o));return i[h]=p,i[f]=d,t}function Li(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function Ri(t){return t[0]}function Di(t){return t[1]}function zi(t,e,n){var r=new Bi(null==e?Ri:e,null==n?Di:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function Bi(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function Vi(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}Ci.prototype=Ii.prototype={constructor:Ci,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,e,n,r,i){var o=this._x1,s=this._y1,a=(n=+n)-(t=+t),u=(r=+r)-(e=+e),l=o-t,c=s-e,f=l*l+c*c;if((i=+i)<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(f>1e-6)if(Math.abs(c*a-u*l)>1e-6&&i){var h=n-o,p=r-s,d=a*a+u*u,y=h*h+p*p,m=Math.sqrt(d),g=Math.sqrt(f),v=i*Math.tan((Oi-Math.acos((d+f-y)/(2*m*g)))/2),b=v/g,w=v/m;Math.abs(b-1)>1e-6&&(this._+="L"+(t+b*l)+","+(e+b*c)),this._+="A"+i+","+i+",0,0,"+ +(c*h>l*p)+","+(this._x1=t+w*a)+","+(this._y1=e+w*u)}else this._+="L"+(this._x1=t)+","+(this._y1=e)},arc:function(t,e,n,r,i,o){t=+t,e=+e,o=!!o;var s=(n=+n)*Math.cos(r),a=n*Math.sin(r),u=t+s,l=e+a,c=1^o,f=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+l:(Math.abs(this._x1-u)>1e-6||Math.abs(this._y1-l)>1e-6)&&(this._+="L"+u+","+l),n&&(f<0&&(f=f%Ti+Ti),f>ji?this._+="A"+n+","+n+",0,1,"+c+","+(t-s)+","+(e-a)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):f>1e-6&&(this._+="A"+n+","+n+",0,"+ +(f>=Oi)+","+c+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var Gi=zi.prototype=Bi.prototype;function Ui(t){return function(){return t}}function Fi(t){return 1e-6*(t()-.5)}function Xi(t){return t.x+t.vx}function Hi(t){return t.y+t.vy}function Qi(t){return t.index}function Zi(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}Gi.copy=function(){var t,e,n=new Bi(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=Vi(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=Vi(e));return n},Gi.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return qi(this.cover(e,n),e,n,t)},Gi.addAll=function(t){var e,n,r,i,o=t.length,s=new Array(o),a=new Array(o),u=Infinity,l=Infinity,c=-Infinity,f=-Infinity;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(s[n]=r,a[n]=i,r<u&&(u=r),r>c&&(c=r),i<l&&(l=i),i>f&&(f=i));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<o;++n)qi(this,s[n],a[n],t[n]);return this},Gi.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{for(var s,a,u=i-n||1,l=this._root;n>t||t>=i||r>e||e>=o;)switch(a=(e<r)<<1|t<n,(s=new Array(4))[a]=l,l=s,u*=2,a){case 0:i=n+u,o=r+u;break;case 1:n=i-u,o=r+u;break;case 2:i=n+u,r=o-u;break;case 3:n=i-u,r=o-u}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},Gi.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},Gi.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Gi.find=function(t,e,n){var r,i,o,s,a,u,l,c=this._x0,f=this._y0,h=this._x1,p=this._y1,d=[],y=this._root;for(y&&d.push(new Li(y,c,f,h,p)),null==n?n=Infinity:(c=t-n,f=e-n,h=t+n,p=e+n,n*=n);u=d.pop();)if(!(!(y=u.node)||(i=u.x0)>h||(o=u.y0)>p||(s=u.x1)<c||(a=u.y1)<f))if(y.length){var m=(i+s)/2,g=(o+a)/2;d.push(new Li(y[3],m,g,s,a),new Li(y[2],i,g,m,a),new Li(y[1],m,o,s,g),new Li(y[0],i,o,m,g)),(l=(e>=g)<<1|t>=m)&&(u=d[d.length-1],d[d.length-1]=d[d.length-1-l],d[d.length-1-l]=u)}else{var v=t-+this._x.call(null,y.data),b=e-+this._y.call(null,y.data),w=v*v+b*b;if(w<n){var _=Math.sqrt(n=w);c=t-_,f=e-_,h=t+_,p=e+_,r=y.data}}return r},Gi.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(s=+this._y.call(null,t)))return this;var e,n,r,i,o,s,a,u,l,c,f,h,p=this._root,d=this._x0,y=this._y0,m=this._x1,g=this._y1;if(!p)return this;if(p.length)for(;;){if((l=o>=(a=(d+m)/2))?d=a:m=a,(c=s>=(u=(y+g)/2))?y=u:g=u,e=p,!(p=p[f=c<<1|l]))return this;if(!p.length)break;(e[f+1&3]||e[f+2&3]||e[f+3&3])&&(n=e,h=f)}for(;p.data!==t;)if(r=p,!(p=p.next))return this;return(i=p.next)&&delete p.next,r?(i?r.next=i:delete r.next,this):e?(i?e[f]=i:delete e[f],(p=e[0]||e[1]||e[2]||e[3])&&p===(e[3]||e[2]||e[1]||e[0])&&!p.length&&(n?n[h]=p:this._root=p),this):(this._root=i,this)},Gi.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},Gi.root=function(){return this._root},Gi.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},Gi.visit=function(t){var e,n,r,i,o,s,a=[],u=this._root;for(u&&a.push(new Li(u,this._x0,this._y0,this._x1,this._y1));e=a.pop();)if(!t(u=e.node,r=e.x0,i=e.y0,o=e.x1,s=e.y1)&&u.length){var l=(r+o)/2,c=(i+s)/2;(n=u[3])&&a.push(new Li(n,l,c,o,s)),(n=u[2])&&a.push(new Li(n,r,c,l,s)),(n=u[1])&&a.push(new Li(n,l,i,o,c)),(n=u[0])&&a.push(new Li(n,r,i,l,c))}return this},Gi.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new Li(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var o,s=e.x0,a=e.y0,u=e.x1,l=e.y1,c=(s+u)/2,f=(a+l)/2;(o=i[0])&&n.push(new Li(o,s,a,c,f)),(o=i[1])&&n.push(new Li(o,c,a,u,f)),(o=i[2])&&n.push(new Li(o,s,f,c,l)),(o=i[3])&&n.push(new Li(o,c,f,u,l))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},Gi.x=function(t){return arguments.length?(this._x=t,this):this._x},Gi.y=function(t){return arguments.length?(this._y=t,this):this._y};const Ji=4294967296;function Ki(t){return t.x}function Yi(t){return t.y}var Wi=Math.PI*(3-Math.sqrt(5));function to(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}const eo=Symbol("implicit");function no(){var t=new Map,e=[],n=[],r=eo;function i(i){var o=i+"",s=t.get(o);if(!s){if(r!==eo)return r;t.set(o,s=e.push(i))}return n[(s-1)%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Map;for(const r of n){const n=r+"";t.has(n)||t.set(n,e.push(r))}return i},i.range=function(t){return arguments.length?(n=Array.from(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return no(e,n).unknown(r)},to.apply(i,arguments),i}var ro=function(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");function io(t){return function(){return t}}var oo=Math.PI,so=2*oo,ao={draw:function(t,e){var n=Math.sqrt(e/oo);t.moveTo(n,0),t.arc(0,0,n,0,so)}},uo={draw:function(t,e){var n=Math.sqrt(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},lo=Math.sqrt(1/3),co=2*lo,fo={draw:function(t,e){var n=Math.sqrt(e/co),r=n*lo;t.moveTo(0,-n),t.lineTo(r,0),t.lineTo(0,n),t.lineTo(-r,0),t.closePath()}},ho=Math.sin(oo/10)/Math.sin(7*oo/10),po=Math.sin(so/10)*ho,yo=-Math.cos(so/10)*ho,mo={draw:function(t,e){var n=Math.sqrt(.8908130915292852*e),r=po*n,i=yo*n;t.moveTo(0,-n),t.lineTo(r,i);for(var o=1;o<5;++o){var s=so*o/5,a=Math.cos(s),u=Math.sin(s);t.lineTo(u*n,-a*n),t.lineTo(a*r-u*i,u*r+a*i)}t.closePath()}},go={draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},vo=Math.sqrt(3),bo={draw:function(t,e){var n=-Math.sqrt(e/(3*vo));t.moveTo(0,2*n),t.lineTo(-vo*n,-n),t.lineTo(vo*n,-n),t.closePath()}},wo=-.5,_o=Math.sqrt(3)/2,xo=1/Math.sqrt(12),ko=3*(xo/2+1),Eo={draw:function(t,e){var n=Math.sqrt(e/ko),r=n/2,i=n*xo,o=r,s=n*xo+n,a=-o,u=s;t.moveTo(r,i),t.lineTo(o,s),t.lineTo(a,u),t.lineTo(wo*r-_o*i,_o*r+wo*i),t.lineTo(wo*o-_o*s,_o*o+wo*s),t.lineTo(wo*a-_o*u,_o*a+wo*u),t.lineTo(wo*r+_o*i,wo*i-_o*r),t.lineTo(wo*o+_o*s,wo*s-_o*o),t.lineTo(wo*a+_o*u,wo*u-_o*a),t.closePath()}};function So(t,e){var n=null;function r(){var r;if(n||(n=r=Ii()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),r)return n=null,r+""||null}return t="function"==typeof t?t:io(t||ao),e="function"==typeof e?e:io(void 0===e?64:+e),r.type=function(e){return arguments.length?(t="function"==typeof e?e:io(e),r):t},r.size=function(t){return arguments.length?(e="function"==typeof t?t:io(+t),r):e},r.context=function(t){return arguments.length?(n=null==t?null:t,r):n},r}const Ao={width:1200,height:800,ticks:300},$o=2*Math.PI*2,No=new Map([["Person","square"],["Triangle","triangle"],["Movie","star"],["Event","wye"]]),Po=new Map([["circle",So().type(ao).size($o)()],["square",So().type(go).size($o)()],["triangle",So().type(bo).size($o)()],["cross",So().type(uo).size($o)()],["diamond",So().type(fo).size($o)()],["star",So().type(mo).size($o)()],["wye",So().type(Eo).size($o)()]]),Mo=t=>{const e=void 0!==t.labels&&No.get(t.labels[0])||"circle";return Po.get(e)||""},Oo=no(ro);Oo.domain(["Default","Person","Movie","Event"]);const To=t=>Oo(void 0!==t.labels?t.labels[0]:"Default")||"gray",jo={};t.MISSING_ID=e,t.dataFromPath=ge,t.default=me,t.draw=(t,e,n={})=>{const r=Object.assign(jo,n);console.log(r);const i=function(t){return"string"==typeof t?new Rn([[document.querySelector(t)]],[document.documentElement]):new Rn([[t]],Ln)}(e);let o=i.append("g").attr("stroke","#999").attr("stroke-opacity",.6).selectAll("line").data(t.links).join("line").attr("stroke-width",2),s=i.append("g").attr("class","nodes").selectAll("g").data(t.nodes).enter().append("g");return s.append("path").attr("fill",To).attr("stroke",t=>(nr(To(t))||sr(51,51,51)).darker().hex()).attr("stroke-width",4).attr("d",Mo),s.append("title").text((function(t){return t.id})),{nodes:s,links:o}},t.edgeToD3=be,t.isGramNodeDatum=r,t.layout=(t,e={})=>{const n=Object.assign(Ao,e);let r=(i={x:n.width/2,y:n.height/2},function(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,s=.6,a=new Map,u=Vr(f),l=_e("tick","end"),c=function(){let t=1;return()=>(t=(1664525*t+1013904223)%Ji)/Ji}();function f(){h(),l.call("tick",e),n<r&&(u.stop(),l.call("end",e))}function h(r){var u,l,c=t.length;void 0===r&&(r=1);for(var f=0;f<r;++f)for(n+=(o-n)*i,a.forEach((function(t){t(n)})),u=0;u<c;++u)null==(l=t[u]).fx?l.x+=l.vx*=s:(l.x=l.fx,l.vx=0),null==l.fy?l.y+=l.vy*=s:(l.y=l.fy,l.vy=0);return e}function p(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=10*Math.sqrt(.5+n),o=n*Wi;e.x=i*Math.cos(o),e.y=i*Math.sin(o)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function d(e){return e.initialize&&e.initialize(t,c),e}return null==t&&(t=[]),p(),e={tick:h,restart:function(){return u.restart(f),e},stop:function(){return u.stop(),e},nodes:function(n){return arguments.length?(t=n,p(),a.forEach(d),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(o=+t,e):o},velocityDecay:function(t){return arguments.length?(s=1-t,e):1-s},randomSource:function(t){return arguments.length?(c=t,a.forEach(d),e):c},force:function(t,n){return arguments.length>1?(null==n?a.delete(t):a.set(t,d(n)),e):a.get(t)},find:function(e,n,r){var i,o,s,a,u,l=0,c=t.length;for(null==r?r=Infinity:r*=r,l=0;l<c;++l)(s=(i=e-(a=t[l]).x)*i+(o=n-a.y)*o)<r&&(u=a,r=s);return u},on:function(t,n){return arguments.length>1?(l.on(t,n),e):l.on(t)}}}().force("charge",function(){var t,e,n,r,i,o=Ui(-30),s=1,a=Infinity,u=.81;function l(n){var i,o=t.length,s=zi(t,Ki,Yi).visitAfter(f);for(r=n,i=0;i<o;++i)e=t[i],s.visit(h)}function c(){if(t){var e,n,r=t.length;for(i=new Array(r),e=0;e<r;++e)i[(n=t[e]).index]=+o(n,e,t)}}function f(t){var e,n,r,o,s,a=0,u=0;if(t.length){for(r=o=s=0;s<4;++s)(e=t[s])&&(n=Math.abs(e.value))&&(a+=e.value,u+=n,r+=n*e.x,o+=n*e.y);t.x=r/u,t.y=o/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{a+=i[e.data.index]}while(e=e.next)}t.value=a}function h(t,o,l,c){if(!t.value)return!0;var f=t.x-e.x,h=t.y-e.y,p=c-o,d=f*f+h*h;if(p*p/u<d)return d<a&&(0===f&&(d+=(f=Fi(n))*f),0===h&&(d+=(h=Fi(n))*h),d<s&&(d=Math.sqrt(s*d)),e.vx+=f*t.value*r/d,e.vy+=h*t.value*r/d),!0;if(!(t.length||d>=a)){(t.data!==e||t.next)&&(0===f&&(d+=(f=Fi(n))*f),0===h&&(d+=(h=Fi(n))*h),d<s&&(d=Math.sqrt(s*d)));do{t.data!==e&&(e.vx+=f*(p=i[t.data.index]*r/d),e.vy+=h*p)}while(t=t.next)}}return l.initialize=function(e,r){t=e,n=r,c()},l.strength=function(t){return arguments.length?(o="function"==typeof t?t:Ui(+t),c(),l):o},l.distanceMin=function(t){return arguments.length?(s=t*t,l):Math.sqrt(s)},l.distanceMax=function(t){return arguments.length?(a=t*t,l):Math.sqrt(a)},l.theta=function(t){return arguments.length?(u=t*t,l):Math.sqrt(u)},l}().strength(-30)).force("center",function(t,e){var n,r=1;function i(){var i,o,s=n.length,a=0,u=0;for(i=0;i<s;++i)a+=(o=n[i]).x,u+=o.y;for(a=(a/s-t)*r,u=(u/s-e)*r,i=0;i<s;++i)(o=n[i]).x-=a,o.y-=u}return null==t&&(t=0),null==e&&(e=0),i.initialize=function(t){n=t},i.x=function(e){return arguments.length?(t=+e,i):t},i.y=function(t){return arguments.length?(e=+t,i):e},i.strength=function(t){return arguments.length?(r=+t,i):r},i}(i.x,i.y)).force("collision",function(t){var e,n,r,i=1,o=1;function s(){for(var t,s,u,l,c,f,h,p=e.length,d=0;d<o;++d)for(s=zi(e,Xi,Hi).visitAfter(a),t=0;t<p;++t)h=(f=n[(u=e[t]).index])*f,l=u.x+u.vx,c=u.y+u.vy,s.visit(y);function y(t,e,n,o,s){var a=t.data,p=t.r,d=f+p;if(!a)return e>l+d||o<l-d||n>c+d||s<c-d;if(a.index>u.index){var y=l-a.x-a.vx,m=c-a.y-a.vy,g=y*y+m*m;g<d*d&&(0===y&&(g+=(y=Fi(r))*y),0===m&&(g+=(m=Fi(r))*m),g=(d-(g=Math.sqrt(g)))/g*i,u.vx+=(y*=g)*(d=(p*=p)/(h+p)),u.vy+=(m*=g)*d,a.vx-=y*(d=1-d),a.vy-=m*d)}}}function a(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var r,i,o=e.length;for(n=new Array(o),r=0;r<o;++r)n[(i=e[r]).index]=+t(i,r,e)}}return"function"!=typeof t&&(t=Ui(null==t?1:+t)),s.initialize=function(t,n){e=t,r=n,u()},s.iterations=function(t){return arguments.length?(o=+t,s):o},s.strength=function(t){return arguments.length?(i=+t,s):i},s.radius=function(e){return arguments.length?(t="function"==typeof e?e:Ui(+e),u(),s):t},s}().radius(30)).stop());var i;r.nodes(t.nodes),r.force("link",function(t){var e,n,r,i,o,s,a=Qi,u=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},l=Ui(30),c=1;function f(r){for(var i=0,a=t.length;i<c;++i)for(var u,l,f,h,p,d,y,m=0;m<a;++m)h=(f=(u=t[m]).target).x+f.vx-(l=u.source).x-l.vx||Fi(s),p=f.y+f.vy-l.y-l.vy||Fi(s),p*=d=((d=Math.sqrt(h*h+p*p))-n[m])/d*r*e[m],f.vx-=(h*=d)*(y=o[m]),f.vy-=p*y,l.vx+=h*(y=1-y),l.vy+=p*y}function h(){if(r){var s,u,l=r.length,c=t.length,f=new Map(r.map((t,e)=>[a(t,e,r),t]));for(s=0,i=new Array(l);s<c;++s)(u=t[s]).index=s,"object"!=typeof u.source&&(u.source=Zi(f,u.source)),"object"!=typeof u.target&&(u.target=Zi(f,u.target)),i[u.source.index]=(i[u.source.index]||0)+1,i[u.target.index]=(i[u.target.index]||0)+1;for(s=0,o=new Array(c);s<c;++s)o[s]=i[(u=t[s]).source.index]/(i[u.source.index]+i[u.target.index]);e=new Array(c),p(),n=new Array(c),d()}}function p(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+u(t[n],n,t)}function d(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+l(t[e],e,t)}return null==t&&(t=[]),f.initialize=function(t,e){r=t,s=e,h()},f.links=function(e){return arguments.length?(t=e,h(),f):t},f.id=function(t){return arguments.length?(a=t,f):a},f.iterations=function(t){return arguments.length?(c=+t,f):c},f.strength=function(t){return arguments.length?(u="function"==typeof t?t:Ui(+t),p(),f):u},f.distance=function(t){return arguments.length?(l="function"==typeof t?t:Ui(+t),d(),f):l},f}(t.links).id(t=>t.id));for(let t=0;t<n.ticks&&r.alpha()>r.alphaMin();t++)r.tick();return r},t.makeGramLinkDatum=i,t.makeGramNodeDatum=n,t.moveLinks=t=>{t.attr("x1",t=>r(t.source)?t.source.x:0).attr("y1",t=>r(t.source)?t.source.y:0).attr("x2",t=>r(t.target)?t.target.x:0).attr("y2",t=>r(t.target)?t.target.y:0)},t.moveNodes=t=>{t.attr("transform",(function(t){return"translate("+t.x+","+t.y+")"}))},t.nodeToD3=ve,t.parse=me,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=d3-gram.umd.production.min.js.map
