!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(((t=t||self).gram=t.gram||{},t.gram.d3={}))}(this,(function(t){"use strict";const e="__missing_id__",n=(t,n,r)=>({id:t||e,labels:n||[],record:r||[]}),r=t=>void 0!==t.id,i=(t,n,r,i,o)=>({id:r||e,labels:i||[],record:o||[],source:t,target:n});var o=/[0-9a-zA-Z_@]+\b@*/,a=new RegExp("^"+o.source+"$"),s={__proto__:null,boolean:/true|false|TRUE|FALSE\b(?!@)/,hexadecimal:/-?0x(?:[0-9a-fA-F]+)\b(?!@)/,octal:/-?0(?:[0-7]+)\b(?!@)/,measurement:/-?(?:[0-9]|[1-9][0-9]+)(?:\.[0-9]+)?[a-zA-Z]+\b(?!@)/,decimal:/-?(?:[0-9]|[1-9][0-9]+)\.[0-9]+(?:[eE][-+]?[0-9]+)?\b(?!@)/,integer:/-?(?:[0-9]|[1-9][0-9]+)(?:[eE][-+]?[0-9]+)?\b(?!@)/,taggedString:/[a-zA-Z][0-9a-zA-Z_@]*`(?:\\[`bfnrt/\\]|\\u[a-fA-F0-9]{4}|[^`\\])*`/,doubleQuotedString:/"(?:\\["bfnrt/\\]|\\u[a-fA-F0-9]{4}|[^"\\])*"/,singleQuotedString:/'(?:\\['bfnrt/\\]|\\u[a-fA-F0-9]{4}|[^'\\])*'/,tickedString:/`(?:\\[`bfnrt/\\]|\\u[a-fA-F0-9]{4}|[^`\\])*`/,symbol:/[a-zA-Z_][0-9a-zA-Z_]*\b(?!@)/,identifier:o,isValidIdentifier:function(t){return t&&a.test(t)}},u=function(t){return!!t.type&&"path"===t.type},l=function(t){return u(t)&&"ø"===t.id},c=function(t){return u(t)&&t.children&&0===t.children.length&&"ø"!==t.id},f=function(t){return!!t.type&&!!t.value&&"property"!==t.type};function h(){return(h=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function p(t){return Array.isArray(t)?t:t instanceof Function?p(t()):void 0===t?[]:[t]}var d=function(t,e){void 0===e&&(e={});var n=h({type:"path"},e.id&&{id:e.id},e.labels&&{labels:e.labels},e.record&&{record:e.record});if(void 0===t)return n.id&&"ø"!==n.id?(n.children=[],n):(n.children=void 0,y);if(0===t.length)return"ø"===n.id?y:(n.children=[],n);if(1===t.length){var r=t[0];return l(r)?(n.children=[],n):(n.children=[r],n)}if(2===t.length){if(e.kind&&"pair"!==e.kind&&c(t[0])&&c(t[1]))return n.kind=e.kind,n.children=[t[0],t[1]],n;if(l(t[0])&&l(t[1]))return n.kind=e.kind,n.children=[],n;n.children=[t[0],t[1]]}return n.kind=e.kind||"pair",n},y={type:"path",id:"ø",labels:void 0,record:void 0,children:[]},g=function(t,e,n){return h({type:"path"},t&&{id:t},e&&{labels:e},n&&{record:n},{children:[]})},m=function(t,e,n,r,i){return h({type:"path",id:n},r&&{labels:r},i&&{record:i},{kind:e,children:t})},v=function(){return new Map},b=function(t){return Object.entries(t).reduce((function(t,e){return t.set(e[0],w(e[1])),t}),v())},w=function t(e){if(Array.isArray(e))return e.map((function(e){return t(e)}));if("object"==typeof e)return e instanceof Date?S(e):f(e)?e:b(e);switch(typeof e){case"string":return x(e);case"bigint":return E(e.toString());case"boolean":return _(e);case"number":return E(e.toString());case"symbol":return x(e.toString());default:throw new Error("Unsupported value: "+e)}},_=function(t){return{type:"boolean",value:t?"true":"false"}},x=function(t){return{type:"string",value:t}},k=function(t,e){return{type:"tagged",value:e,tag:t}},E=function(t){return{type:"decimal",value:String(t)}},S=function(t){return k("date",t instanceof Date?t.toISOString().slice(0,10):t)},A=function t(e){return void 0===e.children||0===e.children.length?e:t(e.children[0])},$=function t(e){return void 0===e.children||0===e.children.length?e:t(e.children[e.children.length-1])},N=function t(e){if(c(e))return[e];if((n=e).type&&"seq"===n.type)return t(e.children);var n;if(Array.isArray(e)){var r=[],i=e.map(t).flat().reduce((function(t,e){return e.id?t.has(e.id)?t.set(e.id,Object.assign(t.get(e.id),e)):t.set(e.id,e):r.push(e),t}),new Map);return Array.from(i.values()).concat(r)}return t(e.children)},M=function t(e){return void 0===e||void 0===e.children||0===e.children.length?[]:2===e.children.length?[].concat(t(e.children[0]),void 0!==e.kind&&"pair"!==e.kind?[m([$(e.children[0]),A(e.children[1])],e.kind,e.id,e.labels,e.record)]:[],t(e.children[1])):e.children.reduce((function(e,n){return[].concat(e,t(n))}),[])},P=function(t){if(t)throw t},O=function(t){return null!=t&&null!=t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)},T=Object.prototype.hasOwnProperty,j=Object.prototype.toString,C=Object.defineProperty,I=Object.getOwnPropertyDescriptor,q=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===j.call(t)},L=function(t){if(!t||"[object Object]"!==j.call(t))return!1;var e,n=T.call(t,"constructor"),r=t.constructor&&t.constructor.prototype&&T.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!r)return!1;for(e in t);return void 0===e||T.call(t,e)},R=function(t,e){C&&"__proto__"===e.name?C(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},z=function(t,e){if("__proto__"===e){if(!T.call(t,e))return;if(I)return I(t,e).value}return t[e]},D=function t(){var e,n,r,i,o,a,s=arguments[0],u=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},u=2),(null==s||"object"!=typeof s&&"function"!=typeof s)&&(s={});u<l;++u)if(null!=(e=arguments[u]))for(n in e)r=z(s,n),s!==(i=z(e,n))&&(c&&i&&(L(i)||(o=q(i)))?(o?(o=!1,a=r&&q(r)?r:[]):a=r&&L(r)?r:{},R(s,{name:n,newValue:t(c,a,i)})):void 0!==i&&R(s,{name:n,newValue:i}));return s},B=t=>{if("[object Object]"!==Object.prototype.toString.call(t))return!1;const e=Object.getPrototypeOf(t);return null===e||e===Object.prototype},V=[].slice,G=function(t,e){var n;return function(){var e,o=V.call(arguments,0),a=t.length>o.length;a&&o.push(r);try{e=t.apply(null,o)}catch(t){if(a&&n)throw t;return r(t)}a||(e&&"function"==typeof e.then?e.then(i,r):e instanceof Error?r(e):i(e))};function r(){n||(n=!0,e.apply(null,arguments))}function i(t){r(null,t)}},U=F;F.wrap=G;var X=[].slice;function F(){var t=[],e={run:function(){var e=-1,n=X.call(arguments,0,-1),r=arguments[arguments.length-1];if("function"!=typeof r)throw new Error("Expected function as last argument, not "+r);function i(o){var a=t[++e],s=X.call(arguments,0),u=s.slice(1),l=n.length,c=-1;if(o)r(o);else{for(;++c<l;)null==u[c]&&(u[c]=n[c]);n=u,a?G(a,i).apply(null,n):r.apply(null,[null].concat(n))}}i.apply(null,[null].concat(n))},use:function(n){if("function"!=typeof n)throw new Error("Expected `fn` to be a function, not "+n);return t.push(n),e}};return e}var H={}.hasOwnProperty,Q=function(t){return t&&"object"==typeof t?H.call(t,"position")||H.call(t,"type")?Z(t.position):H.call(t,"start")||H.call(t,"end")?Z(t):H.call(t,"line")||H.call(t,"column")?Y(t):"":""};function Y(t){return t&&"object"==typeof t||(t={}),K(t.line)+":"+K(t.column)}function Z(t){return t&&"object"==typeof t||(t={}),Y(t.start)+"-"+Y(t.end)}function K(t){return t&&"number"==typeof t?t:1}var J=et;function W(){}W.prototype=Error.prototype;var tt=et.prototype=new W;function et(t,e,n){var r,i,o;"string"==typeof e&&(n=e,e=null),r=function(t){var e,n=[null,null];return"string"==typeof t&&(-1===(e=t.indexOf(":"))?n[1]=t:(n[0]=t.slice(0,e),n[1]=t.slice(e+1))),n}(n),i=Q(e)||"1:1",o={start:{line:null,column:null},end:{line:null,column:null}},e&&e.position&&(e=e.position),e&&(e.start?(o=e,e=e.start):o.start=e),t.stack&&(this.stack=t.stack,t=t.message),this.message=t,this.name=i,this.reason=t,this.line=e?e.line:null,this.column=e?e.column:null,this.location=o,this.source=r[0],this.ruleId=r[1]}function nt(t){var e,n;return rt(t),e=47===t.charCodeAt(0),(n=function(t,e){for(var n,r,i="",o=0,a=-1,s=0,u=-1;++u<=t.length;){if(u<t.length)n=t.charCodeAt(u);else{if(47===n)break;n=47}if(47===n){if(a===u-1||1===s);else if(a!==u-1&&2===s){if(i.length<2||2!==o||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2))if(i.length>2){if((r=i.lastIndexOf("/"))!==i.length-1){r<0?(i="",o=0):o=(i=i.slice(0,r)).length-1-i.lastIndexOf("/"),a=u,s=0;continue}}else if(i.length){i="",o=0,a=u,s=0;continue}e&&(i=i.length?i+"/..":"..",o=2)}else i.length?i+="/"+t.slice(a+1,u):i=t.slice(a+1,u),o=u-a-1;a=u,s=0}else 46===n&&s>-1?s++:s=-1}return i}(t,!e)).length||e||(n="."),n.length&&47===t.charCodeAt(t.length-1)&&(n+="/"),e?"/"+n:n}function rt(t){if("string"!=typeof t)throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}tt.file="",tt.name="",tt.reason="",tt.message="",tt.stack="",tt.fatal=null,tt.column=null,tt.line=null;var it=function(t,e){var n,r,i,o,a=0,s=-1;if(void 0!==e&&"string"!=typeof e)throw new TypeError('"ext" argument must be a string');if(rt(t),n=t.length,void 0===e||!e.length||e.length>t.length){for(;n--;)if(47===t.charCodeAt(n)){if(i){a=n+1;break}}else s<0&&(i=!0,s=n+1);return s<0?"":t.slice(a,s)}if(e===t)return"";for(r=-1,o=e.length-1;n--;)if(47===t.charCodeAt(n)){if(i){a=n+1;break}}else r<0&&(i=!0,r=n+1),o>-1&&(t.charCodeAt(n)===e.charCodeAt(o--)?o<0&&(s=n):(o=-1,s=r));return a===s?s=r:s<0&&(s=t.length),t.slice(a,s)},ot=function(){for(var t,e=-1;++e<arguments.length;)rt(arguments[e]),arguments[e]&&(t=void 0===t?arguments[e]:t+"/"+arguments[e]);return void 0===t?".":nt(t)},at=lt,st={}.hasOwnProperty,ut=["history","path","basename","stem","extname","dirname"];function lt(t){var e,n;if(t){if("string"==typeof t||O(t))t={contents:t};else if("message"in t&&"messages"in t)return t}else t={};if(!(this instanceof lt))return new lt(t);for(this.data={},this.messages=[],this.history=[],this.cwd="/",n=-1;++n<ut.length;)st.call(t,e=ut[n])&&(this[e]=t[e]);for(e in t)ut.indexOf(e)<0&&(this[e]=t[e])}function ct(t,e){if(t&&t.indexOf("/")>-1)throw new Error("`"+e+"` cannot be a path: did not expect `/`")}function ft(t,e){if(!t)throw new Error("`"+e+"` cannot be empty")}function ht(t,e){if(!t)throw new Error("Setting `"+e+"` requires `path` to be set too")}lt.prototype.toString=function(t){return(this.contents||"").toString(t)},Object.defineProperty(lt.prototype,"path",{get:function(){return this.history[this.history.length-1]},set:function(t){ft(t,"path"),this.path!==t&&this.history.push(t)}}),Object.defineProperty(lt.prototype,"dirname",{get:function(){return"string"==typeof this.path?function(t){var e,n,r;if(rt(t),!t.length)return".";for(e=-1,r=t.length;--r;)if(47===t.charCodeAt(r)){if(n){e=r;break}}else n||(n=!0);return e<0?47===t.charCodeAt(0)?"/":".":1===e&&47===t.charCodeAt(0)?"//":t.slice(0,e)}(this.path):void 0},set:function(t){ht(this.path,"dirname"),this.path=ot(t||"",this.basename)}}),Object.defineProperty(lt.prototype,"basename",{get:function(){return"string"==typeof this.path?it(this.path):void 0},set:function(t){ft(t,"basename"),ct(t,"basename"),this.path=ot(this.dirname||"",t)}}),Object.defineProperty(lt.prototype,"extname",{get:function(){return"string"==typeof this.path?function(t){var e,n,r,i=-1,o=0,a=-1,s=0;for(rt(t),r=t.length;r--;)if(47!==(n=t.charCodeAt(r)))a<0&&(e=!0,a=r+1),46===n?i<0?i=r:1!==s&&(s=1):i>-1&&(s=-1);else if(e){o=r+1;break}return i<0||a<0||0===s||1===s&&i===a-1&&i===o+1?"":t.slice(i,a)}(this.path):void 0},set:function(t){if(ct(t,"extname"),ht(this.path,"extname"),t){if(46!==t.charCodeAt(0))throw new Error("`extname` must start with `.`");if(t.indexOf(".",1)>-1)throw new Error("`extname` cannot contain multiple dots")}this.path=ot(this.dirname,this.stem+(t||""))}}),Object.defineProperty(lt.prototype,"stem",{get:function(){return"string"==typeof this.path?it(this.path,this.extname):void 0},set:function(t){ft(t,"stem"),ct(t,"stem"),this.path=ot(this.dirname||"",t+(this.extname||""))}});var pt=at;at.prototype.message=function(t,e,n){var r=new J(t,e,n);return this.path&&(r.name=this.path+":"+r.name,r.file=this.path),r.fatal=!1,this.messages.push(r),r},at.prototype.info=function(){var t=this.message.apply(this,arguments);return t.fatal=null,t},at.prototype.fail=function(){var t=this.message.apply(this,arguments);throw t.fatal=!0,t};var dt=pt,yt=function t(){var e=[],n=U(),r={},i=!1,o=-1;return a.data=function(t,e){return"string"==typeof t?2===arguments.length?(xt("data",i),r[t]=e,a):mt.call(r,t)&&r[t]||null:t?(xt("data",i),r=t,a):r},a.freeze=s,a.attachers=e,a.use=function(t){var n;if(xt("use",i),null==t);else if("function"==typeof t)c.apply(null,arguments);else{if("object"!=typeof t)throw new Error("Expected usable value, not `"+t+"`");"length"in t?l(t):o(t)}return n&&(r.settings=D(r.settings||{},n)),a;function o(t){l(t.plugins),t.settings&&(n=D(n||{},t.settings))}function s(t){if("function"==typeof t)c(t);else{if("object"!=typeof t)throw new Error("Expected usable value, not `"+t+"`");"length"in t?c.apply(null,t):o(t)}}function l(t){var e,n;if(null==t);else{if("object"!=typeof t||!("length"in t))throw new Error("Expected a list of plugins, not `"+t+"`");for(e=t.length,n=-1;++n<e;)s(t[n])}}function c(t,n){var r=u(t);r?(B(r[1])&&B(n)&&(n=D(r[1],n)),r[1]=n):e.push(gt.call(arguments))}},a.parse=function(t){var e,n=dt(t);return s(),wt("parse",e=a.Parser),bt(e,"parse")?new e(String(n),n).parse():e(String(n),n)},a.stringify=function(t,e){var n,r=dt(e);return s(),_t("stringify",n=a.Compiler),kt(t),bt(n,"compile")?new n(t,r).compile():n(t,r)},a.run=l,a.runSync=function(t,e){var n,r=!1;return l(t,e,(function(t,e){r=!0,P(t),n=e})),Et("runSync","run",r),n},a.process=c,a.processSync=function(t){var e,n=!1;return s(),wt("processSync",a.Parser),_t("processSync",a.Compiler),c(e=dt(t),(function(t){n=!0,P(t)})),Et("processSync","process",n),e},a;function a(){for(var n=t(),i=e.length,o=-1;++o<i;)n.use.apply(null,e[o]);return n.data(D(!0,{},r)),n}function s(){var t,r,s,u;if(i)return a;for(;++o<e.length;)r=(t=e[o])[0],!1!==(s=t[1])&&(!0===s&&(t[1]=void 0),"function"==typeof(u=r.apply(a,t.slice(1)))&&n.use(u));return i=!0,o=Infinity,a}function u(t){for(var n,r=e.length,i=-1;++i<r;)if((n=e[i])[0]===t)return n}function l(t,e,r){if(kt(t),s(),r||"function"!=typeof e||(r=e,e=null),!r)return new Promise(i);function i(i,o){n.run(t,dt(e),(function(e,n,a){n=n||t,e?o(e):i?i(n):r(null,n,a)}))}i(null,r)}function c(t,e){if(s(),wt("process",a.Parser),_t("process",a.Compiler),!e)return new Promise(n);function n(n,r){var i=dt(t);vt.run(a,{file:i},(function(t){t?r(t):n?n(i):e(null,i)}))}n(null,e)}}().freeze(),gt=[].slice,mt={}.hasOwnProperty,vt=U().use((function(t,e){e.tree=t.parse(e.file)})).use((function(t,e,n){t.run(e.tree,e.file,(function(t,r,i){t?n(t):(e.tree=r,e.file=i,n())}))})).use((function(t,e){var n=t.stringify(e.tree,e.file),r=e.file;null==n||("string"==typeof n||O(n)?r.contents=n:r.result=n)}));function bt(t,e){return"function"==typeof t&&t.prototype&&(function(t){var e;for(e in t)return!0;return!1}(t.prototype)||e in t.prototype)}function wt(t,e){if("function"!=typeof e)throw new Error("Cannot `"+t+"` without `Parser`")}function _t(t,e){if("function"!=typeof e)throw new Error("Cannot `"+t+"` without `Compiler`")}function xt(t,e){if(e)throw new Error("Cannot invoke `"+t+"` on a frozen processor.\nCreate a new processor first, by invoking it: use `processor()` instead of `processor`.")}function kt(t){if(!t||"string"!=typeof t.type)throw new Error("Expected node, got `"+t+"`")}function Et(t,e,n){if(!n)throw new Error("`"+t+"` finished async. Use `"+e+"` instead")}var St="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function At(t,e){return t(e={exports:{}},e.exports),e.exports}var $t=At((function(t){!function(e,n){t.exports?t.exports=n():e.nearley=n()}(St,(function(){function t(e,n,r){return this.id=++t.highestId,this.name=e,this.symbols=n,this.postprocess=r,this}function e(t,e,n,r){this.rule=t,this.dot=e,this.reference=n,this.data=[],this.wantedBy=r,this.isComplete=this.dot===t.symbols.length}function n(t,e){this.grammar=t,this.index=e,this.states=[],this.wants={},this.scannable=[],this.completed={}}function r(t,e){this.rules=t,this.start=e||this.rules[0].name;var n=this.byName={};this.rules.forEach((function(t){n.hasOwnProperty(t.name)||(n[t.name]=[]),n[t.name].push(t)}))}function i(){this.reset("")}function o(t,e,o){if(t instanceof r){var a=t;o=e}else a=r.fromCompiled(t,e);for(var s in this.grammar=a,this.options={keepHistory:!1,lexer:a.lexer||new i},o||{})this.options[s]=o[s];this.lexer=this.options.lexer,this.lexerState=void 0;var u=new n(a,0);this.table=[u],u.wants[a.start]=[],u.predict(a.start),u.process(),this.current=0}function a(t){var e=typeof t;if("string"===e)return t;if("object"===e){if(t.literal)return JSON.stringify(t.literal);if(t instanceof RegExp)return t.toString();if(t.type)return"%"+t.type;if(t.test)return"<"+String(t.test)+">";throw new Error("Unknown symbol type: "+t)}}return t.highestId=0,t.prototype.toString=function(t){var e=void 0===t?this.symbols.map(a).join(" "):this.symbols.slice(0,t).map(a).join(" ")+" ● "+this.symbols.slice(t).map(a).join(" ");return this.name+" → "+e},e.prototype.toString=function(){return"{"+this.rule.toString(this.dot)+"}, from: "+(this.reference||0)},e.prototype.nextState=function(t){var n=new e(this.rule,this.dot+1,this.reference,this.wantedBy);return n.left=this,n.right=t,n.isComplete&&(n.data=n.build(),n.right=void 0),n},e.prototype.build=function(){var t=[],e=this;do{t.push(e.right.data),e=e.left}while(e.left);return t.reverse(),t},e.prototype.finish=function(){this.rule.postprocess&&(this.data=this.rule.postprocess(this.data,this.reference,o.fail))},n.prototype.process=function(t){for(var e=this.states,n=this.wants,r=this.completed,i=0;i<e.length;i++){var a=e[i];if(a.isComplete){if(a.finish(),a.data!==o.fail){for(var s=a.wantedBy,u=s.length;u--;)this.complete(s[u],a);a.reference===this.index&&(this.completed[l=a.rule.name]=this.completed[l]||[]).push(a)}}else{var l;if("string"!=typeof(l=a.rule.symbols[a.dot])){this.scannable.push(a);continue}if(n[l]){if(n[l].push(a),r.hasOwnProperty(l)){var c=r[l];for(u=0;u<c.length;u++)this.complete(a,c[u])}}else n[l]=[a],this.predict(l)}}},n.prototype.predict=function(t){for(var n=this.grammar.byName[t]||[],r=0;r<n.length;r++){var i=new e(n[r],0,this.index,this.wants[t]);this.states.push(i)}},n.prototype.complete=function(t,e){var n=t.nextState(e);this.states.push(n)},r.fromCompiled=function(e,n){var i=e.Lexer;e.ParserStart&&(n=e.ParserStart,e=e.ParserRules);var o=new r(e=e.map((function(e){return new t(e.name,e.symbols,e.postprocess)})),n);return o.lexer=i,o},i.prototype.reset=function(t,e){this.buffer=t,this.index=0,this.line=e?e.line:1,this.lastLineBreak=e?-e.col:0},i.prototype.next=function(){if(this.index<this.buffer.length){var t=this.buffer[this.index++];return"\n"===t&&(this.line+=1,this.lastLineBreak=this.index),{value:t}}},i.prototype.save=function(){return{line:this.line,col:this.index-this.lastLineBreak}},i.prototype.formatError=function(t,e){var n=this.buffer;if("string"==typeof n){var r=n.split("\n").slice(Math.max(0,this.line-5),this.line),i=n.indexOf("\n",this.index);-1===i&&(i=n.length);var o=this.index-this.lastLineBreak,a=String(this.line).length;return e+=" at line "+this.line+" col "+o+":\n\n",(e+=r.map((function(t,e){return s(this.line-r.length+e+1,a)+" "+t}),this).join("\n"))+"\n"+s("",a+o)+"^\n"}return e+" at index "+(this.index-1);function s(t,e){var n=String(t);return Array(e-n.length+1).join(" ")+n}},o.fail={},o.prototype.feed=function(t){var e,r=this.lexer;for(r.reset(t,this.lexerState);;){try{if(!(e=r.next()))break}catch(t){var o=new n(this.grammar,this.current+1);throw this.table.push(o),(u=new Error(this.reportLexerError(t))).offset=this.current,u.token=t.token,u}var a=this.table[this.current];this.options.keepHistory||delete this.table[this.current-1];var s=this.current+1;o=new n(this.grammar,s),this.table.push(o);for(var u,l=void 0!==e.text?e.text:e.value,c=r.constructor===i?e.value:e,f=a.scannable,h=f.length;h--;){var p=f[h],d=p.rule.symbols[p.dot];if(d.test?d.test(c):d.type?d.type===e.type:d.literal===l){var y=p.nextState({data:c,token:e,isToken:!0,reference:s-1});o.states.push(y)}}if(o.process(),0===o.states.length)throw(u=new Error(this.reportError(e))).offset=this.current,u.token=e,u;this.options.keepHistory&&(a.lexerState=r.save()),this.current++}return a&&(this.lexerState=r.save()),this.results=this.finish(),this},o.prototype.reportLexerError=function(t){var e,n,r=t.token;return r?(e="input "+JSON.stringify(r.text[0])+" (lexer error)",n=this.lexer.formatError(r,"Syntax error")):(e="input (lexer error)",n=t.message),this.reportErrorCommon(n,e)},o.prototype.reportError=function(t){var e=(t.type?t.type+" token: ":"")+JSON.stringify(void 0!==t.value?t.value:t),n=this.lexer.formatError(t,"Syntax error");return this.reportErrorCommon(n,e)},o.prototype.reportErrorCommon=function(t,e){var n=[];n.push(t);var r=this.table[this.table.length-2],i=r.states.filter((function(t){var e=t.rule.symbols[t.dot];return e&&"string"!=typeof e}));return 0===i.length?(n.push("Unexpected "+e+". I did not expect any more input. Here is the state of my parse table:\n"),this.displayStateStack(r.states,n)):(n.push("Unexpected "+e+". Instead, I was expecting to see one of the following:\n"),i.map((function(t){return this.buildFirstStateStack(t,[])||[t]}),this).forEach((function(t){var e=t[0],r=this.getSymbolDisplay(e.rule.symbols[e.dot]);n.push("A "+r+" based on:"),this.displayStateStack(t,n)}),this)),n.push(""),n.join("\n")},o.prototype.displayStateStack=function(t,e){for(var n,r=0,i=0;i<t.length;i++){var o=t[i],a=o.rule.toString(o.dot);a===n?r++:(r>0&&e.push("    ^ "+r+" more lines identical to this"),r=0,e.push("    "+a)),n=a}},o.prototype.getSymbolDisplay=function(t){return function(t){var e=typeof t;if("string"===e)return t;if("object"===e){if(t.literal)return JSON.stringify(t.literal);if(t instanceof RegExp)return"character matching "+t;if(t.type)return t.type+" token";if(t.test)return"token matching "+String(t.test);throw new Error("Unknown symbol type: "+t)}}(t)},o.prototype.buildFirstStateStack=function(t,e){if(-1!==e.indexOf(t))return null;if(0===t.wantedBy.length)return[t];var n=t.wantedBy[0],r=[t].concat(e),i=this.buildFirstStateStack(n,r);return null===i?null:[t].concat(i)},o.prototype.save=function(){var t=this.table[this.current];return t.lexerState=this.lexerState,t},o.prototype.restore=function(t){var e=t.index;this.current=e,this.table[e]=t,this.table.splice(e+1),this.lexerState=t.lexerState,this.results=this.finish()},o.prototype.rewind=function(t){if(!this.options.keepHistory)throw new Error("set option `keepHistory` to enable rewinding");this.restore(this.table[t])},o.prototype.finish=function(){var t=[],e=this.grammar.start;return this.table[this.table.length-1].states.forEach((function(n){n.rule.name===e&&n.dot===n.rule.symbols.length&&0===n.reference&&n.data!==o.fail&&t.push(n)})),t.map((function(t){return t.data}))},{Parser:o,Grammar:r,Rule:t}}))}));function Nt(){return(Nt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function Mt(t){return t[0]}var Pt=At((function(t){!function(e,n){t.exports?t.exports=n():e.moo=n()}(St,(function(){var t=Object.prototype.hasOwnProperty,e=Object.prototype.toString,n="boolean"==typeof(new RegExp).sticky;function r(t){return t&&"[object RegExp]"===e.call(t)}function i(t){return t&&"object"==typeof t&&!r(t)&&!Array.isArray(t)}function o(t){return new RegExp("|"+t).exec("").length-1}function a(t){return"("+t+")"}function s(t){return t.length?"(?:"+t.map((function(t){return"(?:"+t+")"})).join("|")+")":"(?!)"}function u(t){if("string"==typeof t)return"(?:"+function(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}(t)+")";if(r(t)){if(t.ignoreCase)throw new Error("RegExp /i flag not allowed");if(t.global)throw new Error("RegExp /g flag is implied");if(t.sticky)throw new Error("RegExp /y flag is implied");if(t.multiline)throw new Error("RegExp /m flag is implied");return t.source}throw new Error("Not a pattern: "+t)}function l(e,n){if(i(n)||(n={match:n}),n.include)throw new Error("Matching rules cannot also include states");var o={defaultType:e,lineBreaks:!!n.error||!!n.fallback,pop:!1,next:null,push:null,error:!1,fallback:!1,value:null,type:null,shouldThrow:!1};for(var a in n)t.call(n,a)&&(o[a]=n[a]);if("string"==typeof o.type&&e!==o.type)throw new Error("Type transform cannot be a string (type '"+o.type+"' for token '"+e+"')");var s=o.match;return o.match=Array.isArray(s)?s:s?[s]:[],o.match.sort((function(t,e){return r(t)&&r(e)?0:r(e)?-1:r(t)?1:e.length-t.length})),o}function c(t){return Array.isArray(t)?function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];if(r.include)for(var i=[].concat(r.include),o=0;o<i.length;o++)e.push({include:i[o]});else{if(!r.type)throw new Error("Rule has no type: "+JSON.stringify(r));e.push(l(r.type,r))}}return e}(t):function(t){for(var e=Object.getOwnPropertyNames(t),n=[],r=0;r<e.length;r++){var o=e[r],a=[].concat(t[o]);if("include"!==o){var s=[];a.forEach((function(t){i(t)?(s.length&&n.push(l(o,s)),n.push(l(o,t)),s=[]):s.push(t)})),s.length&&n.push(l(o,s))}else for(var u=0;u<a.length;u++)n.push({include:a[u]})}return n}(t)}var f=l("error",{lineBreaks:!0,shouldThrow:!0});function h(t,e){for(var i=null,l=Object.create(null),c=!0,h=null,p=[],d=[],y=0;y<t.length;y++)t[y].fallback&&(c=!1);for(y=0;y<t.length;y++){var g=t[y];if(g.include)throw new Error("Inheritance is not allowed in stateless lexers");if(g.error||g.fallback){if(i)throw!g.fallback==!i.fallback?new Error("Multiple "+(g.fallback?"fallback":"error")+" rules not allowed (for token '"+g.defaultType+"')"):new Error("fallback and error are mutually exclusive (for token '"+g.defaultType+"')");i=g}var m=g.match.slice();if(c)for(;m.length&&"string"==typeof m[0]&&1===m[0].length;)l[m.shift().charCodeAt(0)]=g;if(g.pop||g.push||g.next){if(!e)throw new Error("State-switching options are not allowed in stateless lexers (for token '"+g.defaultType+"')");if(g.fallback)throw new Error("State-switching options are not allowed on fallback tokens (for token '"+g.defaultType+"')")}if(0!==m.length){c=!1,p.push(g);for(var v=0;v<m.length;v++){var b=m[v];if(r(b))if(null===h)h=b.unicode;else if(h!==b.unicode&&!1===g.fallback)throw new Error("If one rule is /u then all must be")}var w=s(m.map(u)),_=new RegExp(w);if(_.test(""))throw new Error("RegExp matches empty string: "+_);if(o(w)>0)throw new Error("RegExp has capture groups: "+_+"\nUse (?: … ) instead");if(!g.lineBreaks&&_.test("\n"))throw new Error("Rule should declare lineBreaks: "+_);d.push(a(w))}}var x=i&&i.fallback,k=n&&!x?"ym":"gm",E=n||x?"":"|";return!0===h&&(k+="u"),{regexp:new RegExp(s(d)+E,k),groups:p,fast:l,error:i||f}}function p(t,e,n){var r=t&&(t.push||t.next);if(r&&!n[r])throw new Error("Missing state '"+r+"' (in token '"+t.defaultType+"' of state '"+e+"')");if(t&&t.pop&&1!=+t.pop)throw new Error("pop must be 1 (in token '"+t.defaultType+"' of state '"+e+"')")}var d=function(t,e){this.startState=e,this.states=t,this.buffer="",this.stack=[],this.reset()};d.prototype.reset=function(t,e){return this.buffer=t||"",this.index=0,this.line=e?e.line:1,this.col=e?e.col:1,this.queuedToken=e?e.queuedToken:null,this.queuedThrow=e?e.queuedThrow:null,this.setState(e?e.state:this.startState),this.stack=e&&e.stack?e.stack.slice():[],this},d.prototype.save=function(){return{line:this.line,col:this.col,state:this.state,stack:this.stack.slice(),queuedToken:this.queuedToken,queuedThrow:this.queuedThrow}},d.prototype.setState=function(t){if(t&&this.state!==t){this.state=t;var e=this.states[t];this.groups=e.groups,this.error=e.error,this.re=e.regexp,this.fast=e.fast}},d.prototype.popState=function(){this.setState(this.stack.pop())},d.prototype.pushState=function(t){this.stack.push(this.state),this.setState(t)};var y=n?function(t,e){return t.exec(e)}:function(t,e){var n=t.exec(e);return 0===n[0].length?null:n};function g(){return this.value}if(d.prototype._getGroup=function(t){for(var e=this.groups.length,n=0;n<e;n++)if(void 0!==t[n+1])return this.groups[n];throw new Error("Cannot find token type for matched text")},d.prototype.next=function(){var t=this.index;if(this.queuedGroup){var e=this._token(this.queuedGroup,this.queuedText,t);return this.queuedGroup=null,this.queuedText="",e}var n=this.buffer;if(t!==n.length){if(a=this.fast[n.charCodeAt(t)])return this._token(a,n.charAt(t),t);var r=this.re;r.lastIndex=t;var i=y(r,n),o=this.error;if(null==i)return this._token(o,n.slice(t,n.length),t);var a=this._getGroup(i),s=i[0];return o.fallback&&i.index!==t?(this.queuedGroup=a,this.queuedText=s,this._token(o,n.slice(t,i.index),t)):this._token(a,s,t)}},d.prototype._token=function(t,e,n){var r=0;if(t.lineBreaks){var i=/\n/g,o=1;if("\n"===e)r=1;else for(;i.exec(e);)r++,o=i.lastIndex}var a={type:"function"==typeof t.type&&t.type(e)||t.defaultType,value:"function"==typeof t.value?t.value(e):e,text:e,toString:g,offset:n,lineBreaks:r,line:this.line,col:this.col},s=e.length;if(this.index+=s,this.line+=r,0!==r?this.col=s-o+1:this.col+=s,t.shouldThrow)throw new Error(this.formatError(a,"invalid syntax"));return t.pop?this.popState():t.push?this.pushState(t.push):t.next&&this.setState(t.next),a},"undefined"!=typeof Symbol&&Symbol.iterator){var m=function(t){this.lexer=t};m.prototype.next=function(){var t=this.lexer.next();return{value:t,done:!t}},m.prototype[Symbol.iterator]=function(){return this},d.prototype[Symbol.iterator]=function(){return new m(this)}}return d.prototype.formatError=function(t,e){if(null==t){var n=this.buffer.slice(this.index);t={text:n,offset:this.index,lineBreaks:-1===n.indexOf("\n")?0:1,line:this.line,col:this.col}}var r=Math.max(0,t.offset-t.col+1),i=t.lineBreaks?t.text.indexOf("\n"):t.text.length,o=this.buffer.substring(r,t.offset+i);return e+=" at line "+t.line+" col "+t.col+":\n\n",(e+="  "+o+"\n")+"  "+Array(t.col).join(" ")+"^"},d.prototype.clone=function(){return new d(this.states,this.state)},d.prototype.has=function(t){return!0},{compile:function(t){var e=h(c(t));return new d({start:e},"start")},states:function(t,e){var n=t.$all?c(t.$all):[];delete t.$all;var r=Object.getOwnPropertyNames(t);e||(e=r[0]);for(var i=Object.create(null),o=0;o<r.length;o++)i[b=r[o]]=c(t[b]).concat(n);for(o=0;o<r.length;o++)for(var a=i[b=r[o]],s=Object.create(null),u=0;u<a.length;u++){var l=a[u];if(l.include){var f=[u,1];if(l.include!==b&&!s[l.include]){s[l.include]=!0;var y=i[l.include];if(!y)throw new Error("Cannot include nonexistent state '"+l.include+"' (in state '"+b+"')");for(var g=0;g<y.length;g++){var m=y[g];-1===a.indexOf(m)&&f.push(m)}}a.splice.apply(a,f),u--}}var v=Object.create(null);for(o=0;o<r.length;o++){var b;v[b=r[o]]=h(i[b],!0)}for(o=0;o<r.length;o++){var w=r[o],_=v[w],x=_.groups;for(u=0;u<x.length;u++)p(x[u],w,v);var k=Object.getOwnPropertyNames(_.fast);for(u=0;u<k.length;u++)p(_.fast[k[u]],w,v)}return new d(v,e)},error:Object.freeze({error:!0}),fallback:Object.freeze({fallback:!0}),keywords:function(t){for(var e=Object.create(null),n=Object.create(null),r=Object.getOwnPropertyNames(t),i=0;i<r.length;i++){var o=r[i],a=t[o];(Array.isArray(a)?a:[a]).forEach((function(t){if((n[t.length]=n[t.length]||[]).push(t),"string"!=typeof t)throw new Error("keyword must be string (in keyword '"+o+"')");e[t]=o}))}function s(t){return JSON.stringify(t)}var u="";for(var l in u+="switch (value.length) {\n",n)u+="case "+l+":\n",u+="switch (value) {\n",n[l].forEach((function(t){var n=e[t];u+="case "+s(t)+": return "+s(n)+"\n"})),u+="}\n";return u+="}\n",Function("value",u)}}}))})).compile({whitespace:{match:/\s+/,lineBreaks:!0},lineComment:{match:/\/\/.*?\n?$/},hexadecimal:s.hexadecimal,octal:s.octal,measurement:s.measurement,decimal:s.decimal,integer:s.integer,taggedString:{match:s.taggedString},boolean:["true","TRUE","True","false","FALSE","False"],symbol:s.symbol,identifier:s.identifier,doubleQuotedString:{match:s.doubleQuotedString,value:function(t){return t.slice(1,-1)}},singleQuotedString:{match:s.singleQuotedString,value:function(t){return t.slice(1,-1)}},tickedString:{match:s.tickedString,value:function(t){return t.slice(1,-1)}},"--\x3e":"--\x3e","--":"--","<--":"<--","-[]->":"-[]->","-[]-":"-[]-","<-[]-":"<-[]-","<-[":"<-[","]->":"]->","-[":"-[","]-":"]-","{":"{","}":"}","[":"[","]":"]","(":"(",")":")",",":",",":":":","`":"`","'":"'","ø":"ø"}),Ot=function(){return null},Tt=function(t){return t[0].text},jt={Lexer:Pt,ParserRules:[{name:"GramSeq$ebnf$1$subexpression$1",symbols:["Path"],postprocess:function(t){return t[0]}},{name:"GramSeq$ebnf$1",symbols:["GramSeq$ebnf$1$subexpression$1"]},{name:"GramSeq$ebnf$1$subexpression$2",symbols:["Path"],postprocess:function(t){return t[0]}},{name:"GramSeq$ebnf$1",symbols:["GramSeq$ebnf$1","GramSeq$ebnf$1$subexpression$2"],postprocess:function(t){return t[0].concat([t[1]])}},{name:"GramSeq",symbols:["_","GramSeq$ebnf$1"],postprocess:function(t){var e;return void 0===e&&(e=1),h({type:"seq",id:void 0},void 0,void 0,{children:p(t[1].flat(e).filter((function(t){return null!==t})))})}},{name:"Path",symbols:["NodePattern"],postprocess:Mt},{name:"Path",symbols:["PathComposition"],postprocess:Mt},{name:"Path",symbols:["PathPair"],postprocess:Mt},{name:"NodePattern",symbols:["Node","_","Edge","_","NodePattern"],postprocess:function(t){var e=t[2];return d([t[0],t[4]],{kind:e.kind,id:e.id,labels:e.labels,record:e.record})}},{name:"NodePattern",symbols:["Node"],postprocess:Mt},{name:"Node$ebnf$1",symbols:["Attributes"],postprocess:Mt},{name:"Node$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"Node",symbols:[{literal:"("},"_","Node$ebnf$1",{literal:")"},"_"],postprocess:function(t){var e=t[2];return e?g(e.id,e.labels,e.record):g()}},{name:"Edge$ebnf$1",symbols:["Attributes"],postprocess:Mt},{name:"Edge$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"Edge",symbols:[{literal:"-["},"_","Edge$ebnf$1",{literal:"]->"},"_"],postprocess:function(t){return Nt({kind:"right"},t[2])}},{name:"Edge$ebnf$2",symbols:["Attributes"],postprocess:Mt},{name:"Edge$ebnf$2",symbols:[],postprocess:function(){return null}},{name:"Edge",symbols:[{literal:"-["},"_","Edge$ebnf$2",{literal:"]-"},"_"],postprocess:function(t){return Nt({kind:"either"},t[2])}},{name:"Edge$ebnf$3",symbols:["Attributes"],postprocess:Mt},{name:"Edge$ebnf$3",symbols:[],postprocess:function(){return null}},{name:"Edge",symbols:[{literal:"<-["},"_","Edge$ebnf$3",{literal:"]-"},"_"],postprocess:function(t){return Nt({kind:"left"},t[2])}},{name:"Edge",symbols:[{literal:"-[]->"},"_"],postprocess:function(){return{kind:"right"}}},{name:"Edge",symbols:[{literal:"-[]-"},"_"],postprocess:function(){return{kind:"either"}}},{name:"Edge",symbols:[{literal:"<-[]-"},"_"],postprocess:function(){return{kind:"left"}}},{name:"Edge",symbols:[{literal:"--\x3e"},"_"],postprocess:function(){return{kind:"right"}}},{name:"Edge",symbols:[{literal:"--"},"_"],postprocess:function(){return{kind:"either"}}},{name:"Edge",symbols:[{literal:"<--"},"_"],postprocess:function(){return{kind:"left"}}},{name:"PathComposition",symbols:["PathPoint"],postprocess:Mt},{name:"PathComposition",symbols:["PathAnnotation"],postprocess:Mt},{name:"PathComposition",symbols:["PathExpression"],postprocess:Mt},{name:"PathPoint$ebnf$1",symbols:["Attributes"],postprocess:Mt},{name:"PathPoint$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"PathPoint",symbols:[{literal:"["},"_","PathPoint$ebnf$1",{literal:"]"},"_"],postprocess:function(t){var e=t[2];return e&&(e.id||e.labels||e.record)&&"ø"!==e.id?g(e.id,e.labels,e.record):y}},{name:"PathAnnotation$ebnf$1",symbols:["Attributes"],postprocess:Mt},{name:"PathAnnotation$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"PathAnnotation",symbols:[{literal:"["},"_","PathAnnotation$ebnf$1","Path",{literal:"]"},"_"],postprocess:function(t){var e=t[2];return d([t[3]],e?{id:e.id,labels:e.labels,record:e.record}:{})}},{name:"PathExpression$ebnf$1",symbols:["Attributes"],postprocess:Mt},{name:"PathExpression$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"PathExpression$ebnf$2",symbols:["Kind"],postprocess:Mt},{name:"PathExpression$ebnf$2",symbols:[],postprocess:function(){return null}},{name:"PathExpression",symbols:[{literal:"["},"_","PathExpression$ebnf$1","PathExpression$ebnf$2","Path","Path",{literal:"]"},"_"],postprocess:function(t){var e=t[2];return d([t[4],t[5]],{kind:t[3],id:e.id,labels:e.labels,record:e.record})}},{name:"PathPair$subexpression$1",symbols:["NodePattern"]},{name:"PathPair$subexpression$1",symbols:["PathComposition"]},{name:"PathPair",symbols:["PathPair$subexpression$1",{literal:","},"_","Path"],postprocess:function(t){return function(t,e,n,r,i){return h({type:"path",kind:"pair",id:void 0},void 0,void 0,{children:e})}(0,[t[0][0],t[3]])}},{name:"Kind",symbols:[{literal:","},"_"],postprocess:function(){return"pair"}},{name:"Kind",symbols:[{literal:"--\x3e"},"_"],postprocess:function(){return"right"}},{name:"Kind",symbols:[{literal:"--"},"_"],postprocess:function(){return"either"}},{name:"Kind",symbols:[{literal:"<--"},"_"],postprocess:function(){return"left"}},{name:"Attributes$ebnf$1",symbols:["Identity"],postprocess:Mt},{name:"Attributes$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"Attributes$ebnf$2",symbols:["LabelList"],postprocess:Mt},{name:"Attributes$ebnf$2",symbols:[],postprocess:function(){return null}},{name:"Attributes$ebnf$3",symbols:["Record"],postprocess:Mt},{name:"Attributes$ebnf$3",symbols:[],postprocess:function(){return null}},{name:"Attributes",symbols:["Attributes$ebnf$1","Attributes$ebnf$2","Attributes$ebnf$3"],postprocess:function(t,e,n){var r=t[0],i=t[1],o=t[2];return r||i||o?{id:r,labels:i,record:o}:n}},{name:"LabelList$ebnf$1",symbols:["Label"]},{name:"LabelList$ebnf$1",symbols:["LabelList$ebnf$1","Label"],postprocess:function(t){return t[0].concat([t[1]])}},{name:"LabelList",symbols:["LabelList$ebnf$1"],postprocess:function(t){return t[0]}},{name:"Label",symbols:[{literal:":"},"Symbol"],postprocess:function(t){return t[1]}},{name:"Identity",symbols:[Pt.has("identifier")?{type:"identifier"}:identifier,"_"],postprocess:Tt},{name:"Identity",symbols:[{literal:"ø"},"_"],postprocess:Tt},{name:"Identity",symbols:[Pt.has("symbol")?{type:"symbol"}:symbol,"_"],postprocess:Tt},{name:"Identity",symbols:[Pt.has("integer")?{type:"integer"}:integer,"_"],postprocess:Tt},{name:"Identity",symbols:[Pt.has("octal")?{type:"octal"}:octal,"_"],postprocess:Tt},{name:"Identity",symbols:[Pt.has("hexadecimal")?{type:"hexadecimal"}:hexadecimal,"_"],postprocess:Tt},{name:"Identity",symbols:[Pt.has("measurement")?{type:"measurement"}:measurement,"_"],postprocess:Tt},{name:"Identity",symbols:[Pt.has("tickedString")?{type:"tickedString"}:tickedString,"_"],postprocess:function(t){return t[0].text.slice(1,-1)}},{name:"Symbol",symbols:[Pt.has("symbol")?{type:"symbol"}:symbol,"_"],postprocess:Tt},{name:"Symbol",symbols:[Pt.has("tickedString")?{type:"tickedString"}:tickedString,"_"],postprocess:function(t){return t[0].text.slice(1,-1)}},{name:"Record",symbols:[{literal:"{"},"_",{literal:"}"},"_"],postprocess:Ot},{name:"Record$ebnf$1",symbols:[]},{name:"Record$ebnf$1$subexpression$1",symbols:[{literal:","},"_","Property"],postprocess:function(t){return t[2]}},{name:"Record$ebnf$1",symbols:["Record$ebnf$1","Record$ebnf$1$subexpression$1"],postprocess:function(t){return t[0].concat([t[1]])}},{name:"Record",symbols:[{literal:"{"},"_","Property","Record$ebnf$1",{literal:"}"},"_"],postprocess:function(t){return[t[2]].concat(t[3]).reduce((function(t,e){return t.set(e.name,e.value),t}),v())}},{name:"Property",symbols:["Symbol",{literal:":"},"_","Value"],postprocess:function(t){var e;return{type:"property",name:t[0],value:f(e=t[3])?e:w(e)}}},{name:"Value",symbols:["StringLiteral","_"],postprocess:Mt},{name:"Value",symbols:["NumericLiteral","_"],postprocess:Mt},{name:"Value",symbols:[Pt.has("boolean")?{type:"boolean"}:boolean,"_"],postprocess:function(t){return _(JSON.parse(t[0].value.toLowerCase()))}},{name:"Value$ebnf$1",symbols:[]},{name:"Value$ebnf$1$subexpression$1",symbols:[{literal:","},"_","Value"],postprocess:function(t){return t[2]}},{name:"Value$ebnf$1",symbols:["Value$ebnf$1","Value$ebnf$1$subexpression$1"],postprocess:function(t){return t[0].concat([t[1]])}},{name:"Value",symbols:[{literal:"["},"_","Value","Value$ebnf$1",{literal:"]"},"_"],postprocess:function(t){return[t[2]].concat(t[3])}},{name:"StringLiteral",symbols:[Pt.has("singleQuotedString")?{type:"singleQuotedString"}:singleQuotedString],postprocess:function(t){return x(t[0].value)}},{name:"StringLiteral",symbols:[Pt.has("doubleQuotedString")?{type:"doubleQuotedString"}:doubleQuotedString],postprocess:function(t){return x(t[0].value)}},{name:"StringLiteral",symbols:[Pt.has("tickedString")?{type:"tickedString"}:tickedString],postprocess:function(t){return x(t[0].value)}},{name:"StringLiteral",symbols:[Pt.has("taggedString")?{type:"taggedString"}:taggedString],postprocess:function(t){var e=function(t){var e=t.match(/([^`]+)`(.+)`$/);if(null==e)throw Error("Malformed tagged string: "+t);return{tag:e[1],value:e[2]}}(t[0].value);return k(e.tag,e.value)}},{name:"NumericLiteral",symbols:[Pt.has("integer")?{type:"integer"}:integer],postprocess:function(t){return{type:"integer",value:String(t[0].value)}}},{name:"NumericLiteral",symbols:[Pt.has("decimal")?{type:"decimal"}:decimal],postprocess:function(t){return E(t[0].value)}},{name:"NumericLiteral",symbols:[Pt.has("hexadecimal")?{type:"hexadecimal"}:hexadecimal],postprocess:function(t){return{type:"hexadecimal",value:"number"==typeof(e=t[0].value)?e.toString(16):e};var e}},{name:"NumericLiteral",symbols:[Pt.has("octal")?{type:"octal"}:octal],postprocess:function(t){return{type:"octal",value:"number"==typeof(e=t[0].value)?e.toString(8):e};var e}},{name:"NumericLiteral",symbols:[Pt.has("measurement")?{type:"measurement"}:measurement],postprocess:function(t){var e,n=function(t){var e=t.match(/(-?[0-9.]+)([a-zA-Z]+)/);if(null==e)throw Error("Malformed measurement : "+t);return{value:e[1],unit:e[2]}}(t[0].value);return e=n.unit,{type:"measurement",value:String(n.value),unit:e}}},{name:"_$ebnf$1",symbols:[Pt.has("whitespace")?{type:"whitespace"}:whitespace],postprocess:Mt},{name:"_$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"_",symbols:["_$ebnf$1"],postprocess:Ot},{name:"Comment",symbols:[Pt.has("lineComment")?{type:"lineComment"}:lineComment],postprocess:Ot},{name:"EOL",symbols:[{literal:"\n"}],postprocess:Ot}],ParserStart:"GramSeq"},Ct=function(t,e){var n,r,i=new $t.Parser($t.Grammar.fromCompiled(jt));try{var o=i.feed(t);if(void 0===o.results[0]&&o.lexerState){var a={line:(r=o.lexerState).line,column:r.col};e.fail("Incomplete parse.",a)}return o.results.length>1&&e.info("[WARN] parsing is ambiguous"),o.results[0]||{type:"error"}}catch(t){var s=t.token?{line:(n=t.token).line,column:n.col}:{line:0,column:0};e.fail(t.message,s)}},It=function(){this.Parser=Ct};let qt=t=>crypto.getRandomValues(new Uint8Array(t));function Lt(){return!0}var Rt=zt;function zt(t,e,n,r){var i,o;"function"==typeof e&&"function"!=typeof n&&(r=n,n=e,e=null),o=function t(e){if(null==e)return Lt;if("string"==typeof e)return function(t){return function(e){return Boolean(e&&e.type===t)}}(e);if("object"==typeof e)return"length"in e?function(e){for(var n=[],r=-1;++r<e.length;)n[r]=t(e[r]);return function(){for(var t=-1;++t<n.length;)if(n[t].apply(this,arguments))return!0;return!1}}(e):function(t){return function(e){var n;for(n in t)if(e[n]!==t[n])return!1;return!0}}(e);if("function"==typeof e)return e;throw new Error("Expected function, string, or object as test")}(e),i=r?-1:1,function t(a,s,u){var l,c="object"==typeof a&&null!==a?a:{};return"string"==typeof c.type&&(f.displayName="node ("+c.type+((l="string"==typeof c.tagName?c.tagName:"string"==typeof c.name?c.name:void 0)?"<"+l+">":"")+")"),f;function f(){var l,c,f=u.concat(a),h=[];if((!e||o(a,s,u[u.length-1]||null))&&!1===(h=function(t){return null!==t&&"object"==typeof t&&"length"in t?t:"number"==typeof t?[!0,t]:[t]}(n(a,u)))[0])return h;if(a.children&&"skip"!==h[0])for(c=(r?a.children.length:-1)+i;c>-1&&c<a.children.length;){if(!1===(l=t(a.children[c],c,f)())[0])return l;c="number"==typeof l[1]?l[1]:c+i}return h}}(t,null,[])()}zt.CONTINUE=!0,zt.SKIP="skip",zt.EXIT=!1;var Dt=Gt,Bt=Rt.SKIP,Vt=Rt.EXIT;function Gt(t,e,n,r){"function"==typeof e&&"function"!=typeof n&&(r=n,n=e,e=null),Rt(t,e,(function(t,e){var r=e[e.length-1],i=r?r.children.indexOf(t):null;return n(t,i,r)}),r)}function Ut(){return(Ut=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}Gt.CONTINUE=Rt.CONTINUE,Gt.SKIP=Bt,Gt.EXIT=Vt;var Xt={generator:"counter",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ",prefix:void 0};function Ft(){return(Ft=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function Ht(t){return(Ht=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qt(t,e){return(Qt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Yt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Zt(t,e,n){return(Zt=Yt()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&Qt(i,n.prototype),i}).apply(null,arguments)}function Kt(t){var e="function"==typeof Map?new Map:void 0;return(Kt=function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return Zt(t,arguments,Ht(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Qt(n,t)})(t)}var Jt=/^([+-]\d{4,}\b|\d{4})$/,Wt=/^([0-9]{4})-(1[0-2]|0[1-9])$/,te=/^([0-9]{4})(-?)(1[0-2]|0[1-9])\2(3[01]|0[1-9]|[12][0-9])$/,ee=/^(2[0-3]|[01][0-9]):?([0-5][0-9]):?([0-5][0-9](\.[0-9]{3})?)?(Z|([+-])((?:2[0-3]|[01][0-9]))(?::?([0-5][0-9]))?)?$/,ne=function(t){var e,n;function r(e){var n;return(n=t.call(this,"AST is invalid:"+JSON.stringify(e))||this).name="InvalidAstError",n.ast=e,n}return n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n,r}(Kt(Error)),re=function t(e,n){return void 0===n&&(n=ie),"object"==typeof(r=e)&&r instanceof Map?Array.from(e).reduce((function(e,n){return e[n[0]]=t(n[1]),e}),{}):function(t){return Array.isArray(t)&&f(t[0])}(e)?e.map((function(e){return t(e)})):f(e)?n(e):"object"==typeof e?Object.entries(e).reduce((function(e,n){return e[n[0]]=t(n[1]),e}),{}):void 0;var r},ie=function(t){switch(t.type){case"boolean":return oe(t);case"string":return ae(t);case"integer":return le(t);case"decimal":return ce(t);case"hexadecimal":return fe(t);case"octal":return he(t);case"tagged":switch(t.tag){case"date":return se(t);case"time":return ue(t);case"datetime":case"interval":case"duration":return"TODO";case"uri":return t.value;case"wkt":default:return"TODO"}case"measurement":return"measure by measure";default:return function(t){throw new Error("Unexpected object: "+t)}(t)}},oe=function(t){return t.value&&"true"===t.value.toLowerCase()},ae=function(t){if(t.value)return t.value;throw new ne(t)},se=function(t){if(t.value){var e=te.exec(t.value);if(e)return new Date(Date.UTC(Number.parseInt(e[1]),Number.parseInt(e[3])-1,Number.parseInt(e[4])));if(e=Wt.exec(t.value))return new Date(Date.UTC(Number.parseInt(e[1]),Number.parseInt(e[2])));if(e=Jt.exec(t.value))return new Date(Number.parseInt(e[1]),1);throw SyntaxError("Unable to parse date from "+t.value)}throw new ne(t)},ue=function(t){if(t.value){var e=ee.exec(t.value);if(e){var n=Number.parseInt(e[1]),r=e[1]?Number.parseInt(e[2]):0,i=e[3]?Number.parseFloat(e[3]):0,o=e[5],a=36e5*n+6e4*r+1e3*i;if(o){var s="Z"===o?0:36e5*Number.parseInt(e[7])+6e4*Number.parseInt(e[8]||"0");return new Date("-"===e[6]?a+s:a-s)}return new Date(a)}throw SyntaxError("Unable to parse time from "+t.value)}throw new ne(t)},le=function(t){if(t.value)return Number.parseInt(t.value);throw new ne(t)},ce=function(t){if(t.value)return Number.parseFloat(t.value);throw new ne(t)},fe=function(t){if(t.value)return Number.parseInt(t.value,16);throw new ne(t)},he=function(t){if(t.value)return Number.parseInt(t.value,8);throw new ne(t)},pe={literalValueEvaluator:ie},de={__proto__:null,plugins:[function(t){var e=Ut({},Xt,t);return function(t){var n,r,i;switch(e.generator){case"nanoid":n=function(t,e,n){void 0===t&&(t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_@"),void 0===e&&(e=21);var r=((t,e)=>((t,e,n)=>{let r=(2<<Math.log(t.length-1)/Math.LN2)-1,i=-~(1.6*r*e/t.length);return()=>{let o="";for(;;){let a=n(i),s=i;for(;s--;)if(o+=t[a[s]&r]||"",o.length===e)return o}}})(t,e,qt))(t,e);return{generate:function(){return n?n+r():r()}}}(e.alphabet,21,e.prefix);break;case"counter":default:r=e.prefix,i=0,n={generate:function(){return""+(r||"")+i++}}}Dt(t,(function(t){u(t)&&(t.id=t.id||n.generate())}))}},function(t){var e=Ft({},pe,t);return function(t){Dt(t,(function(t){u(t)&&t.record&&(t.data=Object.assign(t.data||{},{value:re(t.record,e.literalValueEvaluator)}))}))}}]};const ye=yt().use(It).use(de),ge=t=>t.data&&t.data.value?t.data.value:t.record?t.record:{},me=t=>c(t)?n(t.id,t.labels,ge(t)):n("random"),ve=t=>i((t=>"left"===t.kind?t.children[1].id||e:t.children[0].id||e)(t),(t=>"left"===t.kind?t.children[0].id||e:t.children[1].id||e)(t),t.id,t.labels,ge(t));var be={value:()=>{}};function we(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new _e(r)}function _e(t){this._=t}function xe(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function ke(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function Ee(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=be,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}_e.prototype=we.prototype={constructor:_e,on:function(t,e){var n,r=this._,i=xe(t+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(n=(t=i[o]).type)r[n]=Ee(r[n],t.name,e);else if(null==e)for(n in r)r[n]=Ee(r[n],t.name,null);return this}for(;++o<a;)if((n=(t=i[o]).type)&&(n=ke(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new _e(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var Se="http://www.w3.org/1999/xhtml",Ae={svg:"http://www.w3.org/2000/svg",xhtml:Se,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function $e(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),Ae.hasOwnProperty(e)?{space:Ae[e],local:t}:t}function Ne(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Se&&e.documentElement.namespaceURI===Se?e.createElement(t):e.createElementNS(n,t)}}function Me(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Pe(t){var e=$e(t);return(e.local?Me:Ne)(e)}function Oe(){}function Te(t){return null==t?Oe:function(){return this.querySelector(t)}}function je(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Ce(){return[]}function Ie(t){return null==t?Ce:function(){return this.querySelectorAll(t)}}function qe(t){return function(){return this.matches(t)}}function Le(t){return function(e){return e.matches(t)}}var Re=Array.prototype.find;function ze(){return this.firstElementChild}var De=Array.prototype.filter;function Be(){return this.children}function Ve(t){return new Array(t.length)}function Ge(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Ue(t){return function(){return t}}function Xe(t,e,n,r,i,o){for(var a,s=0,u=e.length,l=o.length;s<l;++s)(a=e[s])?(a.__data__=o[s],r[s]=a):n[s]=new Ge(t,o[s]);for(;s<u;++s)(a=e[s])&&(i[s]=a)}function Fe(t,e,n,r,i,o,a){var s,u,l,c=new Map,f=e.length,h=o.length,p=new Array(f);for(s=0;s<f;++s)(u=e[s])&&(p[s]=l=a.call(u,u.__data__,s,e)+"",c.has(l)?i[s]=u:c.set(l,u));for(s=0;s<h;++s)l=a.call(t,o[s],s,o)+"",(u=c.get(l))?(r[s]=u,u.__data__=o[s],c.delete(l)):n[s]=new Ge(t,o[s]);for(s=0;s<f;++s)(u=e[s])&&c.get(p[s])===u&&(i[s]=u)}function He(t){return t.__data__}function Qe(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Ye(t){return function(){this.removeAttribute(t)}}function Ze(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ke(t,e){return function(){this.setAttribute(t,e)}}function Je(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function We(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function tn(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function en(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function nn(t){return function(){this.style.removeProperty(t)}}function rn(t,e,n){return function(){this.style.setProperty(t,e,n)}}function on(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function an(t,e){return t.style.getPropertyValue(e)||en(t).getComputedStyle(t,null).getPropertyValue(e)}function sn(t){return function(){delete this[t]}}function un(t,e){return function(){this[t]=e}}function ln(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function cn(t){return t.trim().split(/^|\s+/)}function fn(t){return t.classList||new hn(t)}function hn(t){this._node=t,this._names=cn(t.getAttribute("class")||"")}function pn(t,e){for(var n=fn(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function dn(t,e){for(var n=fn(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function yn(t){return function(){pn(this,t)}}function gn(t){return function(){dn(this,t)}}function mn(t,e){return function(){(e.apply(this,arguments)?pn:dn)(this,t)}}function vn(){this.textContent=""}function bn(t){return function(){this.textContent=t}}function wn(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function _n(){this.innerHTML=""}function xn(t){return function(){this.innerHTML=t}}function kn(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function En(){this.nextSibling&&this.parentNode.appendChild(this)}function Sn(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function An(){return null}function $n(){var t=this.parentNode;t&&t.removeChild(this)}function Nn(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Mn(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Pn(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function On(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?e.length=i:delete this.__on}}}function Tn(t,e,n){return function(){var r,i=this.__on,o=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(i)for(var a=0,s=i.length;a<s;++a)if((r=i[a]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),void(r.value=e);this.addEventListener(t.type,o,n),r={type:t.type,name:t.name,value:e,listener:o,options:n},i?i.push(r):this.__on=[r]}}function jn(t,e,n){var r=en(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Cn(t,e){return function(){return jn(this,t,e)}}function In(t,e){return function(){return jn(this,t,e.apply(this,arguments))}}Ge.prototype={constructor:Ge,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},hn.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var qn=[null];function Ln(t,e){this._groups=t,this._parents=e}function Rn(){return new Ln([[document.documentElement]],qn)}function zn(t){return"string"==typeof t?new Ln([[document.querySelector(t)]],[document.documentElement]):new Ln([[t]],qn)}function Dn(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}function Bn(t){t.stopImmediatePropagation()}function Vn(t){t.preventDefault(),t.stopImmediatePropagation()}Ln.prototype=Rn.prototype={constructor:Ln,select:function(t){"function"!=typeof t&&(t=Te(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a,s=e[i],u=s.length,l=r[i]=new Array(u),c=0;c<u;++c)(o=s[c])&&(a=t.call(o,o.__data__,c,s))&&("__data__"in o&&(a.__data__=o.__data__),l[c]=a);return new Ln(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);return null==e?[]:je(e)}}(t):Ie(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var a,s=e[o],u=s.length,l=0;l<u;++l)(a=s[l])&&(r.push(t.call(a,a.__data__,l,s)),i.push(a));return new Ln(r,i)},selectChild:function(t){return this.select(null==t?ze:function(t){return function(){return Re.call(this.children,t)}}("function"==typeof t?t:Le(t)))},selectChildren:function(t){return this.selectAll(null==t?Be:function(t){return function(){return De.call(this.children,t)}}("function"==typeof t?t:Le(t)))},filter:function(t){"function"!=typeof t&&(t=qe(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,u=r[i]=[],l=0;l<s;++l)(o=a[l])&&t.call(o,o.__data__,l,a)&&u.push(o);return new Ln(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,He);var n=e?Fe:Xe,r=this._parents,i=this._groups;"function"!=typeof t&&(t=Ue(t));for(var o=i.length,a=new Array(o),s=new Array(o),u=new Array(o),l=0;l<o;++l){var c=r[l],f=i[l],h=f.length,p=je(t.call(c,c&&c.__data__,l,r)),d=p.length,y=s[l]=new Array(d),g=a[l]=new Array(d),m=u[l]=new Array(h);n(c,f,y,g,m,p,e);for(var v,b,w=0,_=0;w<d;++w)if(v=y[w]){for(w>=_&&(_=w+1);!(b=g[_])&&++_<d;);v._next=b||null}}return(a=new Ln(a,r))._enter=s,a._exit=u,a},enter:function(){return new Ln(this._enter||this._groups.map(Ve),this._parents)},exit:function(){return new Ln(this._exit||this._groups.map(Ve),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,o=this.exit();return r="function"==typeof t?t(r):r.append(t+""),null!=e&&(i=e(i)),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(t){if(!(t instanceof Ln))throw new Error("invalid merge");for(var e=this._groups,n=t._groups,r=e.length,i=Math.min(r,n.length),o=new Array(r),a=0;a<i;++a)for(var s,u=e[a],l=n[a],c=u.length,f=o[a]=new Array(c),h=0;h<c;++h)(s=u[h]||l[h])&&(f[h]=s);for(;a<r;++a)o[a]=e[a];return new Ln(o,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=Qe);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,s=n[o],u=s.length,l=i[o]=new Array(u),c=0;c<u;++c)(a=s[c])&&(l[c]=a);l.sort(e)}return new Ln(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],a=0,s=o.length;a<s;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,e){var n=$e(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?Ze:Ye:"function"==typeof e?n.local?tn:We:n.local?Je:Ke)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?nn:"function"==typeof e?on:rn)(t,e,null==n?"":n)):an(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?sn:"function"==typeof e?ln:un)(t,e)):this.node()[t]},classed:function(t,e){var n=cn(t+"");if(arguments.length<2){for(var r=fn(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?mn:e?yn:gn)(n,e))},text:function(t){return arguments.length?this.each(null==t?vn:("function"==typeof t?wn:bn)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?_n:("function"==typeof t?kn:xn)(t)):this.node().innerHTML},raise:function(){return this.each(En)},lower:function(){return this.each(Sn)},append:function(t){var e="function"==typeof t?t:Pe(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:Pe(t),r=null==e?An:"function"==typeof e?e:Te(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each($n)},clone:function(t){return this.select(t?Mn:Nn)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=Pn(t+""),a=o.length;if(!(arguments.length<2)){for(s=e?Tn:On,r=0;r<a;++r)this.each(s(o[r],e,n));return this}var s=this.node().__on;if(s)for(var u,l=0,c=s.length;l<c;++l)for(r=0,u=s[l];r<a;++r)if((i=o[r]).type===u.type&&i.name===u.name)return u.value},dispatch:function(t,e){return this.each(("function"==typeof e?In:Cn)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,i=t[e],o=0,a=i.length;o<a;++o)(r=i[o])&&(yield r)}};var Gn=t=>()=>t;function Un(t,{sourceEvent:e,subject:n,target:r,identifier:i,active:o,x:a,y:s,dx:u,dy:l,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:u,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:c}})}function Xn(t){return!t.ctrlKey&&!t.button}function Fn(){return this.parentNode}function Hn(t,e){return null==e?{x:t.x,y:t.y}:e}function Qn(){return navigator.maxTouchPoints||"ontouchstart"in this}function Yn(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Zn(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Kn(){}Un.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var Jn="\\s*([+-]?\\d+)\\s*",Wn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",tr="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",er=/^#([0-9a-f]{3,8})$/,nr=new RegExp("^rgb\\("+[Jn,Jn,Jn]+"\\)$"),rr=new RegExp("^rgb\\("+[tr,tr,tr]+"\\)$"),ir=new RegExp("^rgba\\("+[Jn,Jn,Jn,Wn]+"\\)$"),or=new RegExp("^rgba\\("+[tr,tr,tr,Wn]+"\\)$"),ar=new RegExp("^hsl\\("+[Wn,tr,tr]+"\\)$"),sr=new RegExp("^hsla\\("+[Wn,tr,tr,Wn]+"\\)$"),ur={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function lr(){return this.rgb().formatHex()}function cr(){return this.rgb().formatRgb()}function fr(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=er.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?hr(e):3===n?new gr(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?pr(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?pr(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=nr.exec(t))?new gr(e[1],e[2],e[3],1):(e=rr.exec(t))?new gr(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=ir.exec(t))?pr(e[1],e[2],e[3],e[4]):(e=or.exec(t))?pr(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=ar.exec(t))?wr(e[1],e[2]/100,e[3]/100,1):(e=sr.exec(t))?wr(e[1],e[2]/100,e[3]/100,e[4]):ur.hasOwnProperty(t)?hr(ur[t]):"transparent"===t?new gr(NaN,NaN,NaN,0):null}function hr(t){return new gr(t>>16&255,t>>8&255,255&t,1)}function pr(t,e,n,r){return r<=0&&(t=e=n=NaN),new gr(t,e,n,r)}function dr(t){return t instanceof Kn||(t=fr(t)),t?new gr((t=t.rgb()).r,t.g,t.b,t.opacity):new gr}function yr(t,e,n,r){return 1===arguments.length?dr(t):new gr(t,e,n,null==r?1:r)}function gr(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function mr(){return"#"+br(this.r)+br(this.g)+br(this.b)}function vr(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function br(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function wr(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new xr(t,e,n,r)}function _r(t){if(t instanceof xr)return new xr(t.h,t.s,t.l,t.opacity);if(t instanceof Kn||(t=fr(t)),!t)return new xr;if(t instanceof xr)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new xr(a,s,u,t.opacity)}function xr(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function kr(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}Yn(Kn,fr,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:lr,formatHex:lr,formatHsl:function(){return _r(this).formatHsl()},formatRgb:cr,toString:cr}),Yn(gr,yr,Zn(Kn,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new gr(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new gr(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:mr,formatHex:mr,formatRgb:vr,toString:vr})),Yn(xr,(function(t,e,n,r){return 1===arguments.length?_r(t):new xr(t,e,n,null==r?1:r)}),Zn(Kn,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new xr(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new xr(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new gr(kr(t>=240?t-240:t+120,i,r),kr(t,i,r),kr(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Er=t=>()=>t;function Sr(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):Er(isNaN(t)?e:t)}var Ar=function t(e){var n=function(t){return 1==(t=+t)?Sr:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Er(isNaN(e)?n:e)}}(e);function r(t,e){var r=n((t=yr(t)).r,(e=yr(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=Sr(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function $r(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var Nr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Mr=new RegExp(Nr.source,"g");function Pr(t,e){var n,r,i,o=Nr.lastIndex=Mr.lastIndex=0,a=-1,s=[],u=[];for(t+="",e+="";(n=Nr.exec(t))&&(r=Mr.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:$r(n,r)})),o=Mr.lastIndex;return o<e.length&&(i=e.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?function(t){return function(e){return t(e)+""}}(u[0].x):function(t){return function(){return t}}(e):(e=u.length,function(t){for(var n,r=0;r<e;++r)s[(n=u[r]).i]=n.x(t);return s.join("")})}var Or,Tr=180/Math.PI,jr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Cr(t,e,n,r,i,o){var a,s,u;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),t*r<e*n&&(t=-t,e=-e,u=-u,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*Tr,skewX:Math.atan(u)*Tr,scaleX:a,scaleY:s}}function Ir(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var s=[],u=[];return o=t(o),a=t(a),function(t,r,i,o,a,s){if(t!==i||r!==o){var u=a.push("translate(",null,e,null,n);s.push({i:u-4,x:$r(t,i)},{i:u-2,x:$r(r,o)})}else(i||o)&&a.push("translate("+i+e+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,u),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:$r(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,a.rotate,s,u),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:$r(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,a.skewX,s,u),function(t,e,n,r,o,a){if(t!==n||e!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:$r(t,n)},{i:s-2,x:$r(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,u),o=a=null,function(t){for(var e,n=-1,r=u.length;++n<r;)s[(e=u[n]).i]=e.x(t);return s.join("")}}}var qr,Lr,Rr=Ir((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?jr:Cr(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),zr=Ir((function(t){return null==t?jr:(Or||(Or=document.createElementNS("http://www.w3.org/2000/svg","g")),Or.setAttribute("transform",t),(t=Or.transform.baseVal.consolidate())?Cr((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):jr)}),", ",")",")"),Dr=0,Br=0,Vr=0,Gr=0,Ur=0,Xr=0,Fr="object"==typeof performance&&performance.now?performance:Date,Hr="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Qr(){return Ur||(Hr(Yr),Ur=Fr.now()+Xr)}function Yr(){Ur=0}function Zr(){this._call=this._time=this._next=null}function Kr(t,e,n){var r=new Zr;return r.restart(t,e,n),r}function Jr(){Ur=(Gr=Fr.now())+Xr,Dr=Br=0;try{!function(){Qr(),++Dr;for(var t,e=qr;e;)(t=Ur-e._time)>=0&&e._call.call(null,t),e=e._next;--Dr}()}finally{Dr=0,function(){for(var t,e,n=qr,r=Infinity;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:qr=e);Lr=t,ti(r)}(),Ur=0}}function Wr(){var t=Fr.now(),e=t-Gr;e>1e3&&(Xr-=e,Gr=t)}function ti(t){Dr||(Br&&(Br=clearTimeout(Br)),t-Ur>24?(t<Infinity&&(Br=setTimeout(Jr,t-Fr.now()-Xr)),Vr&&(Vr=clearInterval(Vr))):(Vr||(Gr=Fr.now(),Vr=setInterval(Wr,1e3)),Dr=1,Hr(Jr)))}function ei(t,e,n){var r=new Zr;return r.restart(n=>{r.stop(),t(n+e)},e=null==e?0:+e,n),r}Zr.prototype=Kr.prototype={constructor:Zr,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Qr():+n)+(null==e?0:+e),this._next||Lr===this||(Lr?Lr._next=this:qr=this,Lr=this),this._call=t,this._time=n,ti()},stop:function(){this._call&&(this._call=null,this._time=Infinity,ti())}};var ni=we("start","end","cancel","interrupt"),ri=[];function ii(t,e,n,r,i,o){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function o(u){var l,c,f,h;if(1!==n.state)return s();for(l in i)if((h=i[l]).name===n.name){if(3===h.state)return ei(o);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete i[l]):+l<e&&(h.state=6,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete i[l])}if(ei((function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(u))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(f=n.tween.length),l=0,c=-1;l<f;++l)(h=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(r[++c]=h);r.length=c+1}}function a(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(s),n.state=5,1),o=-1,a=r.length;++o<a;)r[o].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),s())}function s(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=Kr((function(t){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}),0,n.time)}(t,n,{name:e,index:r,group:i,on:ni,tween:ri,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function oi(t,e){var n=si(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function ai(t,e){var n=si(t,e);if(n.state>3)throw new Error("too late; already running");return n}function si(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function ui(t,e){var n,r;return function(){var i=ai(this,t),o=i.tween;if(o!==n)for(var a=0,s=(r=n=o).length;a<s;++a)if(r[a].name===e){(r=r.slice()).splice(a,1);break}i.tween=r}}function li(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=ai(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:e,value:n},u=0,l=i.length;u<l;++u)if(i[u].name===e){i[u]=s;break}u===l&&i.push(s)}o.tween=i}}function ci(t,e,n){var r=t._id;return t.each((function(){var t=ai(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return si(t,r).value[e]}}function fi(t,e){var n;return("number"==typeof e?$r:e instanceof fr?Ar:(n=fr(e))?(e=n,Ar):Pr)(t,e)}function hi(t){return function(){this.removeAttribute(t)}}function pi(t){return function(){this.removeAttributeNS(t.space,t.local)}}function di(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttribute(t);return a===o?null:a===r?i:i=e(r=a,n)}}function yi(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===r?i:i=e(r=a,n)}}function gi(t,e,n){var r,i,o;return function(){var a,s,u=n(this);if(null!=u)return(a=this.getAttribute(t))===(s=u+"")?null:a===r&&s===i?o:(i=s,o=e(r=a,u));this.removeAttribute(t)}}function mi(t,e,n){var r,i,o;return function(){var a,s,u=n(this);if(null!=u)return(a=this.getAttributeNS(t.space,t.local))===(s=u+"")?null:a===r&&s===i?o:(i=s,o=e(r=a,u));this.removeAttributeNS(t.space,t.local)}}function vi(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function bi(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function wi(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&bi(t,i)),n}return i._value=e,i}function _i(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&vi(t,i)),n}return i._value=e,i}function xi(t,e){return function(){oi(this,t).delay=+e.apply(this,arguments)}}function ki(t,e){return e=+e,function(){oi(this,t).delay=e}}function Ei(t,e){return function(){ai(this,t).duration=+e.apply(this,arguments)}}function Si(t,e){return e=+e,function(){ai(this,t).duration=e}}function Ai(t,e){if("function"!=typeof e)throw new Error;return function(){ai(this,t).ease=e}}function $i(t,e,n){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?oi:ai;return function(){var a=o(this,t),s=a.on;s!==r&&(i=(r=s).copy()).on(e,n),a.on=i}}var Ni=Rn.prototype.constructor;function Mi(t){return function(){this.style.removeProperty(t)}}function Pi(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Oi(t,e,n){var r,i;function o(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&Pi(t,o,n)),r}return o._value=e,o}function Ti(t){return function(e){this.textContent=t.call(this,e)}}function ji(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&Ti(r)),e}return r._value=t,r}var Ci=0;function Ii(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function qi(){return++Ci}var Li=Rn.prototype;Ii.prototype=function(t){return Rn().transition(t)}.prototype={constructor:Ii,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Te(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s,u,l=r[a],c=l.length,f=o[a]=new Array(c),h=0;h<c;++h)(s=l[h])&&(u=t.call(s,s.__data__,h,l))&&("__data__"in s&&(u.__data__=s.__data__),f[h]=u,ii(f[h],e,n,h,f,si(s,n)));return new Ii(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Ie(t));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var u,l=r[s],c=l.length,f=0;f<c;++f)if(u=l[f]){for(var h,p=t.call(u,u.__data__,f,l),d=si(u,n),y=0,g=p.length;y<g;++y)(h=p[y])&&ii(h,e,n,y,p,d);o.push(p),a.push(u)}return new Ii(o,a,e,n)},filter:function(t){"function"!=typeof t&&(t=qe(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,u=r[i]=[],l=0;l<s;++l)(o=a[l])&&t.call(o,o.__data__,l,a)&&u.push(o);return new Ii(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=Math.min(r,n.length),o=new Array(r),a=0;a<i;++a)for(var s,u=e[a],l=n[a],c=u.length,f=o[a]=new Array(c),h=0;h<c;++h)(s=u[h]||l[h])&&(f[h]=s);for(;a<r;++a)o[a]=e[a];return new Ii(o,this._parents,this._name,this._id)},selection:function(){return new Ni(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=qi(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],u=s.length,l=0;l<u;++l)if(a=s[l]){var c=si(a,e);ii(a,t,n,l,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Ii(r,this._parents,t,n)},call:Li.call,nodes:Li.nodes,node:Li.node,size:Li.size,empty:Li.empty,each:Li.each,on:function(t,e){var n=this._id;return arguments.length<2?si(this.node(),n).on.on(t):this.each($i(n,t,e))},attr:function(t,e){var n=$e(t),r="transform"===n?zr:fi;return this.attrTween(t,"function"==typeof e?(n.local?mi:gi)(n,r,ci(this,"attr."+t,e)):null==e?(n.local?pi:hi)(n):(n.local?yi:di)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=$e(t);return this.tween(n,(r.local?wi:_i)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?Rr:fi;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var o=an(this,t),a=(this.style.removeProperty(t),an(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}(t,r)).on("end.style."+t,Mi(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,o;return function(){var a=an(this,t),s=n(this),u=s+"";return null==s&&(this.style.removeProperty(t),u=s=an(this,t)),a===u?null:a===r&&u===i?o:(i=u,o=e(r=a,s))}}(t,r,ci(this,"style."+t,e))).each(function(t,e){var n,r,i,o,a="style."+e,s="end."+a;return function(){var u=ai(this,t),l=u.on,c=null==u.value[a]?o||(o=Mi(e)):void 0;l===n&&i===c||(r=(n=l).copy()).on(s,i=c),u.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,o=n+"";return function(){var a=an(this,t);return a===o?null:a===r?i:i=e(r=a,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,Oi(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(ci(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,ji(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=si(this.node(),n).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?ui:li)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?xi:ki)(e,t)):si(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Ei:Si)(e,t)):si(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(Ai(e,t)):si(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;ai(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(o,a){var s={value:a},u={value:function(){0==--i&&o()}};n.each((function(){var n=ai(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(u)),n.on=e})),0===i&&o()}))},[Symbol.iterator]:Li[Symbol.iterator]};var Ri={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function zi(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}Rn.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,r,i,o=t.__transition,a=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[i]):a=!1;a&&delete t.__transition}}(this,t)}))},Rn.prototype.transition=function(t){var e,n;t instanceof Ii?(e=t._id,t=t._name):(e=qi(),(n=Ri).time=Qr(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],u=s.length,l=0;l<u;++l)(a=s[l])&&ii(a,t,e,l,s,n||zi(a,e));return new Ii(r,this._parents,t,e)};const Di=Math.PI,Bi=2*Di,Vi=Bi-1e-6;function Gi(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Ui(){return new Gi}function Xi(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o,a,s,u,l,c,f,h,p=t._root,d={data:r},y=t._x0,g=t._y0,m=t._x1,v=t._y1;if(!p)return t._root=d,t;for(;p.length;)if((l=e>=(o=(y+m)/2))?y=o:m=o,(c=n>=(a=(g+v)/2))?g=a:v=a,i=p,!(p=p[f=c<<1|l]))return i[f]=d,t;if(s=+t._x.call(null,p.data),u=+t._y.call(null,p.data),e===s&&n===u)return d.next=p,i?i[f]=d:t._root=d,t;do{i=i?i[f]=new Array(4):t._root=new Array(4),(l=e>=(o=(y+m)/2))?y=o:m=o,(c=n>=(a=(g+v)/2))?g=a:v=a}while((f=c<<1|l)==(h=(u>=a)<<1|s>=o));return i[h]=p,i[f]=d,t}function Fi(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function Hi(t){return t[0]}function Qi(t){return t[1]}function Yi(t,e,n){var r=new Zi(null==e?Hi:e,null==n?Qi:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function Zi(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function Ki(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}Gi.prototype=Ui.prototype={constructor:Gi,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,e,n,r,i){var o=this._x1,a=this._y1,s=(n=+n)-(t=+t),u=(r=+r)-(e=+e),l=o-t,c=a-e,f=l*l+c*c;if((i=+i)<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(f>1e-6)if(Math.abs(c*s-u*l)>1e-6&&i){var h=n-o,p=r-a,d=s*s+u*u,y=h*h+p*p,g=Math.sqrt(d),m=Math.sqrt(f),v=i*Math.tan((Di-Math.acos((d+f-y)/(2*g*m)))/2),b=v/m,w=v/g;Math.abs(b-1)>1e-6&&(this._+="L"+(t+b*l)+","+(e+b*c)),this._+="A"+i+","+i+",0,0,"+ +(c*h>l*p)+","+(this._x1=t+w*s)+","+(this._y1=e+w*u)}else this._+="L"+(this._x1=t)+","+(this._y1=e)},arc:function(t,e,n,r,i,o){t=+t,e=+e,o=!!o;var a=(n=+n)*Math.cos(r),s=n*Math.sin(r),u=t+a,l=e+s,c=1^o,f=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+l:(Math.abs(this._x1-u)>1e-6||Math.abs(this._y1-l)>1e-6)&&(this._+="L"+u+","+l),n&&(f<0&&(f=f%Bi+Bi),f>Vi?this._+="A"+n+","+n+",0,1,"+c+","+(t-a)+","+(e-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):f>1e-6&&(this._+="A"+n+","+n+",0,"+ +(f>=Di)+","+c+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var Ji=Yi.prototype=Zi.prototype;function Wi(t){return function(){return t}}function to(t){return 1e-6*(t()-.5)}function eo(t){return t.x+t.vx}function no(t){return t.y+t.vy}function ro(t){return t.index}function io(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}Ji.copy=function(){var t,e,n=new Zi(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=Ki(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=Ki(e));return n},Ji.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return Xi(this.cover(e,n),e,n,t)},Ji.addAll=function(t){var e,n,r,i,o=t.length,a=new Array(o),s=new Array(o),u=Infinity,l=Infinity,c=-Infinity,f=-Infinity;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(a[n]=r,s[n]=i,r<u&&(u=r),r>c&&(c=r),i<l&&(l=i),i>f&&(f=i));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<o;++n)Xi(this,a[n],s[n],t[n]);return this},Ji.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{for(var a,s,u=i-n||1,l=this._root;n>t||t>=i||r>e||e>=o;)switch(s=(e<r)<<1|t<n,(a=new Array(4))[s]=l,l=a,u*=2,s){case 0:i=n+u,o=r+u;break;case 1:n=i-u,o=r+u;break;case 2:i=n+u,r=o-u;break;case 3:n=i-u,r=o-u}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},Ji.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},Ji.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Ji.find=function(t,e,n){var r,i,o,a,s,u,l,c=this._x0,f=this._y0,h=this._x1,p=this._y1,d=[],y=this._root;for(y&&d.push(new Fi(y,c,f,h,p)),null==n?n=Infinity:(c=t-n,f=e-n,h=t+n,p=e+n,n*=n);u=d.pop();)if(!(!(y=u.node)||(i=u.x0)>h||(o=u.y0)>p||(a=u.x1)<c||(s=u.y1)<f))if(y.length){var g=(i+a)/2,m=(o+s)/2;d.push(new Fi(y[3],g,m,a,s),new Fi(y[2],i,m,g,s),new Fi(y[1],g,o,a,m),new Fi(y[0],i,o,g,m)),(l=(e>=m)<<1|t>=g)&&(u=d[d.length-1],d[d.length-1]=d[d.length-1-l],d[d.length-1-l]=u)}else{var v=t-+this._x.call(null,y.data),b=e-+this._y.call(null,y.data),w=v*v+b*b;if(w<n){var _=Math.sqrt(n=w);c=t-_,f=e-_,h=t+_,p=e+_,r=y.data}}return r},Ji.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,n,r,i,o,a,s,u,l,c,f,h,p=this._root,d=this._x0,y=this._y0,g=this._x1,m=this._y1;if(!p)return this;if(p.length)for(;;){if((l=o>=(s=(d+g)/2))?d=s:g=s,(c=a>=(u=(y+m)/2))?y=u:m=u,e=p,!(p=p[f=c<<1|l]))return this;if(!p.length)break;(e[f+1&3]||e[f+2&3]||e[f+3&3])&&(n=e,h=f)}for(;p.data!==t;)if(r=p,!(p=p.next))return this;return(i=p.next)&&delete p.next,r?(i?r.next=i:delete r.next,this):e?(i?e[f]=i:delete e[f],(p=e[0]||e[1]||e[2]||e[3])&&p===(e[3]||e[2]||e[1]||e[0])&&!p.length&&(n?n[h]=p:this._root=p),this):(this._root=i,this)},Ji.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},Ji.root=function(){return this._root},Ji.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},Ji.visit=function(t){var e,n,r,i,o,a,s=[],u=this._root;for(u&&s.push(new Fi(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,r=e.x0,i=e.y0,o=e.x1,a=e.y1)&&u.length){var l=(r+o)/2,c=(i+a)/2;(n=u[3])&&s.push(new Fi(n,l,c,o,a)),(n=u[2])&&s.push(new Fi(n,r,c,l,a)),(n=u[1])&&s.push(new Fi(n,l,i,o,c)),(n=u[0])&&s.push(new Fi(n,r,i,l,c))}return this},Ji.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new Fi(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var o,a=e.x0,s=e.y0,u=e.x1,l=e.y1,c=(a+u)/2,f=(s+l)/2;(o=i[0])&&n.push(new Fi(o,a,s,c,f)),(o=i[1])&&n.push(new Fi(o,c,s,u,f)),(o=i[2])&&n.push(new Fi(o,a,f,c,l)),(o=i[3])&&n.push(new Fi(o,c,f,u,l))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},Ji.x=function(t){return arguments.length?(this._x=t,this):this._x},Ji.y=function(t){return arguments.length?(this._y=t,this):this._y};const oo=4294967296;function ao(t){return t.x}function so(t){return t.y}var uo=Math.PI*(3-Math.sqrt(5));function lo(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}const co=Symbol("implicit");function fo(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-14825.05*t)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+707.56*t)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-6838.66*t)))))))+")"}function ho(t){return function(){return t}}var po=Math.PI,yo=2*po,go={draw:function(t,e){var n=Math.sqrt(e/po);t.moveTo(n,0),t.arc(0,0,n,0,yo)}},mo={draw:function(t,e){var n=Math.sqrt(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},vo=Math.sqrt(1/3),bo=2*vo,wo={draw:function(t,e){var n=Math.sqrt(e/bo),r=n*vo;t.moveTo(0,-n),t.lineTo(r,0),t.lineTo(0,n),t.lineTo(-r,0),t.closePath()}},_o=Math.sin(po/10)/Math.sin(7*po/10),xo=Math.sin(yo/10)*_o,ko=-Math.cos(yo/10)*_o,Eo={draw:function(t,e){var n=Math.sqrt(.8908130915292852*e),r=xo*n,i=ko*n;t.moveTo(0,-n),t.lineTo(r,i);for(var o=1;o<5;++o){var a=yo*o/5,s=Math.cos(a),u=Math.sin(a);t.lineTo(u*n,-s*n),t.lineTo(s*r-u*i,u*r+s*i)}t.closePath()}},So={draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},Ao=Math.sqrt(3),$o={draw:function(t,e){var n=-Math.sqrt(e/(3*Ao));t.moveTo(0,2*n),t.lineTo(-Ao*n,-n),t.lineTo(Ao*n,-n),t.closePath()}},No=-.5,Mo=Math.sqrt(3)/2,Po=1/Math.sqrt(12),Oo=3*(Po/2+1),To={draw:function(t,e){var n=Math.sqrt(e/Oo),r=n/2,i=n*Po,o=r,a=n*Po+n,s=-o,u=a;t.moveTo(r,i),t.lineTo(o,a),t.lineTo(s,u),t.lineTo(No*r-Mo*i,Mo*r+No*i),t.lineTo(No*o-Mo*a,Mo*o+No*a),t.lineTo(No*s-Mo*u,Mo*s+No*u),t.lineTo(No*r+Mo*i,No*i-Mo*r),t.lineTo(No*o+Mo*a,No*a-Mo*o),t.lineTo(No*s+Mo*u,No*u-Mo*s),t.closePath()}};function jo(t,e){var n=null;function r(){var r;if(n||(n=r=Ui()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),r)return n=null,r+""||null}return t="function"==typeof t?t:ho(t||go),e="function"==typeof e?e:ho(void 0===e?64:+e),r.type=function(e){return arguments.length?(t="function"==typeof e?e:ho(e),r):t},r.size=function(t){return arguments.length?(e="function"==typeof t?t:ho(+t),r):e},r.context=function(t){return arguments.length?(n=null==t?null:t,r):n},r}const Co={width:1200,height:800,ticks:300},Io=t=>{t.attr("x1",t=>r(t.source)?t.source.x:0).attr("y1",t=>r(t.source)?t.source.y:0).attr("x2",t=>r(t.target)?t.target.x:0).attr("y2",t=>r(t.target)?t.target.y:0)},qo=t=>{t.attr("transform",(function(t){return"translate("+t.x+","+t.y+")"}))},Lo={shapeRadius:2};t.MISSING_ID=e,t.dataFromPath=ge,t.drag=t=>function(){var t,e,n,r,i=Xn,o=Fn,a=Hn,s=Qn,u={},l=we("start","drag","end"),c=0,f=0;function h(t){t.on("mousedown.drag",p).filter(s).on("touchstart.drag",g).on("touchmove.drag",m).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(a,s){if(!r&&i.call(this,a,s)){var u=b(this,o.call(this,a,s),a,s,"mouse");u&&(zn(a.view).on("mousemove.drag",d,!0).on("mouseup.drag",y,!0),function(t){var e=t.document.documentElement,n=zn(t).on("dragstart.drag",Vn,!0);"onselectstart"in e?n.on("selectstart.drag",Vn,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}(a.view),Bn(a),n=!1,t=a.clientX,e=a.clientY,u("start",a))}}function d(r){if(Vn(r),!n){var i=r.clientX-t,o=r.clientY-e;n=i*i+o*o>f}u.mouse("drag",r)}function y(t){zn(t.view).on("mousemove.drag mouseup.drag",null),function(t,e){var n=t.document.documentElement,r=zn(t).on("dragstart.drag",null);e&&(r.on("click.drag",Vn,!0),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}(t.view,n),Vn(t),u.mouse("end",t)}function g(t,e){if(i.call(this,t,e)){var n,r,a=t.changedTouches,s=o.call(this,t,e),u=a.length;for(n=0;n<u;++n)(r=b(this,s,t,e,a[n].identifier,a[n]))&&(Bn(t),r("start",t,a[n]))}}function m(t){var e,n,r=t.changedTouches,i=r.length;for(e=0;e<i;++e)(n=u[r[e].identifier])&&(Vn(t),n("drag",t,r[e]))}function v(t){var e,n,i=t.changedTouches,o=i.length;for(r&&clearTimeout(r),r=setTimeout((function(){r=null}),500),e=0;e<o;++e)(n=u[i[e].identifier])&&(Bn(t),n("end",t,i[e]))}function b(t,e,n,r,i,o){var s,f,p,d=l.copy(),y=Dn(o||n,e);if(null!=(p=a.call(t,new Un("beforestart",{sourceEvent:n,target:h,identifier:i,active:c,x:y[0],y:y[1],dx:0,dy:0,dispatch:d}),r)))return s=p.x-y[0]||0,f=p.y-y[1]||0,function n(o,a,l){var g,m=y;switch(o){case"start":u[i]=n,g=c++;break;case"end":delete u[i],--c;case"drag":y=Dn(l||a,e),g=c}d.call(o,t,new Un(o,{sourceEvent:a,subject:p,target:h,identifier:i,active:g,x:y[0]+s,y:y[1]+f,dx:y[0]-m[0],dy:y[1]-m[1],dispatch:d}),r)}}return h.filter=function(t){return arguments.length?(i="function"==typeof t?t:Gn(!!t),h):i},h.container=function(t){return arguments.length?(o="function"==typeof t?t:Gn(t),h):o},h.subject=function(t){return arguments.length?(a="function"==typeof t?t:Gn(t),h):a},h.touchable=function(t){return arguments.length?(s="function"==typeof t?t:Gn(!!t),h):s},h.on=function(){var t=l.on.apply(l,arguments);return t===l?h:t},h.clickDistance=function(t){return arguments.length?(f=(t=+t)*t,h):Math.sqrt(f)},h}().on("start",(function(e){e.active||t.alphaTarget(.3).restart(),e.subject.fx=e.subject.x,e.subject.fy=e.subject.y})).on("drag",(function(t){t.subject.fx=t.x,t.subject.fy=t.y})).on("end",(function(e){e.active||t.alphaTarget(0),e.subject.fx=null,e.subject.fy=null})),t.draw=(t,e,n={})=>{const r=(t=>{const e=Math.PI*t*t,n=new Map([["Person","square"],["Triangle","triangle"],["Movie","star"],["Event","wye"]]),r=new Map([["circle",jo().type(go).size(e)()],["square",jo().type(So).size(e)()],["triangle",jo().type($o).size(e)()],["cross",jo().type(mo).size(e)()],["diamond",jo().type(wo).size(e)()],["star",jo().type(Eo).size(e)()],["wye",jo().type(To).size(e)()]]);return t=>{const e=void 0!==t.labels&&n.get(t.labels[0])||"circle";return r.get(e)||""}})(Object.assign(Lo,n).shapeRadius),i=(t=>{const e=(t=>Array.from(t.nodes.reduce((t,e)=>(e.labels.forEach(e=>t.add(e)),t),new Set).values()))(t),n=function t(){var e=new Map,n=[],r=[],i=co;function o(t){var o=t+"",a=e.get(o);if(!a){if(i!==co)return i;e.set(o,a=n.push(t))}return r[(a-1)%r.length]}return o.domain=function(t){if(!arguments.length)return n.slice();n=[],e=new Map;for(const r of t){const t=r+"";e.has(t)||e.set(t,n.push(r))}return o},o.range=function(t){return arguments.length?(r=Array.from(t),o):r.slice()},o.unknown=function(t){return arguments.length?(i=t,o):i},o.copy=function(){return t(n,r).unknown(i)},lo.apply(o,arguments),o}(((t,e)=>{var n=[];for(let r=1;r<=t;r++)n.push(e(r/t));return n})(e?e.length+1:1,fo));return t=>n(t.labels[0])})(t),o=zn(e);let a=o.append("g").attr("stroke","#999").attr("stroke-opacity",.6).selectAll("line").data(t.links).join("line").attr("stroke-width",2),s=o.append("g").attr("class","nodes").selectAll("g").data(t.nodes).enter().append("g");return s.append("path").attr("fill",i).attr("stroke",t=>(fr(i(t))||yr(51,51,51)).darker().hex()).attr("stroke-width",4).attr("d",r),s.append("title").text((function(t){return t.id})),qo(s),Io(a),{nodeSelection:s,linkSelection:a}},t.edgeToD3=ve,t.isGramNodeDatum=r,t.layout=(t,e={})=>{const n=Object.assign(Co,e);let r=(i={x:n.width/2,y:n.height/2},function(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=new Map,u=Kr(f),l=we("tick","end"),c=function(){let t=1;return()=>(t=(1664525*t+1013904223)%oo)/oo}();function f(){h(),l.call("tick",e),n<r&&(u.stop(),l.call("end",e))}function h(r){var u,l,c=t.length;void 0===r&&(r=1);for(var f=0;f<r;++f)for(n+=(o-n)*i,s.forEach((function(t){t(n)})),u=0;u<c;++u)null==(l=t[u]).fx?l.x+=l.vx*=a:(l.x=l.fx,l.vx=0),null==l.fy?l.y+=l.vy*=a:(l.y=l.fy,l.vy=0);return e}function p(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=10*Math.sqrt(.5+n),o=n*uo;e.x=i*Math.cos(o),e.y=i*Math.sin(o)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function d(e){return e.initialize&&e.initialize(t,c),e}return null==t&&(t=[]),p(),e={tick:h,restart:function(){return u.restart(f),e},stop:function(){return u.stop(),e},nodes:function(n){return arguments.length?(t=n,p(),s.forEach(d),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(o=+t,e):o},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(c=t,s.forEach(d),e):c},force:function(t,n){return arguments.length>1?(null==n?s.delete(t):s.set(t,d(n)),e):s.get(t)},find:function(e,n,r){var i,o,a,s,u,l=0,c=t.length;for(null==r?r=Infinity:r*=r,l=0;l<c;++l)(a=(i=e-(s=t[l]).x)*i+(o=n-s.y)*o)<r&&(u=s,r=a);return u},on:function(t,n){return arguments.length>1?(l.on(t,n),e):l.on(t)}}}().force("charge",function(){var t,e,n,r,i,o=Wi(-30),a=1,s=Infinity,u=.81;function l(n){var i,o=t.length,a=Yi(t,ao,so).visitAfter(f);for(r=n,i=0;i<o;++i)e=t[i],a.visit(h)}function c(){if(t){var e,n,r=t.length;for(i=new Array(r),e=0;e<r;++e)i[(n=t[e]).index]=+o(n,e,t)}}function f(t){var e,n,r,o,a,s=0,u=0;if(t.length){for(r=o=a=0;a<4;++a)(e=t[a])&&(n=Math.abs(e.value))&&(s+=e.value,u+=n,r+=n*e.x,o+=n*e.y);t.x=r/u,t.y=o/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=i[e.data.index]}while(e=e.next)}t.value=s}function h(t,o,l,c){if(!t.value)return!0;var f=t.x-e.x,h=t.y-e.y,p=c-o,d=f*f+h*h;if(p*p/u<d)return d<s&&(0===f&&(d+=(f=to(n))*f),0===h&&(d+=(h=to(n))*h),d<a&&(d=Math.sqrt(a*d)),e.vx+=f*t.value*r/d,e.vy+=h*t.value*r/d),!0;if(!(t.length||d>=s)){(t.data!==e||t.next)&&(0===f&&(d+=(f=to(n))*f),0===h&&(d+=(h=to(n))*h),d<a&&(d=Math.sqrt(a*d)));do{t.data!==e&&(e.vx+=f*(p=i[t.data.index]*r/d),e.vy+=h*p)}while(t=t.next)}}return l.initialize=function(e,r){t=e,n=r,c()},l.strength=function(t){return arguments.length?(o="function"==typeof t?t:Wi(+t),c(),l):o},l.distanceMin=function(t){return arguments.length?(a=t*t,l):Math.sqrt(a)},l.distanceMax=function(t){return arguments.length?(s=t*t,l):Math.sqrt(s)},l.theta=function(t){return arguments.length?(u=t*t,l):Math.sqrt(u)},l}().strength(-30)).force("center",function(t,e){var n,r=1;function i(){var i,o,a=n.length,s=0,u=0;for(i=0;i<a;++i)s+=(o=n[i]).x,u+=o.y;for(s=(s/a-t)*r,u=(u/a-e)*r,i=0;i<a;++i)(o=n[i]).x-=s,o.y-=u}return null==t&&(t=0),null==e&&(e=0),i.initialize=function(t){n=t},i.x=function(e){return arguments.length?(t=+e,i):t},i.y=function(t){return arguments.length?(e=+t,i):e},i.strength=function(t){return arguments.length?(r=+t,i):r},i}(i.x,i.y)).force("collision",function(t){var e,n,r,i=1,o=1;function a(){for(var t,a,u,l,c,f,h,p=e.length,d=0;d<o;++d)for(a=Yi(e,eo,no).visitAfter(s),t=0;t<p;++t)h=(f=n[(u=e[t]).index])*f,l=u.x+u.vx,c=u.y+u.vy,a.visit(y);function y(t,e,n,o,a){var s=t.data,p=t.r,d=f+p;if(!s)return e>l+d||o<l-d||n>c+d||a<c-d;if(s.index>u.index){var y=l-s.x-s.vx,g=c-s.y-s.vy,m=y*y+g*g;m<d*d&&(0===y&&(m+=(y=to(r))*y),0===g&&(m+=(g=to(r))*g),m=(d-(m=Math.sqrt(m)))/m*i,u.vx+=(y*=m)*(d=(p*=p)/(h+p)),u.vy+=(g*=m)*d,s.vx-=y*(d=1-d),s.vy-=g*d)}}}function s(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var r,i,o=e.length;for(n=new Array(o),r=0;r<o;++r)n[(i=e[r]).index]=+t(i,r,e)}}return"function"!=typeof t&&(t=Wi(null==t?1:+t)),a.initialize=function(t,n){e=t,r=n,u()},a.iterations=function(t){return arguments.length?(o=+t,a):o},a.strength=function(t){return arguments.length?(i=+t,a):i},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:Wi(+e),u(),a):t},a}().radius(30)).stop());var i;r.nodes(t.nodes),r.force("link",function(t){var e,n,r,i,o,a,s=ro,u=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},l=Wi(30),c=1;function f(r){for(var i=0,s=t.length;i<c;++i)for(var u,l,f,h,p,d,y,g=0;g<s;++g)h=(f=(u=t[g]).target).x+f.vx-(l=u.source).x-l.vx||to(a),p=f.y+f.vy-l.y-l.vy||to(a),p*=d=((d=Math.sqrt(h*h+p*p))-n[g])/d*r*e[g],f.vx-=(h*=d)*(y=o[g]),f.vy-=p*y,l.vx+=h*(y=1-y),l.vy+=p*y}function h(){if(r){var a,u,l=r.length,c=t.length,f=new Map(r.map((t,e)=>[s(t,e,r),t]));for(a=0,i=new Array(l);a<c;++a)(u=t[a]).index=a,"object"!=typeof u.source&&(u.source=io(f,u.source)),"object"!=typeof u.target&&(u.target=io(f,u.target)),i[u.source.index]=(i[u.source.index]||0)+1,i[u.target.index]=(i[u.target.index]||0)+1;for(a=0,o=new Array(c);a<c;++a)o[a]=i[(u=t[a]).source.index]/(i[u.source.index]+i[u.target.index]);e=new Array(c),p(),n=new Array(c),d()}}function p(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+u(t[n],n,t)}function d(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+l(t[e],e,t)}return null==t&&(t=[]),f.initialize=function(t,e){r=t,a=e,h()},f.links=function(e){return arguments.length?(t=e,h(),f):t},f.id=function(t){return arguments.length?(s=t,f):s},f.iterations=function(t){return arguments.length?(c=+t,f):c},f.strength=function(t){return arguments.length?(u="function"==typeof t?t:Wi(+t),p(),f):u},f.distance=function(t){return arguments.length?(l="function"==typeof t?t:Wi(+t),d(),f):l},f}(t.links).id(t=>t.id));for(let t=0;t<n.ticks&&r.alpha()>r.alphaMin();t++)r.tick();return r},t.makeGramLinkDatum=i,t.makeGramNodeDatum=n,t.nodeToD3=me,t.parse=t=>{const e=ye.runSync(ye.parse(t));return{nodes:N(e).map(me),links:M(e).map(ve),paths:[]}},t.updateLinks=Io,t.updateNodes=qo,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=d3-gram.umd.production.min.js.map
